{"version":3,"file":"static/js/1447.c106e171.chunk.js","mappings":"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","sources":["plugins/DocumentHandler/printMenu/PrintList.js","plugins/DocumentHandler/printMenu/PrintListItem.js","plugins/DocumentHandler/printMenu/PrintWindow.js","plugins/DocumentHandler/printMenu/TableOfContents.js","plugins/DocumentHandler/utils/helpers.js","plugins/DocumentHandler/utils/stateConverter.js"],"sourcesContent":["import React from \"react\";\nimport List from \"@mui/material/List\";\nimport PrintListItem from \"./PrintListItem\";\n\nclass PrintList extends React.Component {\n  getMenuItemType = (item, type) => {\n    return (\n      <PrintListItem\n        {...this.props}\n        type={type}\n        menu={item.menu}\n        icon={item.icon}\n        id={item.id}\n        level={item.level}\n        color={item.color}\n        title={item.title}\n        itemRef={item.itemRef}\n        subMenuItems={this.getSubMenuItems(item)}\n        expanded={item.expandedSubMenu}\n        colored={item.colored}\n        selected={item.selected}\n        chosenForPrint={item.chosenForPrint}\n        handleTogglePrint={this.props.handleTogglePrint}\n      ></PrintListItem>\n    );\n  };\n\n  getSubMenuItems = (item) => {\n    return item.menuItemIds.reduce((subMenuItems, subItemId) => {\n      const subItem = Object.values(this.props.documentMenu).find((i) => {\n        return i.id === subItemId;\n      });\n      if (subItem.menuItemIds.length > 0) {\n        subMenuItems = [...subMenuItems, ...this.getSubMenuItems(subItem)];\n      }\n      return [...subMenuItems, subItem];\n    }, []);\n  };\n\n  renderMenuItem = (item, id) => {\n    if (item.menuItemIds && item.menuItemIds.length > 0) {\n      return this.getMenuItemType(item, \"submenu\");\n    } else if (item.document) {\n      return this.getMenuItemType(item, \"document\");\n    } else if (item.link) {\n      return this.getMenuItemType(item, \"link\");\n    } else if (item.maplink) {\n      return this.getMenuItemType(item, \"maplink\");\n    }\n  };\n\n  render() {\n    const { documentMenu, level } = this.props;\n    return (\n      <List sx={{ width: \"100%\" }} disablePadding>\n        {Object.values(documentMenu)\n          .filter((item) => {\n            return item.level === level;\n          })\n          .map((item) => {\n            return (\n              <React.Fragment key={item.id}>\n                {this.renderMenuItem(item, item.id)}\n              </React.Fragment>\n            );\n          })}\n      </List>\n    );\n  }\n}\n\nexport default PrintList;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport { visuallyHidden } from \"@mui/utils\";\n\nimport { withTheme } from \"@emotion/react\";\nimport {\n  Checkbox,\n  Collapse,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n} from \"@mui/material\";\nimport ExpandLess from \"@mui/icons-material/ExpandLess\";\nimport ExpandMore from \"@mui/icons-material/ExpandMore\";\nimport PrintList from \"./PrintList\";\n\nconst StyledListItemIcon = styled(ListItemIcon)(({ theme }) => ({\n  minWidth: theme.spacing(3),\n}));\n\nconst StyledCollapseIcon = styled(ListItemIcon)(({ theme }) => ({\n  \".MuiListItemIcon-root\": {\n    minWidth: theme.spacing(4),\n  },\n}));\nconst StyledListItem = styled(ListItem)(({ theme }) => ({\n  overflowWrap: \"break-word\",\n  \".MuiListItem-root\": {\n    borderLeft: `${theme.spacing(1)} solid ${theme.palette.background.paper}`,\n    \"&.Mui-selected\": {\n      borderLeftColor: theme.palette.action.selected,\n    },\n    \"&.Mui-selected:hover\": {\n      borderLeftColor: theme.palette.action.selected,\n    },\n    \"&:hover\": {\n      borderColor: theme.palette.action.hover,\n    },\n  },\n}));\n\nclass PrintListItem extends React.PureComponent {\n  #getListTitle = () => {\n    const { title } = this.props;\n    return <ListItemText>{title}</ListItemText>;\n  };\n\n  #getCollapseIcon = () => {\n    const { title, expanded } = this.props;\n\n    return expanded ? (\n      <StyledCollapseIcon>\n        {!title && <span style={visuallyHidden}>Minimera submeny</span>}\n        <ExpandLess />\n      </StyledCollapseIcon>\n    ) : (\n      <StyledCollapseIcon>\n        {!title && <span style={visuallyHidden}>Maximera submeny</span>}\n        <ExpandMore />\n      </StyledCollapseIcon>\n    );\n  };\n\n  #hasSubMenu = () => {\n    const { subMenuItems } = this.props;\n    return subMenuItems && subMenuItems.length > 0;\n  };\n\n  #handleMenuButtonClick = (type, id) => {\n    const { localObserver } = this.props;\n    localObserver.publish(`print-${type}-clicked`, id);\n  };\n\n  #getMenuItemStyle = () => {\n    const { theme, level, color, colored } = this.props;\n    const hasSubMenu = this.#hasSubMenu();\n    return colored\n      ? {\n          paddingLeft: theme.spacing(1 + level * 3),\n          borderLeft: `${theme.spacing(0.5)} solid ${color}`,\n          paddingRight: hasSubMenu ? 0 : theme.spacing(1),\n        }\n      : {\n          paddingLeft: theme.spacing(1 + level * 3),\n          paddingRight: hasSubMenu ? 0 : theme.spacing(1),\n        };\n  };\n\n  render() {\n    const {\n      type,\n      selected,\n      subMenuItems,\n      expanded,\n      level,\n      title,\n      id,\n      chosenForPrint,\n    } = this.props;\n    const hasSubMenu = this.#hasSubMenu();\n    return (\n      <>\n        <StyledListItem\n          divider\n          selected={selected}\n          button\n          ref={this.props.itemRef}\n          size=\"small\"\n          disableGutters\n          aria-controls={hasSubMenu ? `submenu_${id}` : null}\n          aria-expanded={expanded}\n          onClick={() => {\n            this.#handleMenuButtonClick(type, id);\n          }}\n          sx={this.#getMenuItemStyle()}\n        >\n          <StyledListItemIcon>\n            <Checkbox\n              color=\"primary\"\n              checked={chosenForPrint}\n              onChange={(e) => {\n                this.props.handleTogglePrint(this.props.id);\n              }}\n              onClick={(e) => e.stopPropagation()}\n              edge=\"start\"\n              tabIndex={-1}\n              disableRipple\n            />\n          </StyledListItemIcon>\n          {title && this.#getListTitle()}\n          {hasSubMenu && this.#getCollapseIcon()}\n        </StyledListItem>\n        {hasSubMenu && (\n          <Collapse id={`submenu_${id}`} in={expanded} timeout={200}>\n            <PrintList\n              {...this.props}\n              level={level + 1}\n              documentMenu={subMenuItems}\n              handleTogglePrint={this.props.handleTogglePrint}\n            ></PrintList>\n          </Collapse>\n        )}\n      </>\n    );\n  }\n}\n\nexport default withTheme(PrintListItem);\n","import React, { useEffect } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport { createPortal } from \"react-dom\";\nimport { withSnackbar } from \"notistack\";\nimport {\n  styled,\n  StyledEngineProvider,\n  ThemeProvider,\n  useTheme,\n} from \"@mui/material/styles\";\nimport {\n  Button,\n  Checkbox,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogContentText,\n  FormControlLabel,\n  Grid,\n  LinearProgress,\n  Typography,\n  List,\n  ListItemButton,\n  DialogActions,\n  useMediaQuery,\n} from \"@mui/material\";\n\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\nimport ArrowForwardIcon from \"@mui/icons-material/ArrowForward\";\nimport OpenInNewIcon from \"@mui/icons-material/OpenInNew\";\n\nimport { deepMerge } from \"utils/DeepMerge\";\n\nimport PrintList from \"./PrintList\";\nimport TableOfContents from \"./TableOfContents\";\nimport { getNormalizedMenuState } from \"../utils/stateConverter\";\nimport { hasSubMenu } from \"../utils/helpers\";\n\nconst GridGridContainer = styled(Grid)(({ theme }) => ({\n  padding: theme.spacing(3),\n  height: \"100%\",\n  overflowX: \"auto\",\n}));\n\nconst GridMiddleContainer = styled(Grid)(({ theme }) => ({\n  marginTop: theme.spacing(2),\n  overflowX: \"auto\",\n  \"&::-webkit-scrollbar\": {\n    width: \"0.4em\",\n    opacity: \"0\",\n  },\n  \"&:hover\": {\n    \"&::-webkit-scrollbar\": {\n      opacity: \"1\",\n    },\n    \"&::-webkit-scrollbar-track\": {\n      boxShadow: \"inset 0 0 6px rgba(0,0,0,0.00)\",\n      webkitBoxShadow: \"inset 0 0 6px rgba(0,0,0,0.00)\",\n    },\n    \"&::-webkit-scrollbar-thumb\": {\n      backgroundColor: \"rgba(0,0,0,.1)\",\n    },\n  },\n  flexBasis: \"100%\",\n}));\n\nconst GridHeaderContainer = styled(Grid)(({ theme }) => ({\n  marginBottom: theme.spacing(2),\n}));\n\nconst GridSettingsContainer = styled(Grid)(({ theme }) => ({\n  marginBottom: theme.spacing(2),\n}));\n\nconst GridFooterContainer = styled(Grid)(({ theme }) => ({\n  flexBasis: \"10%\",\n}));\n\nconst StyledGrid = styled(Grid)(({ theme }) => ({\n  display: \"flex\",\n  justifyContent: \"flex-end\",\n}));\n\nconst StyledListItemButton = styled(ListItemButton)(({ theme, index }) => ({\n  display: \"flex\",\n  justifyContent: \"space-between\",\n  padding: \"16px 10px 16px 10px\",\n  borderBottom: \"1px solid lightgray\",\n  borderLeft: index % 2 === 0 ? \"4px solid lightGray\" : \"4px solid darkGray\",\n}));\n\nconst StyledDialogContent = styled(DialogContent)(({ theme }) => ({\n  overflowY: \"clip\",\n  position: \"relative\",\n  \"&:before\": {\n    display: \"block\",\n    content: `\"\"`,\n    width: \"100%\",\n    paddingTop: \"141.15%\",\n    paddingLeft: \"80%\",\n  },\n}));\n\nconst StyledIframe = styled(\"iframe\")(({ theme }) => ({\n  position: \"absolute\",\n  width: \"calc(100% - 40px)\",\n  height: \"100%\",\n  top: \"0\",\n  left: \"0\",\n  margin: \"20px\",\n}));\n\nconst maxHeight = 950;\nconst imageResizeRatio = 0.7;\n\nfunction ComponentWithRenderCallback({ callback, children }) {\n  useEffect(() => callback());\n\n  return <div>{children}</div>;\n}\n\nclass PrintWindow extends React.PureComponent {\n  state = {\n    printLinks: true,\n    printText: true,\n    printImages: true,\n    printMaps: false,\n    allDocumentsToggled: false,\n    tocPrintMode: this.props.options?.tableOfContents?.printMode ?? \"none\",\n    menuInformation: this.createMenu(),\n    printContent: undefined,\n    pdfLoading: false,\n    isAnyDocumentSelected: false,\n    showAttachments: false,\n    selectedPdfIndex: null,\n    isModalOpen: false,\n    pdfLinks: this.checkPdfLinks(this.props.options.pdfLinks),\n  };\n\n  internalId = 0;\n\n  #handleSubMenuClicked = (id) => {\n    this.#setItemStateProperties(id);\n  };\n\n  #setItemStateProperties = (idClicked) => {\n    return new Promise((resolve) => {\n      const currentState = { ...this.state.menuInformation };\n      const clickedItem = currentState[idClicked];\n      const newState = Object.values(currentState).reduce((items, item) => {\n        const isClickedItem = item.id === idClicked;\n        if (isClickedItem) {\n          return {\n            ...items,\n            [item.id]: this.#setClickedItemProperties(item),\n          };\n        } else {\n          return {\n            ...items,\n            [item.id]: this.#setNonClickedItemProperties(\n              item,\n              currentState,\n              clickedItem\n            ),\n          };\n        }\n      }, {});\n\n      this.setState({ menuInformation: newState }, resolve);\n    });\n  };\n\n  #setClickedItemProperties = (clickedItem) => {\n    let newItem = { ...clickedItem };\n    return {\n      ...clickedItem,\n      selected: !newItem.hasSubMenu,\n      expandedSubMenu: newItem.hasSubMenu\n        ? !newItem.expandedSubMenu\n        : newItem.expandedSubMenu,\n    };\n  };\n\n  #setNonClickedItemProperties = (item, currentState, clickedItem) => {\n    return {\n      ...item,\n      expandedSubMenu:\n        clickedItem.allParents.indexOf(item.id) !== -1\n          ? true\n          : item.expandedSubMenu,\n      selected: clickedItem.hasSubMenu ? item.selected : false,\n    };\n  };\n\n  componentDidMount = () => {\n    this.props.localObserver.subscribe(\n      \"chapter-components-appended\",\n      (renderedChapters) => {\n        this.setState(\n          {\n            printContent: renderedChapters,\n          },\n          () => {\n            this.printContents();\n          }\n        );\n      }\n    );\n\n    this.props.localObserver.subscribe(\"print-submenu-clicked\", (id) => {\n      this.#handleSubMenuClicked(id);\n    });\n  };\n\n  componentWillUnmount = () => {\n    this.props.localObserver.unsubscribe(\"chapter-components-appended\");\n  };\n\n  resizeImage = (img) => {\n    img.height = img.getBoundingClientRect().height * imageResizeRatio;\n    img.width = img.clientWidth * imageResizeRatio;\n  };\n\n  imageFitsOnePage = (img) => {\n    return img.getBoundingClientRect().height < maxHeight * 0.9;\n  };\n\n  loadImage = (img) => {\n    return new Promise((resolve, reject) => {\n      img.onload = () => {\n        if (this.imageFitsOnePage(img)) {\n          resolve(img);\n        } else {\n          this.resizeImage(img);\n          resolve(img);\n        }\n      };\n      img.onerror = () => reject(img);\n    });\n  };\n\n  customRender = (element, container) => {\n    // Since the ThemeProvider seems to cache the theme in some way, we have to make sure to\n    // create a new theme-reference to make sure that the correct theme is used when rendering.\n    // If we don't create a new reference, the custom-theme will be overridden by the standard MUI-theme\n    // since the standard MUI-theme is refreshed (and thereby has the highest css-specificity) sometimes.\n    // This is quite messy, but get's the job done. See issue #999 for more info.\n    const theme = deepMerge(this.props.customTheme || this.props.theme, {});\n    // Make sure to render the components using the custom theme if it exists:\n    return new Promise((resolve) => {\n      const rootElement = createRoot(container);\n      rootElement.render(\n        <StyledEngineProvider>\n          <ThemeProvider theme={theme}>\n            <ComponentWithRenderCallback\n              callback={() => {\n                resolve();\n              }}\n            >\n              {element}\n            </ComponentWithRenderCallback>\n          </ThemeProvider>\n        </StyledEngineProvider>\n      );\n    });\n  };\n\n  createPrintElement = (id) => {\n    let div = document.createElement(\"div\");\n    div.id = id;\n    return div;\n  };\n\n  renderToc = () => {\n    this.toc = this.createPrintElement(\"toc\");\n    return this.customRender(\n      <TableOfContents\n        documentMenuState={this.state.menuInformation}\n        allDocuments={this.props.model.allDocuments}\n        mode={this.state.tocPrintMode}\n      />,\n      this.toc\n    );\n  };\n\n  renderContent = () => {\n    this.content = this.createPrintElement(\"content\");\n    return this.customRender(this.state.printContent, this.content);\n  };\n\n  areAllImagesLoaded = () => {\n    return Promise.allSettled(\n      [...this.content.getElementsByTagName(\"img\")].map((img) => {\n        return this.loadImage(img);\n      })\n    );\n  };\n\n  handleNewWindowBlocked = () => {\n    window.alert(\n      \"Please allow opening of popup windows in order to print this document.\"\n    );\n\n    this.setState({\n      pdfLoading: false,\n      printContent: undefined,\n      printMaps: false,\n    });\n\n    return null;\n  };\n\n  createPrintWindow = () => {\n    const printWindow = window.open(\"\", \"PRINT\");\n\n    if (printWindow === null) {\n      return this.handleNewWindowBlocked();\n    }\n\n    printWindow.document.head.insertAdjacentHTML(\n      \"beforeend\",\n      ` <title>${document.title}</title>\n        <base href=\"${document.location.protocol}//${\n        document.location.host\n      }/\" />\n        ${\n          this.props.options.dynamicImportUrls.customFont\n            ? `<link\n            rel=\"stylesheet\"\n            type=\"text/css\"\n            href=\"${this.props.options.dynamicImportUrls.customFont}\"/>`\n            : \"\"\n        }        \n        <style>\n          @page {\n            size: A4;\n            margin: 25mm 25mm 25mm 25mm;\n          }\n          @media print {\n            html,\n            body {\n              height: 297mm;\n              width: 210mm;\n            }\n            h1,\n            h2,\n            h3,\n            h4,\n            h5,\n            h6 {\n              page-break-after: avoid;\n            }\n            .MuiTypography-body1 {\n              page-break-before: avoid;\n            }\n            .MuiBox-root {\n              page-break-inside: avoid;\n            }\n            body .blockQuoteAccordion {\n              box-shadow: none;\n              border: 4px solid #edf2f7;\n            }\n            .blockQuoteAccordion .MuiCollapse-root {\n              height: auto;\n              visibility: visible;\n            }\n            .blockQuoteAccordion .MuiAccordionSummary-expandIconWrapper {\n              display: none;\n            }\n          }        \n        </style>`\n    );\n\n    return printWindow;\n  };\n\n  clearPrintContainers = () => {\n    this.toc = null;\n    this.content = null;\n  };\n\n  handlePrintCompleted = () => {\n    // Since we've altered the theme while printing, we must refresh to make sure\n    // the original theme has the highest specificity when the printing is done.\n    // Otherwise the entire application will follow the theming used in the print-contents.\n    // FIXME: This might not be needed after the upgrade to React 18. Let's ensure that's the\n    // case and remove if so.\n    // this.props.app.refreshMUITheme();\n\n    // Then we'll update the view\n    this.toggleAllDocuments(false);\n    this.setState({\n      pdfLoading: false,\n      printContent: undefined,\n      menuInformation: this.createMenu(),\n    });\n  };\n\n  addPageBreaksBeforeHeadings = (printContent) => {\n    const headings = printContent.querySelectorAll([\"h1\", \"h2\"]);\n\n    // We don't want page breaks before a H2 if there is a H1 immediately before.\n    // In this case the H1 is the group parent heading.\n    let isAfterH1 = false;\n    let isConsecutiveH1 = false;\n\n    for (let i = 0; i < headings.length; i++) {\n      if (headings[i].nodeName === \"H1\" && isAfterH1) {\n        isConsecutiveH1 = true;\n      }\n      if (headings[i].nodeName === \"H1\") {\n        isAfterH1 = true;\n      }\n\n      //H1s are group headings and should start on a new page.\n      if (\n        headings[i].nodeName === \"H1\" &&\n        this.state.tocPrintMode !== \"none\" &&\n        !isConsecutiveH1\n      ) {\n        headings[i].style.pageBreakBefore = \"always\";\n        headings[i].style.breakBefore = \"none\";\n      }\n\n      if (i !== 0 && headings[i].nodeName === \"H2\" && !isAfterH1) {\n        headings[i].style.pageBreakBefore = \"always\";\n        headings[i].style.breakBefore = \"none\";\n      }\n\n      if (headings[i].nodeName !== \"H1\") {\n        isAfterH1 = false;\n      }\n    }\n  };\n\n  // Creates a new window, appends all elements that should be printed, and invokes\n  // window.print(), allowing the user to save the document as a PDF (or print it straight away).\n  printContents = () => {\n    // We're gonna want to make sure everything is rendered...\n    Promise.all([\n      this.state.tocPrintMode !== \"none\" && this.renderToc(),\n      this.renderContent(),\n    ]).then(() => {\n      // We're also gonna want to make sure all images has been loaded\n      this.areAllImagesLoaded().then(() => {\n        // Then we can create an element that will hold our TOC and print-content...\n        const printContent = document.createElement(\"div\");\n        // ...append the TOC to the element (only if applicable)...\n        this.toc && printContent.appendChild(this.toc);\n        // ...and append the actual content.\n        printContent.appendChild(this.content);\n        // Then we'll make sure to create page-breaks before headings to\n        // create a more appealing document.\n        this.addPageBreaksBeforeHeadings(printContent);\n        // Then we'll create and open a new window in the browser\n        const newWindow = this.createPrintWindow();\n\n        // We're gonna need to get all the styles into the new window...\n        // The styling is applied differently if we're in dev- or prod-mode.\n        // (Both are handled with this solution). Let's loop every emotion-style-tag\n        for (const style of document.querySelectorAll(\"[data-emotion]\")) {\n          // Create a new style-tag\n          const s = document.createElement(\"style\");\n          // Append an empty text-node (TODO: Why? :) )\n          s.appendChild(document.createTextNode(\"\"));\n          // There's gonna be information in either the style-sheet or in the textContent\n          // depending on if we're in dev- or prod-mode.\n          const { textContent, sheet } = style;\n          // In development we'll have pure text styling the components...\n          if (textContent) {\n            // In that case we can just append a text-node with that text\n            s.appendChild(document.createTextNode(textContent));\n            newWindow.document.head.appendChild(s);\n            // While in prod, we'll have a stylesheet\n          } else {\n            // We have to append the new style to the document, otherwise the sheet will be null.\n            newWindow.document.head.appendChild(s);\n            for (const rule of sheet.cssRules) {\n              try {\n                s.sheet.insertRule(rule.cssText);\n              } catch (error) {\n                console.warn(`Could not insert rule: ${rule?.cssText}`);\n              }\n            }\n          }\n        }\n\n        // Add our recently-created DIV to the new window's document\n        newWindow.document.body.appendChild(printContent);\n\n        // Invoke browser's print dialog - this will block the thread\n        // until user does something with it.\n        newWindow.print();\n\n        // Once the print dialog has disappeared, let's close the new window\n        newWindow.close();\n\n        // When the user closes the print-window we have to do some cleanup...\n        this.handlePrintCompleted();\n      });\n    });\n  };\n\n  handleCheckboxChange = (chapter) => {\n    const { model } = this.props;\n    let newChapterInformation = [...this.state.chapterInformation];\n\n    let toggledChapter = model.getChapterById(\n      newChapterInformation,\n      chapter.id\n    );\n    toggledChapter.chosenForPrint = !toggledChapter.chosenForPrint;\n    this.toggleSubChapters(toggledChapter, toggledChapter.chosenForPrint);\n\n    this.setState({\n      chapterInformation: newChapterInformation,\n      allDocumentsToggled: false,\n    });\n  };\n\n  setInitialMenuItemProperties(menuItem) {\n    if (hasSubMenu(menuItem)) {\n      menuItem.hasSubMenu = true;\n      menuItem.menu.forEach((subMenuItem) => {\n        this.setInitialMenuItemProperties(subMenuItem, menuItem);\n      });\n    }\n  }\n\n  removeNonPrintableDocuments(documents) {\n    /*\n     * Remove menu items that should not appear in the print menu.\n     * Items that should be removed are: items without a document that are not a group parent. (maplinks, links)\n     */\n    let removedIds = [];\n\n    Object.keys(documents).forEach((key) => {\n      if (documents[key].maplink.trim() || documents[key].link.trim()) {\n        removedIds.push(parseInt(key));\n        delete documents[key];\n      }\n    });\n\n    Object.keys(documents).forEach((key) => {\n      let item = documents[key];\n\n      //if a document has been removed from the printMenu, also remove its id from the children array of other documents.\n      let newChildren = item.allChildren.filter(\n        (child) => !removedIds.includes(child)\n      );\n      item.allChildren = newChildren;\n      //also remove its id from the menuItemIds of other documents.\n      let newMenuItemIds = item.menuItemIds.filter(\n        (id) => !removedIds.includes(id)\n      );\n      item.menuItemIds = newMenuItemIds;\n    });\n  }\n\n  createMenu() {\n    /* \n    Create a normalized menu structure for the print menu, similar to that of the panel menu, but only for printable documents. \n    */\n    const { options } = this.props;\n\n    const modelDocuments = this.props.model.allDocuments;\n    const newOptions = { ...options };\n    const menuConfig = { ...newOptions }.menuConfig;\n    const menuConfigClone = JSON.parse(JSON.stringify(menuConfig));\n    const menuStructure = getNormalizedMenuState(menuConfigClone.menu);\n    let chapterInformation = this.props.model.getAllChapterInfo();\n\n    const keys = Object.keys(menuStructure);\n    const idOffset = keys.length + 1; //used to give new ids, so printMenu items do not get the same id as panelMenu items\n\n    keys.forEach((key) => {\n      let document = menuStructure[key];\n      const offsetChildren = document.allChildren.map((id) => (id += idOffset));\n      const offsetParents = document.allParents.map((id) => (id += idOffset));\n      const offsetMenuItemIds = document.menuItemIds.map(\n        (id) => (id += idOffset)\n      );\n\n      document.id += idOffset;\n      document.parentId = document.parentId\n        ? (document.parentId += idOffset)\n        : null;\n      document.allChildren = offsetChildren;\n      document.allParents = offsetParents;\n      document.menuItemIds = offsetMenuItemIds;\n\n      document.chosenForPrint = false;\n      document.colored = true;\n\n      //add the table of contents settings from the document json.\n      if (document.document) {\n        let modelDoc = modelDocuments.find(\n          (modelDoc) => modelDoc.documentFileName === document.document\n        );\n        document.tocChapterLevels =\n          modelDoc?.tableOfContents?.chapterLevelsToShow || 100;\n      }\n      if (document.document) {\n        document.chapters = [];\n        let documentChapters = chapterInformation.filter(\n          (chapter) => chapter.documentFileName === document.document\n        );\n        documentChapters.forEach((chapter) => document.chapters.push(chapter));\n      }\n    });\n\n    let menuWithOffset = {};\n    keys.forEach((key) => {\n      let keyOffset = parseInt(key) + idOffset;\n      menuWithOffset[keyOffset] = menuStructure[key];\n    });\n\n    this.removeNonPrintableDocuments(menuWithOffset);\n    return menuWithOffset;\n  }\n\n  toggleSubDocuments(documentId, checked, menuState) {\n    const subDocuments = menuState[documentId].allChildren;\n    subDocuments.forEach((subDocId) => {\n      const updateDoc = {\n        ...menuState[subDocId],\n        chosenForPrint: checked,\n      };\n      menuState[subDocId] = updateDoc;\n      this.toggleSubDocuments(subDocId, checked, menuState);\n    });\n\n    return menuState;\n  }\n\n  toggleParentChecked(documentId, menuState) {\n    const parentId = menuState[documentId].parentId;\n    const updatedParent = { ...menuState[parentId], chosenForPrint: true };\n    menuState[parentId] = updatedParent;\n\n    if (menuState[parentId].parentId) {\n      menuState = this.toggleParentChecked(parentId, menuState);\n    }\n\n    return menuState;\n  }\n\n  toggleParentUnchecked(documentId, menuState) {\n    const parentId = menuState[documentId].parentId;\n\n    //if the parent has other children that are checked, do not toggle the parent.\n    const hasOtherCheckedChildren =\n      menuState[parentId].allChildren.filter((child) => {\n        if (child.id !== documentId && menuState[child].chosenForPrint) {\n          return true;\n        } else return false;\n      }).length > 0;\n\n    if (hasOtherCheckedChildren) {\n      return menuState;\n    }\n\n    const updatedParent = { ...menuState[parentId], chosenForPrint: false };\n    menuState[parentId] = updatedParent;\n\n    if (menuState[parentId].parentId) {\n      menuState = this.toggleParentUnchecked(parentId, menuState);\n    }\n    return menuState;\n  }\n\n  toggleChosenForPrint = (documentId) => {\n    const current = { ...this.state.menuInformation };\n    const shouldPrint = !current[documentId].chosenForPrint;\n\n    const updateDoc = {\n      ...current[documentId],\n      chosenForPrint: !current[documentId].chosenForPrint,\n    };\n    current[documentId] = updateDoc;\n\n    /*\n    update child documents (toggle subDocuments does not set state itself, but returns an object\n    that we can use to update the state along with out parent document, so we only make one state update.) \n    */\n    let updatedMenuState = this.toggleSubDocuments(\n      documentId,\n      shouldPrint,\n      current\n    );\n\n    if (current[documentId].parentId && shouldPrint) {\n      updatedMenuState = this.toggleParentChecked(documentId, updatedMenuState);\n    }\n\n    if (current[documentId].parentId && !shouldPrint) {\n      updatedMenuState = this.toggleParentUnchecked(\n        documentId,\n        updatedMenuState\n      );\n    }\n\n    this.setState({ menuInformation: updatedMenuState }, () => {\n      this.setIsAnyDocumentSelected();\n    });\n  };\n\n  toggleAllDocuments = (toggled) => {\n    const menuState = { ...this.state.menuInformation };\n\n    Object.keys(menuState).forEach((key) => {\n      const updateDoc = {\n        ...menuState[key],\n        chosenForPrint: toggled,\n      };\n      menuState[key] = updateDoc;\n    });\n\n    this.setState({\n      allDocumentsToggled: toggled,\n      menuInformation: menuState,\n      isAnyDocumentSelected: toggled,\n    });\n  };\n\n  removeTagsNotSelectedForPrint = (chapter) => {\n    const { printImages, printText, printLinks } = this.state;\n\n    let elementsToRemove = [];\n    const div = document.createElement(\"div\");\n    div.innerHTML = chapter.html;\n\n    if (!printLinks) {\n      Array.from(div.getElementsByTagName(\"a\")).forEach((element) => {\n        elementsToRemove.push(element);\n      });\n    }\n    if (!printImages) {\n      Array.from(div.getElementsByTagName(\"figure\")).forEach((element) => {\n        elementsToRemove.push(element);\n      });\n    }\n    if (!printText) {\n      Array.from(div.querySelectorAll(\"p, h1, h2, h3, h4, h5, h6\")).forEach(\n        (element) => {\n          elementsToRemove.push(element);\n        }\n      );\n      chapter.header = \"\";\n    }\n\n    //ensure links to internal documents are no longer clickable.\n    let documentLinks = div.querySelectorAll(\"[data-document]\");\n    for (let i = 0; i < documentLinks.length; i++) {\n      documentLinks[i].setAttribute(\"printMode\", \"true\");\n      documentLinks[i].href = \"#\";\n    }\n\n    for (let i = 0; i < elementsToRemove.length; i++) {\n      elementsToRemove[i].parentNode.removeChild(elementsToRemove[i]);\n    }\n\n    chapter.html = div.innerHTML;\n    return chapter;\n  };\n\n  prepareChapterForPrint = (chapter) => {\n    if (chapter.chapters && chapter.chapters.length > 0) {\n      chapter.chapters.forEach((subChapter) => {\n        if (subChapter.chapters && subChapter.chapters.length > 0) {\n          return this.prepareChapterForPrint(subChapter);\n        } else {\n          subChapter = this.removeTagsNotSelectedForPrint(subChapter);\n        }\n      });\n    }\n    chapter = this.removeTagsNotSelectedForPrint(chapter);\n    return chapter;\n  };\n\n  setIsAnyDocumentSelected = () => {\n    const keys = Object.keys(this.state.menuInformation);\n    let isAnyDocumentSelected = false;\n\n    for (let i = 0; i < keys.length; i++) {\n      if (this.state.menuInformation[keys[i]].chosenForPrint) {\n        isAnyDocumentSelected = true;\n      }\n    }\n    this.setState({ isAnyDocumentSelected: isAnyDocumentSelected });\n  };\n\n  createHeaderItems = (menuItem) => {\n    return { isGroupHeader: true, title: menuItem.title, id: menuItem.id };\n  };\n\n  getDocumentsToPrint = () => {\n    const { menuInformation } = this.state;\n\n    const documentIdsForPrint = Object.keys(menuInformation).filter(\n      (key) => menuInformation[key].chosenForPrint\n    );\n\n    //create those without documents (header items) as a header item object.\n    const documentNamesForPrint = documentIdsForPrint.map(\n      (id) => menuInformation[id].document\n    );\n\n    //TODO - now that we get the document chapters earlier, do we need to get the document here?\n    const originalDocs = this.props.model.getDocuments(documentNamesForPrint);\n\n    let docs = originalDocs.map((doc) => {\n      if (doc) {\n        let menuDocKey = Object.keys(menuInformation).find(\n          (key) => menuInformation[key].document === doc.documentFileName\n        );\n        return {\n          documentFileName: doc.documentFileName,\n          tableOfContents: doc.tableOfContents,\n          chapters: menuInformation[menuDocKey].chapters,\n        };\n      } else {\n        return undefined;\n      }\n    });\n\n    /*\n    where getDocuments returns an empty string. This is a menuItem without a corresponding document, which\n    is a menu parent.\n    */\n    const docsIncludingGroupParent = docs.map((doc, index) => {\n      if (doc === undefined) {\n        return this.createHeaderItems(\n          menuInformation[documentIdsForPrint[index]]\n        );\n      }\n      return doc;\n    });\n\n    let newDocs = [];\n\n    docsIncludingGroupParent.forEach((document) => {\n      if (document?.chapters?.length) {\n        let preparedChapters = [];\n        document?.chapters.forEach((chapter) => {\n          preparedChapters.push(this.prepareChapterForPrint(chapter));\n        });\n        document.chapters = preparedChapters;\n      }\n      newDocs.push(document);\n    });\n\n    return newDocs;\n  };\n\n  createPDF = () => {\n    this.setState({ pdfLoading: true });\n    const documentsToPrint = this.getDocumentsToPrint();\n    this.props.localObserver.publish(\n      \"append-document-components\",\n      documentsToPrint\n    );\n  };\n\n  renderCreatePDFButton() {\n    return (\n      <GridFooterContainer\n        item\n        container\n        alignContent=\"center\"\n        alignItems=\"center\"\n        justifyContent=\"center\"\n      >\n        <Button\n          color=\"primary\"\n          variant=\"contained\"\n          disabled={this.state.pdfLoading || !this.state.isAnyDocumentSelected}\n          startIcon={<OpenInNewIcon />}\n          onClick={this.createPDF}\n        >\n          <Typography\n            style={{ marginRight: \"20px\", marginLeft: \"20px\" }}\n            justify=\"center\"\n          >\n            Afdrukken\n          </Typography>\n        </Button>\n      </GridFooterContainer>\n    );\n  }\n\n  renderLoadingDialog = () => {\n    return (\n      <>\n        {createPortal(\n          <Dialog disableEscapeKeyDown={true} open={this.state.pdfLoading}>\n            <LinearProgress />\n            <DialogTitle>Din PDF skapas</DialogTitle>\n            <DialogContent>\n              <DialogContentText>\n                Det här kan ta en stund, speciellt om du har valt att skriva ut\n                många dokument.\n                <br />\n                <br />\n              </DialogContentText>\n            </DialogContent>\n          </Dialog>,\n          document.getElementById(\"root\")\n        )}\n      </>\n    );\n  };\n\n  toggleDocumentsAttachments = () => {\n    this.setState((prevState) => ({\n      showAttachments: !prevState.showAttachments,\n    }));\n  };\n\n  renderPrintDocuments = () => {\n    const { localObserver, documentWindowMaximized } = this.props;\n    const { menuInformation } = this.state;\n    return (\n      <>\n        <Typography align=\"center\" variant=\"h6\">\n          Skapa PDF\n        </Typography>\n        <GridSettingsContainer container item>\n          <Typography variant=\"h6\">Inställningar</Typography>\n\n          <Grid xs={12} item>\n            <FormControlLabel\n              value=\"Välj alla dokument\"\n              control={\n                <Checkbox\n                  color=\"primary\"\n                  checked={this.state.allDocumentsToggled}\n                  onChange={() =>\n                    this.toggleAllDocuments(!this.state.allDocumentsToggled)\n                  }\n                />\n              }\n              label=\"Välj alla dokument\"\n              labelPlacement=\"end\"\n            />\n          </Grid>\n        </GridSettingsContainer>\n\n        <Typography variant=\"h6\">Valt innehåll</Typography>\n\n        <GridMiddleContainer item container>\n          <PrintList\n            localObserver={localObserver}\n            documentMenu={menuInformation}\n            level={0}\n            handleTogglePrint={this.toggleChosenForPrint}\n          />\n        </GridMiddleContainer>\n\n        {documentWindowMaximized && this.renderCreatePDFButton()}\n        {this.renderLoadingDialog()}\n      </>\n    );\n  };\n\n  openAttachmentModal = (index) => {\n    this.setState({\n      selectedPdfIndex: index,\n      isModalOpen: true,\n    });\n  };\n\n  closeAttachmentModal = () => {\n    this.setState({\n      selectedPdfIndex: null,\n      isModalOpen: false,\n    });\n  };\n\n  checkPdfLinks(pdfLinks) {\n    const updatedLinks = pdfLinks?.filter(\n      (pdfLink) => pdfLink.name || pdfLink.link\n    );\n    return updatedLinks;\n  }\n\n  renderDialog = () => {\n    const { isModalOpen, pdfLinks, selectedPdfIndex } = this.state;\n    const closeAttachmentModal = this.closeAttachmentModal;\n\n    function ResponsiveDialog() {\n      const theme = useTheme();\n      const fullScreen = useMediaQuery(theme.breakpoints.down(\"sm\"));\n\n      return (\n        <Dialog\n          fullScreen={fullScreen}\n          open={isModalOpen}\n          PaperProps={{ style: { width: !fullScreen && \"30%\" } }}\n          BackdropProps={{\n            style: { backgroundColor: \"rgba(0, 0, 0, 0.25)\" },\n          }}\n          onClose={() => closeAttachmentModal()}\n        >\n          <StyledDialogContent>\n            <StyledIframe\n              title={pdfLinks[selectedPdfIndex]?.name}\n              src={pdfLinks[selectedPdfIndex]?.link}\n            />\n          </StyledDialogContent>\n          <DialogActions>\n            <Button variant=\"contained\" onClick={() => closeAttachmentModal()}>\n              <Typography variant=\"body2\">Sluiten</Typography>\n            </Button>\n          </DialogActions>\n        </Dialog>\n      );\n    }\n    return (\n      <>\n        {createPortal(\n          <ResponsiveDialog></ResponsiveDialog>,\n          document.getElementById(\"root\")\n        )}\n      </>\n    );\n  };\n\n  renderPrintAttachments = () => {\n    const { pdfLinks, isModalOpen } = this.state;\n\n    const renderAttachment = (pdfLink, index) => {\n      const hasName = pdfLink.name !== \"\";\n      const hasLink = pdfLink.link !== \"\";\n      const disabled = !hasLink;\n      const name = hasName ? pdfLink.name : \"Namn saknas\";\n      const linkText = hasLink ? \"Öppna\" : \"Länk saknas\";\n      const linkColor = hasLink ? \"primary\" : \"text.secondary\";\n      const linkIcon = hasLink ? (\n        <OpenInNewIcon sx={{ width: \"15px\" }} />\n      ) : null;\n\n      return (\n        <div key={index}>\n          <StyledListItemButton\n            disabled={disabled}\n            index={index}\n            onClick={() => this.openAttachmentModal(index)}\n          >\n            <Typography\n              sx={{\n                fontStyle: !hasName ? \"italic\" : \"inherit\",\n                color: !hasName ? \"gray\" : \"inherit\",\n              }}\n            >\n              {name}\n            </Typography>\n            {hasLink && (\n              <Button\n                href={pdfLink.link}\n                target=\"_blank\"\n                sx={{ height: \"28px\", padding: \"10px\", minWidth: \"auto\" }}\n                color={linkColor}\n                variant=\"contained\"\n                startIcon={linkIcon}\n                onClick={(event) => event.stopPropagation()}\n              >\n                <Typography variant=\"body2\" justify=\"center\">\n                  {linkText}\n                </Typography>\n              </Button>\n            )}\n            {!hasLink && (\n              <Typography sx={{ fontStyle: \"italic\" }}>Länk saknas</Typography>\n            )}\n          </StyledListItemButton>\n        </div>\n      );\n    };\n\n    return (\n      <>\n        <Typography align=\"center\" variant=\"h6\">\n          Bilagor\n        </Typography>\n        <Typography variant=\"h6\">Innehåll</Typography>\n        <GridMiddleContainer>\n          <List>{pdfLinks.map(renderAttachment)}</List>\n        </GridMiddleContainer>\n        {isModalOpen && this.renderDialog()}\n      </>\n    );\n  };\n\n  render() {\n    const { togglePrintWindow } = this.props;\n    const { showAttachments, pdfLinks } = this.state;\n\n    return (\n      <>\n        {!showAttachments ? (\n          <GridGridContainer container wrap=\"nowrap\" direction=\"column\">\n            <GridHeaderContainer\n              alignItems=\"center\"\n              justifyContent=\"space-between\"\n              item\n              container\n            >\n              <Grid item xs={4}>\n                <Button\n                  color=\"primary\"\n                  style={{ paddingLeft: 0 }}\n                  startIcon={<ArrowBackIcon />}\n                  onClick={togglePrintWindow}\n                >\n                  <Typography justify=\"center\">Tillbaka</Typography>\n                </Button>\n              </Grid>\n              <StyledGrid item xs={4}>\n                {pdfLinks?.length > 0 && (\n                  <Button\n                    color=\"primary\"\n                    style={{ paddingLeft: 0 }}\n                    endIcon={<ArrowForwardIcon />}\n                    onClick={() => this.toggleDocumentsAttachments()}\n                  >\n                    <Typography justify=\"center\">Bilagor</Typography>\n                  </Button>\n                )}\n              </StyledGrid>\n            </GridHeaderContainer>\n            {this.renderPrintDocuments()}\n          </GridGridContainer>\n        ) : (\n          <GridGridContainer container wrap=\"nowrap\" direction=\"column\">\n            <GridHeaderContainer\n              alignItems=\"center\"\n              justifyContent=\"space-between\"\n              item\n              container\n            >\n              <Grid item xs={4}>\n                <Button\n                  color=\"primary\"\n                  style={{ paddingLeft: 0 }}\n                  startIcon={<ArrowBackIcon />}\n                  onClick={() => this.toggleDocumentsAttachments()}\n                >\n                  <Typography justify=\"center\">Skapa Pdf</Typography>\n                </Button>\n              </Grid>\n            </GridHeaderContainer>\n            {this.renderPrintAttachments()}\n          </GridGridContainer>\n        )}\n      </>\n    );\n  }\n}\n\nexport default withSnackbar(PrintWindow);\n","import React from \"react\";\nimport { withTheme } from \"@emotion/react\";\nimport ListItem from \"@mui/material/ListItem\";\nimport ListItemText from \"@mui/material/ListItemText\";\nimport List from \"@mui/material/List\";\nimport { Typography } from \"@mui/material\";\nimport Grid from \"@mui/material/Grid\";\n\nclass TableOfContents extends React.PureComponent {\n  state = {\n    titlesAndLevels: [],\n  };\n\n  constructor(props) {\n    super(props);\n    this.titlesAndLevels = [];\n    this.previousGroupHeader = false;\n  }\n\n  componentDidMount = () => {\n    const { documentMenuState, allDocuments, mode } = this.props;\n\n    const tocStructure = this.createTocStructure(\n      documentMenuState,\n      allDocuments,\n      mode\n    );\n    Object.keys(tocStructure).forEach((key) => {\n      this.setTitlesAndLevels(tocStructure[key], mode);\n    });\n\n    this.setState({ titlesAndLevels: this.titlesAndLevels });\n  };\n\n  createTocStructure(documentMenuState, allDocuments) {\n    let menu = { ...documentMenuState };\n    //add the chapters from all documents onto the documentMenuState\n    Object.keys(menu).forEach((key) => {\n      let menuDoc = menu[key];\n      if (menuDoc.document) {\n        //get the corresponding chapters from allDocuments.\n        let jsonDoc = allDocuments.find(\n          (doc) => doc.documentFileName === menuDoc.document\n        );\n        //add the chapters to our doc in the menuState.\n        menu[key].chapters = jsonDoc.chapters;\n      }\n    });\n    return menu;\n  }\n\n  setTitlesAndLevels = (document, mode) => {\n    //If the chosen config for table of contents is to only include printed documents in the toc. skip the document if it's not chosen for print.\n    if (mode === \"partial\") {\n      if (document.chosenForPrint !== true) {\n        return;\n      }\n    }\n\n    let levelsToShow = document?.tocChapterLevels || 100;\n    let indentationLevel = 0;\n    let level = 0;\n\n    /*If a document is under a menu parent, push the level up, as the levelsToShow property\n    in the document configuration is specific to that document, and does not take into account. that having\n    a parent document may change it's level*/\n    if (document.allParents.length) {\n      level++;\n      levelsToShow++;\n      indentationLevel += document.allParents.length;\n    }\n\n    //Add the menu document title if it is a menu parent that just holds other documents;\n    if (!document.document) {\n      this.titlesAndLevels.push({\n        title: document.title,\n        level: indentationLevel,\n        chosenForPrint: document.chosenForPrint,\n      });\n    }\n\n    //add the documents chapters to the table of contents.\n    if (document.chapters) {\n      level++;\n      if (level <= levelsToShow) {\n        document.chapters.forEach((chapter) => {\n          this.titlesAndLevels.push({\n            title: chapter.header,\n            level: indentationLevel,\n          });\n          this.setChapterTitlesAndLevels(\n            chapter,\n            levelsToShow,\n            level + 1,\n            indentationLevel + 1\n          );\n        });\n      }\n    }\n  };\n\n  setChapterTitlesAndLevels = (\n    chapter,\n    levelsToShow,\n    level,\n    indentationLevel\n  ) => {\n    if (chapter.chapters && level <= levelsToShow) {\n      chapter.chapters.forEach((subChapter) => {\n        this.titlesAndLevels.push({\n          title: subChapter.header,\n          level: indentationLevel,\n        });\n        this.setChapterTitlesAndLevels(\n          subChapter,\n          levelsToShow,\n          level + 1,\n          indentationLevel + 1\n        );\n      });\n    }\n  };\n\n  render() {\n    const { titlesAndLevels } = this.state;\n    return (\n      <Grid container sx={{ pageBreakAfter: \"always\" }}>\n        <Typography variant=\"h4\" gutterBottom={true}>\n          Innehållsförteckning\n        </Typography>\n        <List style={{ width: \"100%\" }} disablePadding>\n          {titlesAndLevels.map((document, index) => {\n            return document.chosenForPrint ? (\n              <ListItem\n                key={index}\n                dense={true}\n                sx={{\n                  paddingLeft: 1 + document.level * 3,\n                }}\n              >\n                <ListItemText>{document.title}</ListItemText>\n              </ListItem>\n            ) : (\n              <ListItem\n                dense={true}\n                key={index}\n                sx={{\n                  paddingLeft: 1 + document.level * 3,\n                }}\n              >\n                <ListItemText>{document.title}</ListItemText>\n              </ListItem>\n            );\n          })}\n        </List>\n      </Grid>\n    );\n  }\n}\n\nexport default withTheme(TableOfContents);\n","export const splitAndTrimOnCommas = (searchString) => {\n  return searchString.split(\",\").map((string) => {\n    return string.trim();\n  });\n};\n\nexport const getStringArray = (searchString) => {\n  let tempStringArray = splitAndTrimOnCommas(searchString);\n  return tempStringArray.join(\" \").split(\" \");\n};\n\nexport const hasSubMenu = (item) => {\n  return item.menu && item.menu.length > 0;\n};\n\nexport const flattenChaptersTree = (chapters) => {\n  return chapters.reduce((acc, chapter) => {\n    if (chapter.header) {\n      let chapterStrippedFromSubChapters = { ...chapter };\n      chapterStrippedFromSubChapters.chapters = [];\n      acc = [...acc, chapterStrippedFromSubChapters];\n    }\n    if (chapter.chapters && chapter.chapters.length > 0) {\n      return [...acc, ...flattenChaptersTree(chapter.chapters)];\n    }\n    return acc;\n  }, []);\n};\n","import React from \"react\";\nimport { hasSubMenu } from \"../utils/helpers\";\n\nconst getAllChildrenIds = (menu) => {\n  return menu.reduce((allChildren, item) => {\n    if (hasSubMenu(item)) {\n      allChildren = [...allChildren, ...getAllChildrenIds(item.menu)];\n    }\n    return [...allChildren, item.id];\n  }, []);\n};\n/**\n * Function takes the hierarchial menu and flattens it into a normalized state where\n * the objects key is the id of the menu-item. The structure is now flat and every\n * object has references to parents, children etc.\n * While we are normalizing, we are also setting internal properties we later use\n * to make items selected, colored etc.\n */\nexport const getNormalizedMenuState = (\n  menu,\n  parentId = null,\n  level = 0,\n  parentIds = []\n) => {\n  let normalizedItemList = menu.reduce((items, menuItem) => {\n    menuItem = {\n      ...menuItem,\n      ...{\n        parentId,\n        level,\n        menuItemIds: [],\n        allChildren: [],\n        allParents: parentIds,\n        itemRef: React.createRef(),\n      },\n    };\n\n    if (menuItem.menu && menuItem.menu.length > 0) {\n      menuItem.allChildren = [\n        ...menuItem.allChildren,\n        ...getAllChildrenIds(menuItem.menu),\n      ];\n      menuItem.menuItemIds = [\n        ...menuItem.menuItemIds,\n        ...menuItem.menu.map((menuItem) => {\n          return menuItem.id;\n        }),\n      ];\n\n      items = {\n        ...items,\n        ...getNormalizedMenuState(menuItem.menu, menuItem.id, level + 1, [\n          ...parentIds,\n          menuItem.id,\n        ]),\n      };\n    }\n    return { ...items, ...{ [menuItem.id]: menuItem } };\n  }, {});\n  Object.values(normalizedItemList).forEach((n) => {\n    delete n.menu;\n  });\n  return normalizedItemList;\n};\n"],"names":["PrintList","React","getMenuItemType","item","type","this","props","menu","icon","id","level","color","title","itemRef","subMenuItems","getSubMenuItems","expanded","expandedSubMenu","colored","selected","chosenForPrint","handleTogglePrint","menuItemIds","reduce","subItemId","subItem","Object","values","documentMenu","find","i","length","renderMenuItem","document","link","maplink","render","sx","width","disablePadding","filter","map","StyledListItemIcon","styled","ListItemIcon","theme","minWidth","spacing","StyledCollapseIcon","StyledListItem","ListItem","overflowWrap","borderLeft","palette","background","paper","borderLeftColor","action","borderColor","hover","PrintListItem","style","visuallyHidden","localObserver","publish","hasSubMenu","paddingLeft","paddingRight","divider","button","ref","size","disableGutters","onClick","checked","onChange","e","stopPropagation","edge","tabIndex","disableRipple","in","timeout","withTheme","GridGridContainer","Grid","padding","height","overflowX","GridMiddleContainer","marginTop","opacity","boxShadow","webkitBoxShadow","backgroundColor","flexBasis","GridHeaderContainer","marginBottom","GridSettingsContainer","GridFooterContainer","StyledGrid","display","justifyContent","StyledListItemButton","ListItemButton","index","borderBottom","StyledDialogContent","DialogContent","overflowY","position","content","paddingTop","StyledIframe","top","left","margin","ComponentWithRenderCallback","callback","children","useEffect","PrintWindow","state","printLinks","printText","printImages","printMaps","allDocumentsToggled","tocPrintMode","options","tableOfContents","printMode","menuInformation","createMenu","printContent","undefined","pdfLoading","isAnyDocumentSelected","showAttachments","selectedPdfIndex","isModalOpen","pdfLinks","checkPdfLinks","internalId","idClicked","Promise","resolve","currentState","clickedItem","newState","items","setState","newItem","allParents","indexOf","componentDidMount","subscribe","renderedChapters","printContents","componentWillUnmount","unsubscribe","resizeImage","img","getBoundingClientRect","clientWidth","imageFitsOnePage","maxHeight","loadImage","reject","onload","onerror","customRender","element","container","deepMerge","customTheme","createRoot","createPrintElement","div","createElement","renderToc","toc","documentMenuState","allDocuments","model","mode","renderContent","areAllImagesLoaded","allSettled","getElementsByTagName","handleNewWindowBlocked","window","alert","createPrintWindow","printWindow","open","head","insertAdjacentHTML","location","protocol","host","dynamicImportUrls","customFont","clearPrintContainers","handlePrintCompleted","toggleAllDocuments","addPageBreaksBeforeHeadings","headings","querySelectorAll","isAfterH1","isConsecutiveH1","nodeName","pageBreakBefore","breakBefore","all","then","appendChild","newWindow","s","createTextNode","textContent","sheet","rule","cssRules","insertRule","cssText","error","console","warn","body","print","close","handleCheckboxChange","chapter","newChapterInformation","chapterInformation","toggledChapter","getChapterById","toggleSubChapters","toggleChosenForPrint","documentId","current","shouldPrint","updateDoc","updatedMenuState","toggleSubDocuments","parentId","toggleParentChecked","toggleParentUnchecked","setIsAnyDocumentSelected","toggled","menuState","keys","forEach","key","removeTagsNotSelectedForPrint","elementsToRemove","innerHTML","html","Array","from","push","header","documentLinks","setAttribute","href","parentNode","removeChild","prepareChapterForPrint","chapters","subChapter","createHeaderItems","menuItem","isGroupHeader","getDocumentsToPrint","documentIdsForPrint","documentNamesForPrint","docsIncludingGroupParent","getDocuments","doc","menuDocKey","documentFileName","newDocs","preparedChapters","createPDF","documentsToPrint","renderLoadingDialog","createPortal","disableEscapeKeyDown","getElementById","toggleDocumentsAttachments","prevState","renderPrintDocuments","documentWindowMaximized","align","variant","xs","value","control","label","labelPlacement","renderCreatePDFButton","openAttachmentModal","closeAttachmentModal","renderDialog","ResponsiveDialog","useTheme","fullScreen","useMediaQuery","breakpoints","down","PaperProps","BackdropProps","onClose","name","src","renderPrintAttachments","pdfLink","hasName","hasLink","disabled","linkText","linkColor","linkIcon","fontStyle","target","startIcon","event","justify","setInitialMenuItemProperties","subMenuItem","removeNonPrintableDocuments","documents","removedIds","trim","parseInt","newChildren","allChildren","child","includes","newMenuItemIds","modelDocuments","menuConfig","menuConfigClone","JSON","parse","stringify","menuStructure","getNormalizedMenuState","getAllChapterInfo","idOffset","offsetChildren","offsetParents","offsetMenuItemIds","modelDoc","tocChapterLevels","chapterLevelsToShow","menuWithOffset","keyOffset","subDocId","updatedParent","alignContent","alignItems","marginRight","marginLeft","togglePrintWindow","wrap","direction","endIcon","withSnackbar","TableOfContents","constructor","super","titlesAndLevels","tocStructure","createTocStructure","setTitlesAndLevels","levelsToShow","indentationLevel","setChapterTitlesAndLevels","previousGroupHeader","menuDoc","jsonDoc","pageBreakAfter","gutterBottom","dense","splitAndTrimOnCommas","searchString","split","string","getStringArray","join","flattenChaptersTree","acc","chapterStrippedFromSubChapters","getAllChildrenIds","parentIds","normalizedItemList","n"],"sourceRoot":""}