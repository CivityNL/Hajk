"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[3675],{73675:(e,t,o)=>{o.r(t);var i=o(42708),s=o(62652),r=o(9501),a=o(5426),n=o(29409),c=o(56134),d=o(64665),l=o(18029),h=o(5400),g=o(66233),p=o(90927);t.default=class{constructor(e){var t,o;this.addMarker=e=>{const t=new s.Z({geometry:new n.Z(e)}),o=new d.ZP({image:new l.Z({anchor:[.5,1],scale:.15,src:"marker.png"})});t.setStyle(o),this.vector.getSource().clear(),this.source.addFeature(t)},this.centerOnMarker=()=>{this.vector.getSource().getFeatures().length>0&&this.map.getView().setCenter(this.vector.getSource().getFeatures()[0].getGeometry().getCoordinates())},this.zoomOnMarker=()=>{this.vector.getSource().getFeatures().length>0&&this.map.getView().fit(this.vector.getSource().getFeatures()[0].getGeometry())},this.goToUserLocation=()=>{if(navigator.geolocation){const e={enableHighAccuracy:!0,timeout:5e3,maximumAge:3e4};navigator.geolocation.getCurrentPosition((e=>{const t=new n.Z([e.coords.longitude,e.coords.latitude]);t.transform("EPSG:4326",this.map.getView().getProjection().getCode()),this.coordinates=t.getCoordinates(),this.localObserver.publish("newCoordinates",{coordinates:this.coordinates,proj:this.map.getView().getProjection().getCode(),force:!0}),this.map.getView().setCenter(t.getCoordinates())}),(e=>{1===e.code&&this.localObserver.publish("location-permissions-denied")}),e)}},this.resetCoords=()=>{this.vector.getSource().clear(),this.localObserver.publish("resetCoordinates"),this.coordinates=void 0},this.handleDrawEnd=e=>{this.coordinates=e.feature.getGeometry().getCoordinates(),this.addMarker(this.coordinates),this.localObserver.publish("newCoordinates",{coordinates:this.coordinates,proj:this.map.getView().getProjection(),force:!0})},this.app=e.app,this.map=e.map,this.localObserver=e.localObserver,this.thousandSeparator=null!==(t=e.options.thousandSeparator)&&void 0!==t&&t,this.showFieldsOnStart=null!==(o=e.options.showFieldsOnStart)&&void 0!==o&&o,this.coordinates=void 0,this.transformations=e.options.transformations,this.transformations&&0!==this.transformations.length?this.transformations.forEach((e=>{var t,o,i,s,r,a,n,c;e.code=null!==(t=e.code)&&void 0!==t?t:"",e.precision=null!==(o=e.precision)&&void 0!==o?o:3,e.default=null!==(i=e.default)&&void 0!==i&&i,e.title=null!==(s=e.title)&&void 0!==s?s:"",e.xtitle=null!==(r=e.xtitle)&&void 0!==r?r:"",e.ytitle=null!==(a=e.ytitle)&&void 0!==a?a:"",e.inverseAxis=null!==(n=e.inverseAxis)&&void 0!==n?n:"",e.coordinates=null!==(c=e.coordinates)&&void 0!==c?c:""})):this.transformations=[{code:"EPSG:4326",precision:3,default:!1,hint:"",title:"WGS84",xtitle:"Lng",ytitle:"Lat",inverseAxis:!0}],this.source=new a.Z,this.vector=new r.Z({layerType:"system",zIndex:5e3,name:"pluginCoordinate",caption:"Coordinate layer",source:this.source}),this.map.addLayer(this.vector),this.localObserver.subscribe("newCoordinates",(e=>{let t=e.coordinates;e.proj!==this.map.getView().getProjection().getCode()&&(t=(0,i.vs)(e.coordinates,e.proj,this.map.getView().getProjection().getCode())),this.addMarker(t)}))}activate(){this.addInteraction(),this.localObserver.publish("showSnackbar"),this.showFieldsOnStart&&this.localObserver.publish("newCoordinates",{coordinates:this.map.getView().getCenter(),proj:this.map.getView().getProjection().getCode(),force:!0})}deactivate(){this.removeInteraction(),this.vector.getSource().clear(),this.localObserver.publish("hideSnackbar")}addInteraction(){this.draw=new c.ZP({source:this.source,type:"Point",style:new d.ZP({image:new h.Z({radius:5,stroke:new g.Z({color:"rgba(0, 0, 0, 0.7)"}),fill:new p.Z({color:"rgba(255, 255, 255, 0.2)"})})})}),this.draw.on("drawend",this.handleDrawEnd),this.map.addInteraction(this.draw),this.map.clickLock.add("coordinates"),this.map.snapHelper.add("coordinates")}removeInteraction(){this.map.snapHelper.delete("coordinates"),this.map.removeInteraction(this.draw),this.map.clickLock.delete("coordinates")}closeSnackbar(){this.localObserver.publish("hideSnackbar")}}}}]);
//# sourceMappingURL=3675.32c3f031.chunk.js.map