"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[8690],{79717:(e,t,i)=>{var s=i(68789),n=i(96289),r=i(25326),o=i(5947),a=i(62652),h=i(66549),l=i(29409),d=i(55736),u=i(9369),g=i(23581),c=i(9501),_=i(5426),f=i(2177),m=i(37130),y=i(32024),p=i(64665),v=i(37678),x=i(56957),C=i(42708),F=i(66006);const S=[0,0,0,0],E=[],P="modifystart",b="modifyend";class M extends r.ZP{constructor(e,t,i){super(e),this.features=t,this.mapBrowserEvent=i}}class w extends d.Z{constructor(e){let t;if(super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:f.Xp,this.defaultDeleteCondition_=function(e){return(0,f.Ko)(e)&&(0,f.Kf)(e)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:f.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new u.Z,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new c.Z({source:new _.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:B(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null,e.features?t=e.features:e.source&&(this.source_=e.source,t=new s.Z(this.source_.getFeatures()),this.source_.addEventListener(g.Z.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(g.Z.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(n.Z.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(n.Z.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=void 0===e.snapToPointer?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),e.addEventListener(o.Z.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new s.Z;const i=this.featuresBeingModified_.getArray();for(let e=0,s=t.length;e<s;++e){const s=t[e];for(let e=0,t=s.length;e<t;++e){const t=s[e].feature;t&&!i.includes(t)&&this.featuresBeingModified_.push(t)}}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new M(P,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(o.Z.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,i=[];t.forEach((function(t){e===t.feature&&i.push(t)}));for(let s=i.length-1;s>=0;--s){const e=i[s];for(let t=this.dragSegments_.length-1;t>=0;--t)this.dragSegments_[t][0]===e&&this.dragSegments_.splice(t,1);t.remove(e)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const i=t.getCoordinates(),s={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),s)}writeMultiPointGeometry_(e,t){const i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){const n=i[s],r={feature:e,geometry:t,depth:[s],index:s,segment:[n,n]};this.rBush_.insert(t.getExtent(),r)}}writeLineStringGeometry_(e,t){const i=t.getCoordinates();for(let s=0,n=i.length-1;s<n;++s){const n=i.slice(s,s+2),r={feature:e,geometry:t,index:s,segment:n};this.rBush_.insert((0,m.boundingExtent)(n),r)}}writeMultiLineStringGeometry_(e,t){const i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){const n=i[s];for(let i=0,r=n.length-1;i<r;++i){const r=n.slice(i,i+2),o={feature:e,geometry:t,depth:[s],index:i,segment:r};this.rBush_.insert((0,m.boundingExtent)(r),o)}}}writePolygonGeometry_(e,t){const i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){const n=i[s];for(let i=0,r=n.length-1;i<r;++i){const r=n.slice(i,i+2),o={feature:e,geometry:t,depth:[s],index:i,segment:r};this.rBush_.insert((0,m.boundingExtent)(r),o)}}}writeMultiPolygonGeometry_(e,t){const i=t.getCoordinates();for(let s=0,n=i.length;s<n;++s){const n=i[s];for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let n=0,o=r.length-1;n<o;++n){const o=r.slice(n,n+2),a={feature:e,geometry:t,depth:[i,s],index:n,segment:o};this.rBush_.insert((0,m.boundingExtent)(o),a)}}}}writeCircleGeometry_(e,t){const i=t.getCenter(),s={feature:e,geometry:t,index:0,segment:[i,i]},n={feature:e,geometry:t,index:1,segment:[i,i]},r=[s,n];s.featureSegments=r,n.featureSegments=r,this.rBush_.insert((0,m.createOrUpdateFromCoordinate)(i),s);let o=t;const a=(0,C.Cs)();if(a&&this.getMap()){const e=this.getMap().getView().getProjection();o=o.clone().transform(a,e),o=(0,x.Bb)(o).transform(e,a)}this.rBush_.insert(o.getExtent(),n)}writeGeometryCollectionGeometry_(e,t){const i=t.getGeometriesArray();for(let s=0;s<i.length;++s){const t=i[s];(0,this.SEGMENT_WRITERS_[t.getType()])(e,t)}}createOrUpdateVertexFeature_(e,t,i){let s=this.vertexFeature_;if(s){s.getGeometry().setCoordinates(e)}else s=new a.Z(new l.Z(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s);return s.set("features",t),s.set("geometries",i),s}handleEvent(e){if(!e.originalEvent)return!0;let t;return this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=h.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=h.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==h.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],s=[];for(let n=0,r=this.dragSegments_.length;n<r;++n){const r=this.dragSegments_[n],o=r[0],a=o.feature;i.includes(a)||i.push(a);const h=o.geometry;s.includes(h)||s.push(h);const l=o.depth;let d;const u=o.segment,g=r[1];for(;t.length<h.getStride();)t.push(u[g][t.length]);switch(h.getType()){case"Point":d=t,u[0]=t,u[1]=t;break;case"MultiPoint":d=h.getCoordinates(),d[o.index]=t,u[0]=t,u[1]=t;break;case"LineString":d=h.getCoordinates(),d[o.index+g]=t,u[g]=t;break;case"MultiLineString":case"Polygon":d=h.getCoordinates(),d[l[0]][o.index+g]=t,u[g]=t;break;case"MultiPolygon":d=h.getCoordinates(),d[l[1]][l[0]][o.index+g]=t,u[g]=t;break;case"Circle":if(u[0]=t,u[1]=t,0===o.index)this.changingFeature_=!0,h.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;const i=e.map.getView().getProjection();let s=(0,y.TE)((0,C.Vs)(h.getCenter(),i),(0,C.Vs)(t,i));const n=(0,C.Cs)();if(n){const e=h.clone().transform(n,i);e.setRadius(s),s=e.transform(i,n).getRadius()}h.setRadius(s),this.changingFeature_=!1}}d&&this.setGeometryCoordinates_(h,d)}this.createOrUpdateVertexFeature_(t,i,s)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;const i=this.vertexFeature_;if(i){const s=e.map.getView().getProjection(),n=[],r=i.getGeometry().getCoordinates(),o=(0,m.boundingExtent)([r]),a=this.rBush_.getInExtent(o),h={};a.sort(T);for(let i=0,l=a.length;i<l;++i){const o=a[i],l=o.segment;let d=(0,F.sq)(o.geometry);const u=o.depth;if(u&&(d+="-"+u.join("-")),h[d]||(h[d]=new Array(2)),"Circle"!==o.geometry.getType()||1!==o.index)if(!(0,y.fS)(l[0],r)||h[d][0])if(!(0,y.fS)(l[1],r)||h[d][1])(0,F.sq)(l)in this.vertexSegments_&&!h[d][0]&&!h[d][1]&&this.insertVertexCondition_(e)&&n.push(o);else{if(h[d][0]&&0===h[d][0].index){let e=o.geometry.getCoordinates();switch(o.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":e=e[u[1]];case"Polygon":if(o.index!==e[u[0]].length-2)continue}}this.dragSegments_.push([o,1]),h[d][1]=o}else this.dragSegments_.push([o,0]),h[d][0]=o;else{const e=A(t,o,s);(0,y.fS)(e,r)&&!h[d][0]&&(this.dragSegments_.push([o,0]),h[d][0]=o)}}n.length&&this.willModifyFeatures_(e,[n]);for(let e=n.length-1;e>=0;--e)this.insertVertex_(n[e],r)}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const i=this.dragSegments_[t][0],s=i.geometry;if("Circle"===s.getType()){const t=s.getCenter(),n=i.featureSegments[0],r=i.featureSegments[1];n.segment[0]=t,n.segment[1]=t,r.segment[0]=t,r.segment[1]=t,this.rBush_.update((0,m.createOrUpdateFromCoordinate)(t),n);let o=s;const a=(0,C.Cs)();if(a){const t=e.map.getView().getProjection();o=o.clone().transform(a,t),o=(0,x.Bb)(o).transform(t,a)}this.rBush_.update(o.getExtent(),r)}else this.rBush_.update((0,m.boundingExtent)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new M(b,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}handlePointerAtPixel_(e,t,i){const s=i||t.getCoordinateFromPixel(e),n=t.getView().getProjection(),r=function(e,t){return L(s,e,n)-L(s,t,n)};let o,h;if(this.hitDetection_){const i="object"===typeof this.hitDetection_?e=>e===this.hitDetection_:void 0;t.forEachFeatureAtPixel(e,((e,t,i)=>{const s=i||e.getGeometry();if("Point"===s.getType()&&e instanceof a.Z&&this.features_.getArray().includes(e)){h=s;const t=h.getFlatCoordinates().slice(0,2);o=[{feature:e,geometry:h,segment:[t,t]}]}return!0}),{layerFilter:i})}if(!o){const e=(0,C.dY)((0,m.createOrUpdateFromCoordinate)(s,S),n),i=t.getView().getResolution()*this.pixelTolerance_,r=(0,C.Fj)((0,m.buffer)(e,i,S),n);o=this.rBush_.getInExtent(r)}if(o&&o.length>0){const i=o.sort(r)[0],a=i.segment;let l=A(s,i,n);const d=t.getPixelFromCoordinate(l);let u=(0,y.TE)(e,d);if(h||u<=this.pixelTolerance_){const e={};if(e[(0,F.sq)(a)]=!0,this.snapToPointer_||(this.delta_[0]=l[0]-s[0],this.delta_[1]=l[1]-s[1]),"Circle"===i.geometry.getType()&&1===i.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l,[i.feature],[i.geometry]);else{const s=t.getPixelFromCoordinate(a[0]),n=t.getPixelFromCoordinate(a[1]),r=(0,y.bI)(d,s),h=(0,y.bI)(d,n);u=Math.sqrt(Math.min(r,h)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(l=r>h?a[1]:a[0]),this.createOrUpdateVertexFeature_(l,[i.feature],[i.geometry]);const g={};g[(0,F.sq)(i.geometry)]=!0;for(let t=1,i=o.length;t<i;++t){const i=o[t].segment;if(!((0,y.fS)(a[0],i[0])&&(0,y.fS)(a[1],i[1])||(0,y.fS)(a[0],i[1])&&(0,y.fS)(a[1],i[0])))break;{const s=(0,F.sq)(o[t].geometry);s in g||(g[s]=!0,e[(0,F.sq)(i)]=!0)}}}return void(this.vertexSegments_=e)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const i=e.segment,s=e.feature,n=e.geometry,r=e.depth,o=e.index;let a;for(;t.length<n.getStride();)t.push(0);switch(n.getType()){case"MultiLineString":case"Polygon":a=n.getCoordinates(),a[r[0]].splice(o+1,0,t);break;case"MultiPolygon":a=n.getCoordinates(),a[r[1]][r[0]].splice(o+1,0,t);break;case"LineString":a=n.getCoordinates(),a.splice(o+1,0,t);break;default:return}this.setGeometryCoordinates_(n,a);const h=this.rBush_;h.remove(e),this.updateSegmentIndices_(n,o,r,1);const l={segment:[i[0],t],feature:s,geometry:n,depth:r,index:o};h.insert((0,m.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);const d={segment:[t,i[1]],feature:s,geometry:n,depth:r,index:o+1};h.insert((0,m.boundingExtent)(d.segment),d),this.dragSegments_.push([d,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=h.Z.POINTERDRAG){const e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);const t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new M(b,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}removeVertex_(){const e=this.dragSegments_,t={};let i,s,n,r,o,a,h,l,d,u,g,c=!1;for(o=e.length-1;o>=0;--o)n=e[o],u=n[0],g=(0,F.sq)(u.feature),u.depth&&(g+="-"+u.depth.join("-")),g in t||(t[g]={}),0===n[1]?(t[g].right=u,t[g].index=u.index):1==n[1]&&(t[g].left=u,t[g].index=u.index+1);for(g in t){switch(d=t[g].right,h=t[g].left,a=t[g].index,l=a-1,u=void 0!==h?h:d,l<0&&(l=0),r=u.geometry,s=r.getCoordinates(),i=s,c=!1,r.getType()){case"MultiLineString":s[u.depth[0]].length>2&&(s[u.depth[0]].splice(a,1),c=!0);break;case"LineString":s.length>2&&(s.splice(a,1),c=!0);break;case"MultiPolygon":i=i[u.depth[1]];case"Polygon":i=i[u.depth[0]],i.length>4&&(a==i.length-1&&(a=0),i.splice(a,1),c=!0,0===a&&(i.pop(),i.push(i[0]),l=i.length-1))}if(c){this.setGeometryCoordinates_(r,s);const t=[];if(void 0!==h&&(this.rBush_.remove(h),t.push(h.segment[0])),void 0!==d&&(this.rBush_.remove(d),t.push(d.segment[1])),void 0!==h&&void 0!==d){const e={depth:u.depth,feature:u.feature,geometry:u.geometry,index:l,segment:t};this.rBush_.insert((0,m.boundingExtent)(e.segment),e)}this.updateSegmentIndices_(r,a,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return c}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,i,s){this.rBush_.forEachInExtent(e.getExtent(),(function(n){n.geometry===e&&(void 0===i||void 0===n.depth||(0,v.fS)(n.depth,i))&&n.index>t&&(n.index+=s)}))}}function T(e,t){return e.index-t.index}function L(e,t,i){const s=t.geometry;if("Circle"===s.getType()){let n=s;if(1===t.index){const t=(0,C.Cs)();t&&(n=n.clone().transform(t,i));const s=(0,y.bI)(n.getCenter(),(0,C.Vs)(e,i)),r=Math.sqrt(s)-n.getRadius();return r*r}}const n=(0,C.Vs)(e,i);return E[0]=(0,C.Vs)(t.segment[0],i),E[1]=(0,C.Vs)(t.segment[1],i),(0,y.Bs)(n,E)}function A(e,t,i){const s=t.geometry;if("Circle"===s.getType()&&1===t.index){let t=s;const n=(0,C.Cs)();return n&&(t=t.clone().transform(n,i)),(0,C.lO)(t.getClosestPoint((0,C.Vs)(e,i)),i)}const n=(0,C.Vs)(e,i);return E[0]=(0,C.Vs)(t.segment[0],i),E[1]=(0,C.Vs)(t.segment[1],i),(0,C.lO)((0,y.oL)(n,E),i)}function B(){const e=(0,p.Ly)();return function(t,i){return e.Point}}t.Z=w},489:(e,t,i)=>{var s=i(68789),n=i(96289),r=i(25326),o=i(62652),a=i(68417),h=i(9501),l=i(96661),d=i(66841),u=i(64665),g=i(37678),c=i(66006),_=i(2177);const f="select";class m extends r.ZP{constructor(e,t,i,s){super(e),this.selected=t,this.deselected=i,this.mapBrowserEvent=s}}const y={};class p extends a.ZP{constructor(e){let t;if(super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:_.Kf,this.addCondition_=e.addCondition?e.addCondition:_.Fi,this.removeCondition_=e.removeCondition?e.removeCondition:_.Fi,this.toggleCondition_=e.toggleCondition?e.toggleCondition:_.vY,this.multi_=!!e.multi&&e.multi,this.filter_=e.filter?e.filter:l.uX,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=void 0!==e.style?e.style:function(){const e=(0,u.Ly)();return(0,g.l7)(e.Polygon,e.LineString),(0,g.l7)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(),this.features_=e.features||new s.Z,e.layers)if("function"===typeof e.layers)t=e.layers;else{const i=e.layers;t=function(e){return i.includes(e)}}else t=l.uX;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[(0,c.sq)(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[(0,c.sq)(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.addEventListener(n.Z.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(n.Z.ADD,this.boundAddFeature_),this.features_.removeEventListener(n.Z.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const e=this.getMap().getAllLayers().find((function(e){if(e instanceof h.Z&&e.getSource()&&e.getSource().hasFeature(t))return e}));e&&this.addFeatureLayerAssociation_(t,e)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=(0,c.sq)(e);t in y||(y[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let s=t.length-1;s>=0;--s){const i=t[s];if(i!==this&&i instanceof p&&i.getStyle()&&-1!==i.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(i.getStyle())}const i=(0,c.sq)(e);e.setStyle(y[i]),delete y[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[(0,c.sq)(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),s=this.toggleCondition_(e),n=!t&&!i&&!s,r=e.map,a=this.getFeatures(),h=[],l=[];if(n){(0,d.Z)(this.featureLayerAssociation_),r.forEachFeatureAtPixel(e.pixel,((e,t)=>{if(e instanceof o.Z&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),l.push(e),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=a.getLength()-1;e>=0;--e){const t=a.item(e),i=l.indexOf(t);i>-1?l.splice(i,1):(a.remove(t),h.push(t))}0!==l.length&&a.extend(l)}else{r.forEachFeatureAtPixel(e.pixel,((e,n)=>{if(e instanceof o.Z&&this.filter_(e,n))return!t&&!s||a.getArray().includes(e)?(i||s)&&a.getArray().includes(e)&&(h.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,n),l.push(e)),!this.multi_}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let e=h.length-1;e>=0;--e)a.remove(h[e]);a.extend(l)}return(l.length>0||h.length>0)&&this.dispatchEvent(new m(f,l,h,e)),!0}}t.Z=p},24673:(e,t,i)=>{var s=i(68789),n=i(25326),r=i(62652),o=i(53803),a=i(55736),h=i(96661),l=i(2177);const d="translatestart",u="translating",g="translateend";class c extends n.ZP{constructor(e,t,i,s,n){super(e),this.features=t,this.coordinate=i,this.startCoordinate=s,this.mapBrowserEvent=n}}class _ extends a.Z{constructor(e){let t;if(super(e=e||{}),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=void 0!==e.features?e.features:null,e.layers&&!this.features_)if("function"===typeof e.layers)t=e.layers;else{const i=e.layers;t=function(e){return i.includes(e)}}else t=h.uX;this.layerFilter_=t,this.filter_=e.filter&&!this.features_?e.filter:h.uX,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:l.Bx,this.lastFeature_=null,this.addChangeListener(o.Z.ACTIVE,this.handleActiveChanged_)}handleDownEvent(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);const t=this.features_||new s.Z([this.lastFeature_]);return this.dispatchEvent(new c(d,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}handleUpEvent(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);const t=this.features_||new s.Z([this.lastFeature_]);return this.dispatchEvent(new c(g,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}handleDragEvent(e){if(this.lastCoordinate_){const t=e.coordinate,i=t[0]-this.lastCoordinate_[0],n=t[1]-this.lastCoordinate_[1],r=this.features_||new s.Z([this.lastFeature_]);r.forEach((function(e){const t=e.getGeometry();t.translate(i,n),e.setGeometry(t)})),this.lastCoordinate_=t,this.dispatchEvent(new c(u,r,t,this.startCoordinate_,e))}}handleMoveEvent(e){const t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(e,t){return t.forEachFeatureAtPixel(e,((e,t)=>{if(e instanceof r.Z&&this.filter_(e,t)&&(!this.features_||this.features_.getArray().includes(e)))return e}),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(e){this.hitTolerance_=e}setMap(e){const t=this.getMap();super.setMap(e),this.updateState_(t)}handleActiveChanged_(){this.updateState_(null)}updateState_(e){let t=this.getMap();const i=this.getActive();if((!t||!i)&&(t=t||e,t)){t.getViewport().classList.remove("ol-grab","ol-grabbing")}}}t.Z=_}}]);
//# sourceMappingURL=8690.322cde1d.chunk.js.map