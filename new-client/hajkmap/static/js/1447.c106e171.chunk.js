"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[1447,1960,2189,8428,6542,4711],{15717:(e,t,n)=>{n.r(t);var s=n(72791),i=n(90493),r=n(47327),o=n(80184);class l extends s.Component{constructor(){super(...arguments),this.getMenuItemType=(e,t)=>(0,o.jsx)(r.default,{...this.props,type:t,menu:e.menu,icon:e.icon,id:e.id,level:e.level,color:e.color,title:e.title,itemRef:e.itemRef,subMenuItems:this.getSubMenuItems(e),expanded:e.expandedSubMenu,colored:e.colored,selected:e.selected,chosenForPrint:e.chosenForPrint,handleTogglePrint:this.props.handleTogglePrint}),this.getSubMenuItems=e=>e.menuItemIds.reduce(((e,t)=>{const n=Object.values(this.props.documentMenu).find((e=>e.id===t));return n.menuItemIds.length>0&&(e=[...e,...this.getSubMenuItems(n)]),[...e,n]}),[]),this.renderMenuItem=(e,t)=>e.menuItemIds&&e.menuItemIds.length>0?this.getMenuItemType(e,"submenu"):e.document?this.getMenuItemType(e,"document"):e.link?this.getMenuItemType(e,"link"):e.maplink?this.getMenuItemType(e,"maplink"):void 0}render(){const{documentMenu:e,level:t}=this.props;return(0,o.jsx)(i.Z,{sx:{width:"100%"},disablePadding:!0,children:Object.values(e).filter((e=>e.level===t)).map((e=>(0,o.jsx)(s.Fragment,{children:this.renderMenuItem(e,e.id)},e.id)))})}}t.default=l},47327:(e,t,n)=>{n.r(t);var s=n(66274),i=n(99359),r=n(72791),o=n(66934),l=n(95573),a=n(9933),c=n(57064),d=n(45484),h=n(49900),u=n(94454),p=n(56125),m=n(22885),g=n(81131),f=n(15717),b=n(80184);const x=(0,o.ZP)(c.Z)((e=>{let{theme:t}=e;return{minWidth:t.spacing(3)}})),P=(0,o.ZP)(c.Z)((e=>{let{theme:t}=e;return{".MuiListItemIcon-root":{minWidth:t.spacing(4)}}})),v=(0,o.ZP)(d.ZP)((e=>{let{theme:t}=e;return{overflowWrap:"break-word",".MuiListItem-root":{borderLeft:"".concat(t.spacing(1)," solid ").concat(t.palette.background.paper),"&.Mui-selected":{borderLeftColor:t.palette.action.selected},"&.Mui-selected:hover":{borderLeftColor:t.palette.action.selected},"&:hover":{borderColor:t.palette.action.hover}}}}));var j=(0,i.Z)("getListTitle"),y=(0,i.Z)("getCollapseIcon"),I=(0,i.Z)("hasSubMenu"),k=(0,i.Z)("handleMenuButtonClick"),Z=(0,i.Z)("getMenuItemStyle");class C extends r.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,j,{writable:!0,value:()=>{const{title:e}=this.props;return(0,b.jsx)(h.Z,{children:e})}}),Object.defineProperty(this,y,{writable:!0,value:()=>{const{title:e,expanded:t}=this.props;return t?(0,b.jsxs)(P,{children:[!e&&(0,b.jsx)("span",{style:l.Z,children:"Minimera submeny"}),(0,b.jsx)(m.Z,{})]}):(0,b.jsxs)(P,{children:[!e&&(0,b.jsx)("span",{style:l.Z,children:"Maximera submeny"}),(0,b.jsx)(g.Z,{})]})}}),Object.defineProperty(this,I,{writable:!0,value:()=>{const{subMenuItems:e}=this.props;return e&&e.length>0}}),Object.defineProperty(this,k,{writable:!0,value:(e,t)=>{const{localObserver:n}=this.props;n.publish("print-".concat(e,"-clicked"),t)}}),Object.defineProperty(this,Z,{writable:!0,value:()=>{const{theme:e,level:t,color:n,colored:i}=this.props,r=(0,s.Z)(this,I)[I]();return i?{paddingLeft:e.spacing(1+3*t),borderLeft:"".concat(e.spacing(.5)," solid ").concat(n),paddingRight:r?0:e.spacing(1)}:{paddingLeft:e.spacing(1+3*t),paddingRight:r?0:e.spacing(1)}}})}render(){const{type:e,selected:t,subMenuItems:n,expanded:i,level:r,title:o,id:l,chosenForPrint:a}=this.props,c=(0,s.Z)(this,I)[I]();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(v,{divider:!0,selected:t,button:!0,ref:this.props.itemRef,size:"small",disableGutters:!0,"aria-controls":c?"submenu_".concat(l):null,"aria-expanded":i,onClick:()=>{(0,s.Z)(this,k)[k](e,l)},sx:(0,s.Z)(this,Z)[Z](),children:[(0,b.jsx)(x,{children:(0,b.jsx)(u.Z,{color:"primary",checked:a,onChange:e=>{this.props.handleTogglePrint(this.props.id)},onClick:e=>e.stopPropagation(),edge:"start",tabIndex:-1,disableRipple:!0})}),o&&(0,s.Z)(this,j)[j](),c&&(0,s.Z)(this,y)[y]()]}),c&&(0,b.jsx)(p.Z,{id:"submenu_".concat(l),in:i,timeout:200,children:(0,b.jsx)(f.default,{...this.props,level:r+1,documentMenu:n,handleTogglePrint:this.props.handleTogglePrint})})]})}}t.default=(0,a.b)(C)},1447:(e,t,n)=>{n.r(t);var s=n(66274),i=n(99359),r=n(72791),o=n(1250),l=n(54164),a=n(98246),c=n(66934),d=n(11640),h=n(57012),u=n(13967),p=n(61889),m=n(76278),g=n(39157),f=n(5289),b=n(57482),x=n(65661),P=n(51691),v=n(20890),j=n(85523),y=n(94454),I=n(95193),k=n(97123),Z=n(24518),C=n(90493),M=n(67394),S=n(88264),w=n(48456),A=n(38283),L=n(15717),F=n(18428),T=n(54711),D=n(21960),O=n(80184);const B=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{padding:t.spacing(3),height:"100%",overflowX:"auto"}})),E=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{marginTop:t.spacing(2),overflowX:"auto","&::-webkit-scrollbar":{width:"0.4em",opacity:"0"},"&:hover":{"&::-webkit-scrollbar":{opacity:"1"},"&::-webkit-scrollbar-track":{boxShadow:"inset 0 0 6px rgba(0,0,0,0.00)",webkitBoxShadow:"inset 0 0 6px rgba(0,0,0,0.00)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,.1)"}},flexBasis:"100%"}})),N=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(2)}})),R=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(2)}})),H=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{flexBasis:"10%"}})),W=(0,c.ZP)(p.ZP)((e=>{let{theme:t}=e;return{display:"flex",justifyContent:"flex-end"}})),z=(0,c.ZP)(m.Z)((e=>{let{theme:t,index:n}=e;return{display:"flex",justifyContent:"space-between",padding:"16px 10px 16px 10px",borderBottom:"1px solid lightgray",borderLeft:n%2===0?"4px solid lightGray":"4px solid darkGray"}})),U=(0,c.ZP)(g.Z)((e=>{let{theme:t}=e;return{overflowY:"clip",position:"relative","&:before":{display:"block",content:'""',width:"100%",paddingTop:"141.15%",paddingLeft:"80%"}}})),G=(0,c.ZP)("iframe")((e=>{let{theme:t}=e;return{position:"absolute",width:"calc(100% - 40px)",height:"100%",top:"0",left:"0",margin:"20px"}}));function _(e){let{callback:t,children:n}=e;return(0,r.useEffect)((()=>t())),(0,O.jsx)("div",{children:n})}var q=(0,i.Z)("handleSubMenuClicked"),Q=(0,i.Z)("setItemStateProperties"),V=(0,i.Z)("setClickedItemProperties"),J=(0,i.Z)("setNonClickedItemProperties");class X extends r.PureComponent{constructor(){var e,t,n;super(...arguments),this.state={printLinks:!0,printText:!0,printImages:!0,printMaps:!1,allDocumentsToggled:!1,tocPrintMode:null!==(e=null===(t=this.props.options)||void 0===t||null===(n=t.tableOfContents)||void 0===n?void 0:n.printMode)&&void 0!==e?e:"none",menuInformation:this.createMenu(),printContent:void 0,pdfLoading:!1,isAnyDocumentSelected:!1,showAttachments:!1,selectedPdfIndex:null,isModalOpen:!1,pdfLinks:this.checkPdfLinks(this.props.options.pdfLinks)},this.internalId=0,Object.defineProperty(this,q,{writable:!0,value:e=>{(0,s.Z)(this,Q)[Q](e)}}),Object.defineProperty(this,Q,{writable:!0,value:e=>new Promise((t=>{const n={...this.state.menuInformation},i=n[e],r=Object.values(n).reduce(((t,r)=>r.id===e?{...t,[r.id]:(0,s.Z)(this,V)[V](r)}:{...t,[r.id]:(0,s.Z)(this,J)[J](r,n,i)}),{});this.setState({menuInformation:r},t)}))}),Object.defineProperty(this,V,{writable:!0,value:e=>{let t={...e};return{...e,selected:!t.hasSubMenu,expandedSubMenu:t.hasSubMenu?!t.expandedSubMenu:t.expandedSubMenu}}}),Object.defineProperty(this,J,{writable:!0,value:(e,t,n)=>({...e,expandedSubMenu:-1!==n.allParents.indexOf(e.id)||e.expandedSubMenu,selected:!!n.hasSubMenu&&e.selected})}),this.componentDidMount=()=>{this.props.localObserver.subscribe("chapter-components-appended",(e=>{this.setState({printContent:e},(()=>{this.printContents()}))})),this.props.localObserver.subscribe("print-submenu-clicked",(e=>{(0,s.Z)(this,q)[q](e)}))},this.componentWillUnmount=()=>{this.props.localObserver.unsubscribe("chapter-components-appended")},this.resizeImage=e=>{e.height=.7*e.getBoundingClientRect().height,e.width=.7*e.clientWidth},this.imageFitsOnePage=e=>e.getBoundingClientRect().height<855,this.loadImage=e=>new Promise(((t,n)=>{e.onload=()=>{this.imageFitsOnePage(e)||this.resizeImage(e),t(e)},e.onerror=()=>n(e)})),this.customRender=(e,t)=>{const n=(0,A.deepMerge)(this.props.customTheme||this.props.theme,{});return new Promise((s=>{(0,o.s)(t).render((0,O.jsx)(d.Z,{children:(0,O.jsx)(h.Z,{theme:n,children:(0,O.jsx)(_,{callback:()=>{s()},children:e})})}))}))},this.createPrintElement=e=>{let t=document.createElement("div");return t.id=e,t},this.renderToc=()=>(this.toc=this.createPrintElement("toc"),this.customRender((0,O.jsx)(F.default,{documentMenuState:this.state.menuInformation,allDocuments:this.props.model.allDocuments,mode:this.state.tocPrintMode}),this.toc)),this.renderContent=()=>(this.content=this.createPrintElement("content"),this.customRender(this.state.printContent,this.content)),this.areAllImagesLoaded=()=>Promise.allSettled([...this.content.getElementsByTagName("img")].map((e=>this.loadImage(e)))),this.handleNewWindowBlocked=()=>(window.alert("Please allow opening of popup windows in order to print this document."),this.setState({pdfLoading:!1,printContent:void 0,printMaps:!1}),null),this.createPrintWindow=()=>{const e=window.open("","PRINT");return null===e?this.handleNewWindowBlocked():(e.document.head.insertAdjacentHTML("beforeend"," <title>".concat(document.title,'</title>\n        <base href="').concat(document.location.protocol,"//").concat(document.location.host,'/" />\n        ').concat(this.props.options.dynamicImportUrls.customFont?'<link\n            rel="stylesheet"\n            type="text/css"\n            href="'.concat(this.props.options.dynamicImportUrls.customFont,'"/>'):"","        \n        <style>\n          @page {\n            size: A4;\n            margin: 25mm 25mm 25mm 25mm;\n          }\n          @media print {\n            html,\n            body {\n              height: 297mm;\n              width: 210mm;\n            }\n            h1,\n            h2,\n            h3,\n            h4,\n            h5,\n            h6 {\n              page-break-after: avoid;\n            }\n            .MuiTypography-body1 {\n              page-break-before: avoid;\n            }\n            .MuiBox-root {\n              page-break-inside: avoid;\n            }\n            body .blockQuoteAccordion {\n              box-shadow: none;\n              border: 4px solid #edf2f7;\n            }\n            .blockQuoteAccordion .MuiCollapse-root {\n              height: auto;\n              visibility: visible;\n            }\n            .blockQuoteAccordion .MuiAccordionSummary-expandIconWrapper {\n              display: none;\n            }\n          }        \n        </style>")),e)},this.clearPrintContainers=()=>{this.toc=null,this.content=null},this.handlePrintCompleted=()=>{this.toggleAllDocuments(!1),this.setState({pdfLoading:!1,printContent:void 0,menuInformation:this.createMenu()})},this.addPageBreaksBeforeHeadings=e=>{const t=e.querySelectorAll(["h1","h2"]);let n=!1,s=!1;for(let i=0;i<t.length;i++)"H1"===t[i].nodeName&&n&&(s=!0),"H1"===t[i].nodeName&&(n=!0),"H1"!==t[i].nodeName||"none"===this.state.tocPrintMode||s||(t[i].style.pageBreakBefore="always",t[i].style.breakBefore="none"),0===i||"H2"!==t[i].nodeName||n||(t[i].style.pageBreakBefore="always",t[i].style.breakBefore="none"),"H1"!==t[i].nodeName&&(n=!1)},this.printContents=()=>{Promise.all(["none"!==this.state.tocPrintMode&&this.renderToc(),this.renderContent()]).then((()=>{this.areAllImagesLoaded().then((()=>{const e=document.createElement("div");this.toc&&e.appendChild(this.toc),e.appendChild(this.content),this.addPageBreaksBeforeHeadings(e);const t=this.createPrintWindow();for(const s of document.querySelectorAll("[data-emotion]")){const e=document.createElement("style");e.appendChild(document.createTextNode(""));const{textContent:i,sheet:r}=s;if(i)e.appendChild(document.createTextNode(i)),t.document.head.appendChild(e);else{t.document.head.appendChild(e);for(const t of r.cssRules)try{e.sheet.insertRule(t.cssText)}catch(n){console.warn("Could not insert rule: ".concat(null===t||void 0===t?void 0:t.cssText))}}}t.document.body.appendChild(e),t.print(),t.close(),this.handlePrintCompleted()}))}))},this.handleCheckboxChange=e=>{const{model:t}=this.props;let n=[...this.state.chapterInformation],s=t.getChapterById(n,e.id);s.chosenForPrint=!s.chosenForPrint,this.toggleSubChapters(s,s.chosenForPrint),this.setState({chapterInformation:n,allDocumentsToggled:!1})},this.toggleChosenForPrint=e=>{const t={...this.state.menuInformation},n=!t[e].chosenForPrint,s={...t[e],chosenForPrint:!t[e].chosenForPrint};t[e]=s;let i=this.toggleSubDocuments(e,n,t);t[e].parentId&&n&&(i=this.toggleParentChecked(e,i)),t[e].parentId&&!n&&(i=this.toggleParentUnchecked(e,i)),this.setState({menuInformation:i},(()=>{this.setIsAnyDocumentSelected()}))},this.toggleAllDocuments=e=>{const t={...this.state.menuInformation};Object.keys(t).forEach((n=>{const s={...t[n],chosenForPrint:e};t[n]=s})),this.setState({allDocumentsToggled:e,menuInformation:t,isAnyDocumentSelected:e})},this.removeTagsNotSelectedForPrint=e=>{const{printImages:t,printText:n,printLinks:s}=this.state;let i=[];const r=document.createElement("div");r.innerHTML=e.html,s||Array.from(r.getElementsByTagName("a")).forEach((e=>{i.push(e)})),t||Array.from(r.getElementsByTagName("figure")).forEach((e=>{i.push(e)})),n||(Array.from(r.querySelectorAll("p, h1, h2, h3, h4, h5, h6")).forEach((e=>{i.push(e)})),e.header="");let o=r.querySelectorAll("[data-document]");for(let l=0;l<o.length;l++)o[l].setAttribute("printMode","true"),o[l].href="#";for(let l=0;l<i.length;l++)i[l].parentNode.removeChild(i[l]);return e.html=r.innerHTML,e},this.prepareChapterForPrint=e=>(e.chapters&&e.chapters.length>0&&e.chapters.forEach((e=>{if(e.chapters&&e.chapters.length>0)return this.prepareChapterForPrint(e);e=this.removeTagsNotSelectedForPrint(e)})),e=this.removeTagsNotSelectedForPrint(e)),this.setIsAnyDocumentSelected=()=>{const e=Object.keys(this.state.menuInformation);let t=!1;for(let n=0;n<e.length;n++)this.state.menuInformation[e[n]].chosenForPrint&&(t=!0);this.setState({isAnyDocumentSelected:t})},this.createHeaderItems=e=>({isGroupHeader:!0,title:e.title,id:e.id}),this.getDocumentsToPrint=()=>{const{menuInformation:e}=this.state,t=Object.keys(e).filter((t=>e[t].chosenForPrint)),n=t.map((t=>e[t].document));const s=this.props.model.getDocuments(n).map((t=>{if(t){let n=Object.keys(e).find((n=>e[n].document===t.documentFileName));return{documentFileName:t.documentFileName,tableOfContents:t.tableOfContents,chapters:e[n].chapters}}})).map(((n,s)=>void 0===n?this.createHeaderItems(e[t[s]]):n));let i=[];return s.forEach((e=>{var t;if(null!==e&&void 0!==e&&null!==(t=e.chapters)&&void 0!==t&&t.length){let t=[];null===e||void 0===e||e.chapters.forEach((e=>{t.push(this.prepareChapterForPrint(e))})),e.chapters=t}i.push(e)})),i},this.createPDF=()=>{this.setState({pdfLoading:!0});const e=this.getDocumentsToPrint();this.props.localObserver.publish("append-document-components",e)},this.renderLoadingDialog=()=>(0,O.jsx)(O.Fragment,{children:(0,l.createPortal)((0,O.jsxs)(f.Z,{disableEscapeKeyDown:!0,open:this.state.pdfLoading,children:[(0,O.jsx)(b.Z,{}),(0,O.jsx)(x.Z,{children:"Din PDF skapas"}),(0,O.jsx)(g.Z,{children:(0,O.jsxs)(P.Z,{children:["Det h\xe4r kan ta en stund, speciellt om du har valt att skriva ut m\xe5nga dokument.",(0,O.jsx)("br",{}),(0,O.jsx)("br",{})]})})]}),document.getElementById("root"))}),this.toggleDocumentsAttachments=()=>{this.setState((e=>({showAttachments:!e.showAttachments})))},this.renderPrintDocuments=()=>{const{localObserver:e,documentWindowMaximized:t}=this.props,{menuInformation:n}=this.state;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.Z,{align:"center",variant:"h6",children:"Skapa PDF"}),(0,O.jsxs)(R,{container:!0,item:!0,children:[(0,O.jsx)(v.Z,{variant:"h6",children:"Inst\xe4llningar"}),(0,O.jsx)(p.ZP,{xs:12,item:!0,children:(0,O.jsx)(j.Z,{value:"V\xe4lj alla dokument",control:(0,O.jsx)(y.Z,{color:"primary",checked:this.state.allDocumentsToggled,onChange:()=>this.toggleAllDocuments(!this.state.allDocumentsToggled)}),label:"V\xe4lj alla dokument",labelPlacement:"end"})})]}),(0,O.jsx)(v.Z,{variant:"h6",children:"Valt inneh\xe5ll"}),(0,O.jsx)(E,{item:!0,container:!0,children:(0,O.jsx)(L.default,{localObserver:e,documentMenu:n,level:0,handleTogglePrint:this.toggleChosenForPrint})}),t&&this.renderCreatePDFButton(),this.renderLoadingDialog()]})},this.openAttachmentModal=e=>{this.setState({selectedPdfIndex:e,isModalOpen:!0})},this.closeAttachmentModal=()=>{this.setState({selectedPdfIndex:null,isModalOpen:!1})},this.renderDialog=()=>{const{isModalOpen:e,pdfLinks:t,selectedPdfIndex:n}=this.state,s=this.closeAttachmentModal;function i(){var i,r;const o=(0,u.Z)(),l=(0,I.Z)(o.breakpoints.down("sm"));return(0,O.jsxs)(f.Z,{fullScreen:l,open:e,PaperProps:{style:{width:!l&&"30%"}},BackdropProps:{style:{backgroundColor:"rgba(0, 0, 0, 0.25)"}},onClose:()=>s(),children:[(0,O.jsx)(U,{children:(0,O.jsx)(G,{title:null===(i=t[n])||void 0===i?void 0:i.name,src:null===(r=t[n])||void 0===r?void 0:r.link})}),(0,O.jsx)(k.Z,{children:(0,O.jsx)(Z.Z,{variant:"contained",onClick:()=>s(),children:(0,O.jsx)(v.Z,{variant:"body2",children:"Sluiten"})})})]})}return(0,O.jsx)(O.Fragment,{children:(0,l.createPortal)((0,O.jsx)(i,{}),document.getElementById("root"))})},this.renderPrintAttachments=()=>{const{pdfLinks:e,isModalOpen:t}=this.state;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(v.Z,{align:"center",variant:"h6",children:"Bilagor"}),(0,O.jsx)(v.Z,{variant:"h6",children:"Inneh\xe5ll"}),(0,O.jsx)(E,{children:(0,O.jsx)(C.Z,{children:e.map(((e,t)=>{const n=""!==e.name,s=""!==e.link,i=!s,r=n?e.name:"Namn saknas",o=s?"\xd6ppna":"L\xe4nk saknas",l=s?"primary":"text.secondary",a=s?(0,O.jsx)(w.Z,{sx:{width:"15px"}}):null;return(0,O.jsx)("div",{children:(0,O.jsxs)(z,{disabled:i,index:t,onClick:()=>this.openAttachmentModal(t),children:[(0,O.jsx)(v.Z,{sx:{fontStyle:n?"inherit":"italic",color:n?"inherit":"gray"},children:r}),s&&(0,O.jsx)(Z.Z,{href:e.link,target:"_blank",sx:{height:"28px",padding:"10px",minWidth:"auto"},color:l,variant:"contained",startIcon:a,onClick:e=>e.stopPropagation(),children:(0,O.jsx)(v.Z,{variant:"body2",justify:"center",children:o})}),!s&&(0,O.jsx)(v.Z,{sx:{fontStyle:"italic"},children:"L\xe4nk saknas"})]})},t)}))})}),t&&this.renderDialog()]})}}setInitialMenuItemProperties(e){(0,D.hasSubMenu)(e)&&(e.hasSubMenu=!0,e.menu.forEach((t=>{this.setInitialMenuItemProperties(t,e)})))}removeNonPrintableDocuments(e){let t=[];Object.keys(e).forEach((n=>{(e[n].maplink.trim()||e[n].link.trim())&&(t.push(parseInt(n)),delete e[n])})),Object.keys(e).forEach((n=>{let s=e[n],i=s.allChildren.filter((e=>!t.includes(e)));s.allChildren=i;let r=s.menuItemIds.filter((e=>!t.includes(e)));s.menuItemIds=r}))}createMenu(){const{options:e}=this.props,t=this.props.model.allDocuments,n={...{...e}}.menuConfig,s=JSON.parse(JSON.stringify(n)),i=(0,T.getNormalizedMenuState)(s.menu);let r=this.props.model.getAllChapterInfo();const o=Object.keys(i),l=o.length+1;o.forEach((e=>{let n=i[e];const s=n.allChildren.map((e=>e+l)),o=n.allParents.map((e=>e+l)),a=n.menuItemIds.map((e=>e+l));if(n.id+=l,n.parentId=n.parentId?n.parentId+=l:null,n.allChildren=s,n.allParents=o,n.menuItemIds=a,n.chosenForPrint=!1,n.colored=!0,n.document){var c;let e=t.find((e=>e.documentFileName===n.document));n.tocChapterLevels=(null===e||void 0===e||null===(c=e.tableOfContents)||void 0===c?void 0:c.chapterLevelsToShow)||100}if(n.document){n.chapters=[],r.filter((e=>e.documentFileName===n.document)).forEach((e=>n.chapters.push(e)))}}));let a={};return o.forEach((e=>{let t=parseInt(e)+l;a[t]=i[e]})),this.removeNonPrintableDocuments(a),a}toggleSubDocuments(e,t,n){return n[e].allChildren.forEach((e=>{const s={...n[e],chosenForPrint:t};n[e]=s,this.toggleSubDocuments(e,t,n)})),n}toggleParentChecked(e,t){const n=t[e].parentId,s={...t[n],chosenForPrint:!0};return t[n]=s,t[n].parentId&&(t=this.toggleParentChecked(n,t)),t}toggleParentUnchecked(e,t){const n=t[e].parentId;if(t[n].allChildren.filter((n=>!(n.id===e||!t[n].chosenForPrint))).length>0)return t;const s={...t[n],chosenForPrint:!1};return t[n]=s,t[n].parentId&&(t=this.toggleParentUnchecked(n,t)),t}renderCreatePDFButton(){return(0,O.jsx)(H,{item:!0,container:!0,alignContent:"center",alignItems:"center",justifyContent:"center",children:(0,O.jsx)(Z.Z,{color:"primary",variant:"contained",disabled:this.state.pdfLoading||!this.state.isAnyDocumentSelected,startIcon:(0,O.jsx)(w.Z,{}),onClick:this.createPDF,children:(0,O.jsx)(v.Z,{style:{marginRight:"20px",marginLeft:"20px"},justify:"center",children:"Afdrukken"})})})}checkPdfLinks(e){return null===e||void 0===e?void 0:e.filter((e=>e.name||e.link))}render(){const{togglePrintWindow:e}=this.props,{showAttachments:t,pdfLinks:n}=this.state;return(0,O.jsx)(O.Fragment,{children:t?(0,O.jsxs)(B,{container:!0,wrap:"nowrap",direction:"column",children:[(0,O.jsx)(N,{alignItems:"center",justifyContent:"space-between",item:!0,container:!0,children:(0,O.jsx)(p.ZP,{item:!0,xs:4,children:(0,O.jsx)(Z.Z,{color:"primary",style:{paddingLeft:0},startIcon:(0,O.jsx)(M.Z,{}),onClick:()=>this.toggleDocumentsAttachments(),children:(0,O.jsx)(v.Z,{justify:"center",children:"Skapa Pdf"})})})}),this.renderPrintAttachments()]}):(0,O.jsxs)(B,{container:!0,wrap:"nowrap",direction:"column",children:[(0,O.jsxs)(N,{alignItems:"center",justifyContent:"space-between",item:!0,container:!0,children:[(0,O.jsx)(p.ZP,{item:!0,xs:4,children:(0,O.jsx)(Z.Z,{color:"primary",style:{paddingLeft:0},startIcon:(0,O.jsx)(M.Z,{}),onClick:e,children:(0,O.jsx)(v.Z,{justify:"center",children:"Tillbaka"})})}),(0,O.jsx)(W,{item:!0,xs:4,children:(null===n||void 0===n?void 0:n.length)>0&&(0,O.jsx)(Z.Z,{color:"primary",style:{paddingLeft:0},endIcon:(0,O.jsx)(S.Z,{}),onClick:()=>this.toggleDocumentsAttachments(),children:(0,O.jsx)(v.Z,{justify:"center",children:"Bilagor"})})})]}),this.renderPrintDocuments()]})})}}t.default=(0,a.RM)(X)},18428:(e,t,n)=>{n.r(t);var s=n(72791),i=n(9933),r=n(45484),o=n(49900),l=n(90493),a=n(20890),c=n(61889),d=n(80184);class h extends s.PureComponent{constructor(e){super(e),this.state={titlesAndLevels:[]},this.componentDidMount=()=>{const{documentMenuState:e,allDocuments:t,mode:n}=this.props,s=this.createTocStructure(e,t,n);Object.keys(s).forEach((e=>{this.setTitlesAndLevels(s[e],n)})),this.setState({titlesAndLevels:this.titlesAndLevels})},this.setTitlesAndLevels=(e,t)=>{if("partial"===t&&!0!==e.chosenForPrint)return;let n=(null===e||void 0===e?void 0:e.tocChapterLevels)||100,s=0,i=0;e.allParents.length&&(i++,n++,s+=e.allParents.length),e.document||this.titlesAndLevels.push({title:e.title,level:s,chosenForPrint:e.chosenForPrint}),e.chapters&&(i++,i<=n&&e.chapters.forEach((e=>{this.titlesAndLevels.push({title:e.header,level:s}),this.setChapterTitlesAndLevels(e,n,i+1,s+1)})))},this.setChapterTitlesAndLevels=(e,t,n,s)=>{e.chapters&&n<=t&&e.chapters.forEach((e=>{this.titlesAndLevels.push({title:e.header,level:s}),this.setChapterTitlesAndLevels(e,t,n+1,s+1)}))},this.titlesAndLevels=[],this.previousGroupHeader=!1}createTocStructure(e,t){let n={...e};return Object.keys(n).forEach((e=>{let s=n[e];if(s.document){let i=t.find((e=>e.documentFileName===s.document));n[e].chapters=i.chapters}})),n}render(){const{titlesAndLevels:e}=this.state;return(0,d.jsxs)(c.ZP,{container:!0,sx:{pageBreakAfter:"always"},children:[(0,d.jsx)(a.Z,{variant:"h4",gutterBottom:!0,children:"Inneh\xe5llsf\xf6rteckning"}),(0,d.jsx)(l.Z,{style:{width:"100%"},disablePadding:!0,children:e.map(((e,t)=>(e.chosenForPrint,(0,d.jsx)(r.ZP,{dense:!0,sx:{paddingLeft:1+3*e.level},children:(0,d.jsx)(o.Z,{children:e.title})},t))))})]})}}t.default=(0,i.b)(h)},21960:(e,t,n)=>{n.r(t),n.d(t,{flattenChaptersTree:()=>o,getStringArray:()=>i,hasSubMenu:()=>r,splitAndTrimOnCommas:()=>s});const s=e=>e.split(",").map((e=>e.trim())),i=e=>s(e).join(" ").split(" "),r=e=>e.menu&&e.menu.length>0,o=e=>e.reduce(((e,t)=>{if(t.header){let n={...t};n.chapters=[],e=[...e,n]}return t.chapters&&t.chapters.length>0?[...e,...o(t.chapters)]:e}),[])},54711:(e,t,n)=>{n.r(t),n.d(t,{getNormalizedMenuState:()=>o});var s=n(72791),i=n(21960);const r=e=>e.reduce(((e,t)=>((0,i.hasSubMenu)(t)&&(e=[...e,...r(t.menu)]),[...e,t.id])),[]),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=e.reduce(((e,l)=>((l={...l,parentId:t,level:n,menuItemIds:[],allChildren:[],allParents:i,itemRef:s.createRef()}).menu&&l.menu.length>0&&(l.allChildren=[...l.allChildren,...r(l.menu)],l.menuItemIds=[...l.menuItemIds,...l.menu.map((e=>e.id))],e={...e,...o(l.menu,l.id,n+1,[...i,l.id])}),{...e,[l.id]:l})),{});return Object.values(l).forEach((e=>{delete e.menu})),l}}}]);
//# sourceMappingURL=1447.c106e171.chunk.js.map