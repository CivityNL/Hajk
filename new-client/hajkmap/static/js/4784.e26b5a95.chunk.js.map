{"version":3,"file":"static/js/4784.e26b5a95.chunk.js","mappings":"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","sources":["plugins/DocumentHandler/documentWindow/Contents.js","plugins/DocumentHandler/documentWindow/ImagePopupModal.js","plugins/DocumentHandler/utils/helpers.js"],"sourcesContent":["import React from \"react\";\nimport Typography from \"@mui/material/Typography\";\nimport ImagePopupModal from \"./ImagePopupModal\";\nimport { flattenChaptersTree } from \"../utils/helpers\";\nimport { Box } from \"@mui/material\";\n\nclass Contents extends React.PureComponent {\n  state = {\n    popupImage: null,\n    activeContent: null,\n  };\n\n  constructor(props) {\n    super(props);\n    this.internalIds = [];\n  }\n\n  /* TODO...\n   * This should be refactored in some other way.\n   * right now we are \"creating\" components for printing here\n   * because we need to use the render in this component\n   */\n  bindPrintSpecificHandlers = () => {\n    const { localObserver, model } = this.props;\n    localObserver.unsubscribe(\"append-chapter-components\");\n\n    localObserver.subscribe(\"append-document-components\", (documents) => {\n      let chapters = [];\n      let headerChapter = [];\n\n      documents.forEach((document) => {\n        /*\n         * add an H1 tag for menu parents when printing.\n         * chapters if a group of documents has a parent document, the header of the parent\n         * is printed if any of the children are printed.\n         */\n        if (document.isGroupHeader) {\n          headerChapter.push(\n            this.createGroupHeadingTag(document.title, document.id)\n          );\n          chapters.push(headerChapter);\n          headerChapter = [];\n        } else {\n          document.chapters.forEach((chapter) => {\n            model.appendComponentsToChapter(chapter);\n          });\n\n          let renderedChapters = [];\n          let flatChaptersTree = flattenChaptersTree(document.chapters);\n          flatChaptersTree = flatChaptersTree.map((item) => {\n            if (item.mustReplace) {\n              let newItem = {};\n              item = newItem;\n            }\n            return item;\n          });\n\n          renderedChapters.push(this.renderChapters(flatChaptersTree, true));\n          chapters.push(renderedChapters);\n        }\n      });\n\n      localObserver.publish(\"chapter-components-appended\", chapters);\n    });\n  };\n\n  componentDidMount = () => {\n    const { localObserver } = this.props;\n    this.bindPrintSpecificHandlers();\n    localObserver.subscribe(\"image-popup\", this.showPopupModal);\n  };\n\n  componentWillUnmount = () => {\n    const { localObserver } = this.props;\n    localObserver.unsubscribe(\"chapter-components-appended\");\n  };\n\n  closePopupModal = () => {\n    this.setState({ popupImage: null });\n  };\n\n  showPopupModal = (image) => {\n    this.setState({ popupImage: image });\n  };\n\n  renderImageInModal = () => {\n    const { popupImage } = this.state;\n\n    return (\n      <ImagePopupModal\n        open={popupImage == null ? false : true}\n        close={this.closePopupModal}\n        image={popupImage}\n      ></ImagePopupModal>\n    );\n  };\n\n  createGroupHeadingTag = (title, id) => {\n    return (\n      <Typography key={id} data-type=\"chapter-header\" variant=\"h1\">\n        {title}\n      </Typography>\n    );\n  };\n\n  /**\n   * Renders the document with all it's chapters and sub chapters.\n   * @param {object} document The document that will be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapters = (chapters, isPrintMode) => {\n    return Array.isArray(chapters)\n      ? chapters.map((chapter) => this.renderChapter(chapter, isPrintMode))\n      : null;\n  };\n\n  /**\n   * Renders a chapter with a headline an a content.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapter = (chapter, isPrintMode) => {\n    return (\n      <React.Fragment key={chapter.id}>\n        {this.renderHeadline(chapter, isPrintMode)}\n        {chapter.components}\n        {Array.isArray(chapter.chapters)\n          ? chapter.chapters.map((subChapter) => this.renderChapter(subChapter))\n          : null}\n      </React.Fragment>\n    );\n  };\n\n  getHeaderVariant = (chapter, isPrintMode) => {\n    let headerSize = 2; //Chapters start with h2\n\n    //If we are printing, we have a flattened chapters tree, so use the chapter.level property to set the heading\n    //instead of cycling through the parent chapter objects.\n    if (isPrintMode) {\n      headerSize += chapter.level;\n      return `h${headerSize}`;\n    }\n    while (chapter.parent) {\n      headerSize++;\n      chapter = chapter.parent;\n    }\n    return `h${headerSize}`;\n  };\n\n  /**\n   * Render the headline of a chapter.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderHeadline = (chapter, isPrintMode) => {\n    return (\n      <>\n        <Typography\n          ref={chapter.scrollRef}\n          sx={{ overflowWrap: \"break-word\" }}\n          data-type=\"chapter-header\"\n          variant={this.getHeaderVariant(chapter, isPrintMode)}\n        >\n          {chapter.header}\n        </Typography>\n      </>\n    );\n  };\n\n  render = () => {\n    if (this.props.activeDocument) {\n      return (\n        <Box style={{ display: \"block\", maxWidth: \"100%\" }}>\n          {this.renderImageInModal()}\n          {this.renderChapters(this.props.activeDocument.chapters)}\n        </Box>\n      );\n    } else {\n      return null;\n    }\n  };\n}\n\nexport default Contents;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport IconButton from \"@mui/material/IconButton\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport Dialog from \"@mui/material/Dialog\";\nimport Paper from \"@mui/material/Paper\";\n\nconst mapDiv = document.getElementById(\"map\");\nconst blurCss = \"filter : blur(7px)\";\n\nconst CloseButton = styled(IconButton)(({ theme }) => ({\n  position: \"absolute\",\n  backgroundColor: theme.palette.grey[50],\n\n  \"&:hover\": {\n    backgroundColor: theme.palette.grey[400],\n  },\n\n  zIndex: 100,\n  right: theme.spacing(2),\n  top: theme.spacing(2),\n}));\n\nconst StyledPaper = styled(Paper)(() => ({\n  maxHeight: \"80%\",\n  maxWidth: \"90%\",\n  overflow: \"auto\",\n  backgroundColor: \"transparent\",\n  boxShadow: \"none\",\n  objectFit: \"contain\",\n}));\n\nfunction PaperComponent(props) {\n  const { component, onClose, src, altValue } = props;\n  return (\n    <>\n      <CloseButton size=\"small\" onClick={onClose}>\n        <CloseIcon />\n      </CloseButton>\n      <StyledPaper alt={altValue} component={component} src={src} />\n    </>\n  );\n}\n\nclass ImagePopupModal extends React.PureComponent {\n  removeMapBlur = () => {\n    mapDiv.removeAttribute(\"style\", blurCss);\n  };\n\n  addMapBlur = () => {\n    mapDiv.setAttribute(\"style\", blurCss);\n  };\n\n  componentWillUnmount = () => {\n    this.removeMapBlur();\n  };\n\n  componentDidMount = () => {};\n\n  render() {\n    const { open, close, image } = this.props;\n    open ? this.addMapBlur() : this.removeMapBlur();\n\n    return (\n      <Dialog\n        maxWidth=\"lg\"\n        onBackdropClick={close}\n        PaperComponent={PaperComponent}\n        PaperProps={{\n          component: \"img\",\n          onClose: close,\n          src: image?.url,\n          altValue: image?.altValue,\n        }}\n        open={open}\n      />\n    );\n  }\n}\n\nexport default ImagePopupModal;\n","export const splitAndTrimOnCommas = (searchString) => {\n  return searchString.split(\",\").map((string) => {\n    return string.trim();\n  });\n};\n\nexport const getStringArray = (searchString) => {\n  let tempStringArray = splitAndTrimOnCommas(searchString);\n  return tempStringArray.join(\" \").split(\" \");\n};\n\nexport const hasSubMenu = (item) => {\n  return item.menu && item.menu.length > 0;\n};\n\nexport const flattenChaptersTree = (chapters) => {\n  return chapters.reduce((acc, chapter) => {\n    if (chapter.header) {\n      let chapterStrippedFromSubChapters = { ...chapter };\n      chapterStrippedFromSubChapters.chapters = [];\n      acc = [...acc, chapterStrippedFromSubChapters];\n    }\n    if (chapter.chapters && chapter.chapters.length > 0) {\n      return [...acc, ...flattenChaptersTree(chapter.chapters)];\n    }\n    return acc;\n  }, []);\n};\n"],"names":["Contents","React","constructor","props","super","state","popupImage","activeContent","bindPrintSpecificHandlers","localObserver","model","this","unsubscribe","subscribe","documents","chapters","headerChapter","forEach","document","isGroupHeader","push","createGroupHeadingTag","title","id","chapter","appendComponentsToChapter","renderedChapters","flatChaptersTree","flattenChaptersTree","map","item","mustReplace","renderChapters","publish","componentDidMount","showPopupModal","componentWillUnmount","closePopupModal","setState","image","renderImageInModal","open","close","variant","isPrintMode","Array","isArray","renderChapter","renderHeadline","components","subChapter","getHeaderVariant","headerSize","level","parent","ref","scrollRef","sx","overflowWrap","header","render","activeDocument","style","display","maxWidth","internalIds","mapDiv","getElementById","blurCss","CloseButton","styled","IconButton","theme","position","backgroundColor","palette","grey","zIndex","right","spacing","top","StyledPaper","Paper","maxHeight","overflow","boxShadow","objectFit","PaperComponent","component","onClose","src","altValue","size","onClick","alt","ImagePopupModal","removeMapBlur","removeAttribute","addMapBlur","setAttribute","onBackdropClick","PaperProps","url","splitAndTrimOnCommas","searchString","split","string","trim","getStringArray","join","hasSubMenu","menu","length","reduce","acc","chapterStrippedFromSubChapters"],"sourceRoot":""}