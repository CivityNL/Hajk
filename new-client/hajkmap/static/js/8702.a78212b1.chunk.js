"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[8702],{38702:(e,t,i)=>{i.r(t);var r=i(66274),a=i(99359),s=i(64665),l=i(90927),o=i(66233),c=i(5400),h=i(5426),n=i(9501),u=i(60313),f=i(78550),g=i(25806),d=(0,a.Z)("HT");t.default=class{constructor(e){Object.defineProperty(this,d,{writable:!0,value:void 0}),this.activateSelecting=e=>{!0===e?(this.map.on("click",this.handleClick),this.map.clickLock.add("buffer")):(this.map.un("click",this.handleClick),this.map.clickLock.delete("buffer"))},this.handleClick=e=>{this.map.getFeaturesAtPixel(e.pixel,{layerFilter:function(e){const t=e.get("name");return"pluginBuffer"!==t&&"pluginBufferSelection"!==t}}).forEach((e=>{const t=e.clone();t.setStyle(),this.highlightSource.addFeature(t)})),this.map.getLayers().getArray().filter((e=>e.getVisible())).filter((e=>e.layersInfo)).map((async t=>{try{const i=Object.values(t.layersInfo).filter((e=>!0===e.queryable)).map((e=>e.id));if(void 0!==e.coordinate){const r=this.map.getView(),a=t.getSource().getFeatureInfoUrl(e.coordinate,r.getResolution(),r.getProjection().getCode(),{INFO_FORMAT:"application/json",QUERY_LAYERS:i.join(",")}),s=await(0,g.hfetch)(a),l=await s.json(),o=(new u.Z).readFeatures(l);this.highlightSource.addFeatures(o)}}catch(i){}}))},this.bufferFeatures=e=>{const t=[];for(const i of this.highlightSource.getFeatures()){const a=(0,r.Z)(this,d)[d].getBuffered(i,e);t.push(a)}this.bufferSource.addFeatures(t)},this.clear=()=>{this.highlightSource.clear(),this.bufferSource.clear()},this.map=e.map,(0,r.Z)(this,d)[d]=new f.default({projection:e.map.getView().getProjection().getCode()}),this.highlightSource=new h.Z,this.highlightLayer=new n.Z({source:this.highlightSource,layerType:"system",zIndex:5e3,name:"pluginBufferSelection",caption:"Buffer selection layer",style:new s.ZP({fill:new l.Z({color:"rgba(255, 168, 231, 0.47)"}),stroke:new o.Z({color:"rgba(255, 168, 231, 1)",width:4}),image:new c.Z({radius:6,fill:new l.Z({color:"rgba(255, 168, 231, 0.47)"}),stroke:new o.Z({color:"rgba(255, 168, 231, 1)",width:1})})})}),this.bufferSource=new h.Z,this.bufferLayer=new n.Z({source:this.bufferSource,layerType:"system",zIndex:5e3,name:"pluginBuffer",caption:"Buffer layer",style:new s.ZP({fill:new l.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new o.Z({color:"rgba(75, 100, 115, 1.5)",width:4}),image:new c.Z({radius:6,fill:new l.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new o.Z({color:"rgba(75, 100, 115, 1.5)",width:2})})})}),this.map.addLayer(this.highlightLayer),this.map.addLayer(this.bufferLayer)}setActive(e){!1===e&&this.activateSelecting(!1)}}}}]);
//# sourceMappingURL=8702.a78212b1.chunk.js.map