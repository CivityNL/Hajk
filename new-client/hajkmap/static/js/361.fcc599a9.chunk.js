"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[361,2389,6127,6071,7690],{28619:(t,e,o)=>{o.r(e);var i=o(72791),n=o(66934),s=o(57621),r=o(93044),l=o(66647),a=o(9585),c=o(80184);const p=(0,n.ZP)(s.Z)((t=>{let{theme:e}=t;return{marginBottom:e.spacing(1),width:"210px",[e.breakpoints.down("sm")]:{boxShadow:"none",borderBottom:"1px solid #ccc",borderRadius:0,margin:0,width:"100%",justifyContent:"left"}}})),d=(0,n.ZP)(r.Z)((t=>{let{theme:e}=t;return{background:e.palette.text.primary}}));class h extends i.PureComponent{constructor(){super(...arguments),this.state={open:!1,text:""}}render(){const{abstract:t,icon:e,onClick:o,title:i}=this.props;return(0,c.jsx)(p,{onClick:o,children:(0,c.jsx)(l.Z,{children:(0,c.jsx)(a.Z,{avatar:(0,c.jsx)(d,{children:e}),title:i,subheader:t})})})}}h.defaultProps={abstract:"Beskrivning saknas",title:"Titel saknas"},e.default=h},73151:(t,e,o)=>{o.r(e);var i=o(72791),n=o(85286),s=o(54164),r=o(19538),l=o(45484),a=o(57064),c=o(49900),p=o(26191),d=o(28619),h=o(74599),u=o(80184);class m extends i.PureComponent{constructor(t){var e;super(t),e=this,this.handleButtonClick=t=>{this.showWindow({hideOtherPluginWindows:!0,runCallback:!0}),this.props.app.globalObserver.publish("core.onlyHideDrawerIfNeeded")},this.showWindow=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=t.hideOtherPluginWindows||!0,i=t.runCallback||!0;if(e.props.app.activeTool=e.type,e.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:e.type,activeMap:e.props.app.config.activeMap}),e.props.app.pushPluginIntoHistory({type:e.type,icon:e.props.custom.icon,title:e.title,description:e.description}),!0===e.state.windowVisible)return null;!0===o&&e.props.app.onWindowOpen(e),e.setState({windowVisible:!0},(()=>{e.props.app.globalObserver.publish("core.pluginVisibilityChanged"),!0===i&&"function"===typeof e.props.custom.onWindowShow&&e.props.custom.onWindowShow()}))},this.closeWindow=()=>{this.type===this.props.app.activeTool&&(this.props.app.activeTool=void 0),this.setState({windowVisible:!1},(()=>{this.props.app.globalObserver.publish("core.pluginVisibilityChanged"),"function"===typeof this.props.custom.onWindowHide&&this.props.custom.onWindowHide()}))},this.type=t.type.toLowerCase()||void 0,this.description=t.options.description||t.custom.description;const o=!1===this.props.app.config.mapConfig.map.clean&&(n.isMobile?t.options.visibleAtStartMobile:t.options.visibleAtStart)||!1;o&&this.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:this.type,activeMap:this.props.app.config.activeMap}),this.state={title:t.options.title||t.custom.title||"Unnamed plugin",color:t.options.color||t.custom.color||null,windowVisible:o},this.title=t.options.title||t.custom.title||"Unnamed plugin",this.width=t.options.width||t.custom.width||400,this.height=t.options.height||t.custom.height||"auto",this.position=t.options.position||t.custom.position||"left",t.app.registerWindowPlugin(this);const i="".concat(this.type,".showWindow");t.app.globalObserver.subscribe(i,(t=>{this.showWindow(t)}));const s="".concat(this.type,".closeWindow");t.app.globalObserver.subscribe(s,(()=>{this.closeWindow()}))}componentDidUpdate(t){t.custom.title!==this.props.custom.title&&this.setState({title:this.props.custom.title}),t.custom.color!==this.props.custom.color&&this.setState({color:this.props.custom.color})}pluginIsWidget(t){return["left","right"].includes(t)}renderWindow(t){const{target:e}=this.props.options;return"function"===typeof(null===t||void 0===t?void 0:t.render)?t.render():(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(p.default,{globalObserver:this.props.app.globalObserver,title:this.state.title,color:this.state.color,onClose:this.closeWindow,open:this.state.windowVisible,onResize:this.props.custom.onResize,onMaximize:this.props.custom.onMaximize,onMinimize:this.props.custom.onMinimize,draggingEnabled:this.props.custom.draggingEnabled,customPanelHeaderButtons:this.props.custom.customPanelHeaderButtons,resizingEnabled:this.props.custom.resizingEnabled,scrollable:this.props.custom.scrollable,allowMaximizedWindow:this.props.custom.allowMaximizedWindow,disablePadding:this.props.custom.disablePadding,width:this.width,height:this.height,position:this.position,mode:"window",layerswitcherConfig:this.props.app.config.mapConfig.tools.find((t=>"layerswitcher"===t.type)),children:i.cloneElement(this.props.children,{windowVisible:this.state.windowVisible})}),"hidden"!==e&&this.renderDrawerButton(),this.pluginIsWidget(e)&&this.renderWidgetButton("".concat(e,"-column")),"control"===e&&this.renderControlButton()]})}renderDrawerButton(){return(0,s.createPortal)((0,u.jsx)(r.Z,{mdUp:this.pluginIsWidget(this.props.options.target)||"control"===this.props.options.target,children:(0,u.jsxs)(l.ZP,{button:!0,divider:!0,selected:this.state.windowVisible,onClick:this.handleButtonClick,children:[(0,u.jsx)(a.Z,{children:this.props.custom.icon}),(0,u.jsx)(c.Z,{primary:this.title})]})}),document.getElementById("plugin-buttons"))}renderWidgetButton(t){return(0,s.createPortal)((0,u.jsx)(r.Z,{mdDown:!0,children:(0,u.jsx)(d.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById(t))}renderControlButton(){return(0,s.createPortal)((0,u.jsx)(r.Z,{mdDown:!0,children:(0,u.jsx)(h.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById("plugin-control-buttons"))}render(){return!0!==this.props.app.config.mapConfig.map.clean&&this.renderWindow(this.props.custom)}}e.default=m},24784:(t,e,o)=>{o.r(e);var i=o(72791),n=o(20890),s=o(82389),r=o(21960),l=o(68870),a=o(80184);class c extends i.PureComponent{constructor(t){super(t),this.state={popupImage:null,activeContent:null},this.bindPrintSpecificHandlers=()=>{const{localObserver:t,model:e}=this.props;t.unsubscribe("append-chapter-components"),t.subscribe("append-document-components",(o=>{let i=[],n=[];o.forEach((t=>{if(t.isGroupHeader)n.push(this.createGroupHeadingTag(t.title,t.id)),i.push(n),n=[];else{t.chapters.forEach((t=>{e.appendComponentsToChapter(t)}));let o=[],n=(0,r.flattenChaptersTree)(t.chapters);n=n.map((t=>{if(t.mustReplace){t={}}return t})),o.push(this.renderChapters(n,!0)),i.push(o)}})),t.publish("chapter-components-appended",i)}))},this.componentDidMount=()=>{const{localObserver:t}=this.props;this.bindPrintSpecificHandlers(),t.subscribe("image-popup",this.showPopupModal)},this.componentWillUnmount=()=>{const{localObserver:t}=this.props;t.unsubscribe("chapter-components-appended")},this.closePopupModal=()=>{this.setState({popupImage:null})},this.showPopupModal=t=>{this.setState({popupImage:t})},this.renderImageInModal=()=>{const{popupImage:t}=this.state;return(0,a.jsx)(s.default,{open:null!=t,close:this.closePopupModal,image:t})},this.createGroupHeadingTag=(t,e)=>(0,a.jsx)(n.Z,{"data-type":"chapter-header",variant:"h1",children:t},e),this.renderChapters=(t,e)=>Array.isArray(t)?t.map((t=>this.renderChapter(t,e))):null,this.renderChapter=(t,e)=>(0,a.jsxs)(i.Fragment,{children:[this.renderHeadline(t,e),t.components,Array.isArray(t.chapters)?t.chapters.map((t=>this.renderChapter(t))):null]},t.id),this.getHeaderVariant=(t,e)=>{let o=2;if(e)return o+=t.level,"h".concat(o);for(;t.parent;)o++,t=t.parent;return"h".concat(o)},this.renderHeadline=(t,e)=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.Z,{ref:t.scrollRef,sx:{overflowWrap:"break-word"},"data-type":"chapter-header",variant:this.getHeaderVariant(t,e),children:t.header})}),this.render=()=>this.props.activeDocument?(0,a.jsxs)(l.Z,{style:{display:"block",maxWidth:"100%"},children:[this.renderImageInModal(),this.renderChapters(this.props.activeDocument.chapters)]}):null,this.internalIds=[]}}e.default=c},59413:(t,e,o)=>{o.r(e);var i=o(72791),n=o(66934),s=o(61889),r=o(37690),l=o(24784),a=o(38629),c=o(45280),p=o(16071),d=o(80184);const h=(0,n.ZP)(s.ZP)((()=>({maxHeight:"100%",overflowY:"auto",overflowX:"hidden",userSelect:"text",outline:"none"}))),u=(0,n.ZP)(s.ZP)((t=>{let{theme:e}=t;return{paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),outline:"none"}})),m=(0,n.ZP)(s.ZP)((t=>{let{theme:e}=t;return{marginBottom:e.spacing(2)}})),g=t=>{var e,o;const{activeDocument:i,options:n}=t,s=null===n||void 0===n||null===(e=n.tableOfContents)||void 0===e?void 0:e.expanded,r=null===i||void 0===i||null===(o=i.tableOfContents)||void 0===o?void 0:o.expanded;return r||!1===r?r:!s&&!1!==s||s};class b extends i.PureComponent{constructor(t){super(t),this.state={showScrollButton:!1,showPrintWindow:!1,expandedTableOfContents:g(this.props)},this.setScrollButtonLimit=()=>{const{options:t}=this.props;let e=t.showScrollButtonLimit;this.scrollLimit=null!=e&&""!==e?e:400},this.bindSubscriptions=()=>{const{localObserver:t}=this.props;t.subscribe("scroll-to-chapter",(async t=>{await(0,a.delay)(100),t.scrollRef.current.scrollIntoView()})),t.subscribe("scroll-to-top",(()=>{this.scrollToTop()}))},this.onScroll=t=>{t.target.scrollTop>this.scrollLimit?this.setState({showScrollButton:!0}):this.setState({showScrollButton:!1})},this.componentDidUpdate=t=>{t.activeDocument!==this.props.activeDocument&&this.setState({expandedTableOfContents:g(this.props)})},this.scrollToTop=async()=>{c.NY.scrollTo(0,{containerId:"documentViewer",smooth:!1,duration:0,delay:100})},this.selectAllText=()=>{let t=document.createRange();t.selectNode(this.documentViewerRef.current),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)},this.toggleCollapse=t=>{this.setState({expandedTableOfContents:!this.state.expandedTableOfContents})},this.getTocTitle=()=>{var t,e;const{activeDocument:o,options:i}=this.props,n=null===o||void 0===o||null===(t=o.tableOfContents)||void 0===t?void 0:t.title,s=null===i||void 0===i||null===(e=i.tableOfContents)||void 0===e?void 0:e.title;return n||!1===n?n:s||!1===s?s:"Inneh\xe5llsf\xf6rteckning"},this.getChapterLevelsToShowInToc=()=>{var t,e;const{activeDocument:o,options:i}=this.props,n=null===o||void 0===o||null===(t=o.tableOfContents)||void 0===t?void 0:t.chapterLevelsToShow,s=null===i||void 0===i||null===(e=i.tableOfContents)||void 0===e?void 0:e.chapterLevelsToShow;return n||(s||100)},this.getShouldShowTableOfContents=()=>{var t,e;const{activeDocument:o,options:i}=this.props,n=null===o||void 0===o||null===(t=o.tableOfContents)||void 0===t?void 0:t.active,s=null===i||void 0===i||null===(e=i.tableOfContents)||void 0===e?void 0:e.active;return n||!1===n?n:!s&&!1!==s||s},this.getTableOfContents=()=>{const{expandedTableOfContents:t}=this.state,{activeDocument:e,localObserver:o}=this.props,i=this.getTocTitle(),n=this.getChapterLevelsToShowInToc();return(0,d.jsx)(r.default,{localObserver:o,toggleCollapse:this.toggleCollapse,activeDocument:e,expanded:t,title:i,chapterLevelsToShow:n})},this.documentViewerRef=i.createRef(),this.setScrollButtonLimit(),this.bindSubscriptions()}render(){const{activeDocument:t,localObserver:e,documentWindowMaximized:o,model:i,options:n}=this.props,{showScrollButton:s}=this.state,r=this.getShouldShowTableOfContents();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(h,{onScroll:this.onScroll,id:"documentViewer",ref:this.documentViewerRef,container:!0,children:[r&&(0,d.jsx)(m,{xs:12,item:!0,children:this.getTableOfContents()}),(0,d.jsx)(u,{tabIndex:"0",onKeyDown:t=>{(t.ctrlKey||t.metaKey)&&65===t.keyCode&&(this.selectAllText(),t.preventDefault())},sx:{marginTop:r?0:2},container:!0,item:!0,children:(0,d.jsx)(l.default,{options:n,model:i,localObserver:e,activeDocument:t})})]}),s&&o&&(0,d.jsx)(p.default,{color:t.documentColor,onClick:this.scrollToTop})]})}}e.default=b},10361:(t,e,o)=>{o.r(e);var i=o(72791),n=o(11640),s=o(57012),r=o(73151),l=o(59413),a=o(1447),c=o(5777),p=o(96127),d=o(94777),h=o(98246),u=o(88014),m=o(80184);class g extends i.PureComponent{constructor(){super(...arguments),this.snackbarKey=null,this.shouldShowDocumentOnStart=()=>{const{options:t}=this.props;return!!t.documentOnStart},this.scrollInDocument=t=>{const{localObserver:e,model:o,document:i}=this.props;t?e.publish("scroll-to-chapter",o.getHeaderRef(i,t)):e.publish("scroll-to-top",o.getHeaderRef(i,t))},this.showHeaderInDocument=t=>{let{documentName:e,headerIdentifier:o}=t;const{enqueueSnackbar:i}=this.props;e&&this.props.showDocument(e).then((()=>{this.scrollInDocument(o)}),(()=>{i("Kunde inte \xf6ppna dokumentet",{variant:"warning"}),console.warn("Could not fetch document, link to document probably reference a document not present in panelmenu")}))},this.displayMaplinkLoadingBar=()=>{const{enqueueSnackbar:t}=this.props;this.snackbarKey=t("Kartan laddar... ",{variant:"information",persist:!0,preventDuplicate:!0,transitionDuration:{enter:0,exit:0},anchorOrigin:{vertical:"bottom",horizontal:"center"}})},this.closeMaplinkLoadingBar=()=>{const{closeSnackbar:t}=this.props;t(this.snackbarKey)},this.togglePrintWindow=()=>{this.setState({showPrintWindow:!this.state.showPrintWindow})},this.handleInfoClickRequest=t=>{const e=document.createElement("span");e.innerHTML=t.payload.replace(/\\/g,"");const o=e.getElementsByTagName("a")[0];o?t.resolve((0,m.jsx)(d.CustomLink,{localObserver:this.props.localObserver,aTag:o,bottomMargin:!1})):(console.error("Could not render DocumentHandler link for payload:",t.payload),t.resolve((0,m.jsx)("b",{children:"Could not render DocumentHandler link"})))},this.bindSubscriptions=()=>{const{localObserver:t,app:e}=this.props;e.globalObserver.subscribe("core.info-click-documenthandler",this.handleInfoClickRequest),t.subscribe("set-active-document",this.showHeaderInDocument),t.subscribe("maplink-loading",this.displayMaplinkLoadingBar),t.subscribe("map-animation-complete",this.closeMaplinkLoadingBar)},this.isModelReady=()=>{const{model:t}=this.props;return!!t},this.componentDidUpdate=(t,e)=>{const{localObserver:o}=this.props;t.model!==this.props.model&&this.isModelReady()&&(this.bindSubscriptions(),this.shouldShowDocumentOnStart()&&o.publish("set-active-document",{documentName:this.props.options.documentOnStart,headerIdentifier:null}))},this.getDocumentViewer=()=>{const{documentWindowMaximized:t,document:e}=this.props;return(0,m.jsx)(l.default,{documentWindowMaximized:t,activeDocument:e,togglePrintWindow:this.togglePrintWindow,...this.props})}}render(){const{options:t,localObserver:e,documentWindowMaximized:o,document:i,togglePrintWindow:l,onWindowHide:d,showPrintWindow:h,customTheme:g,onMinimize:b,onMaximize:v}=this.props,w=this.isModelReady(),f=t.enablePrint?[{icon:(0,m.jsx)(u.Z,{}),description:"\xd6ppna utskrift",onClickCallback:l}]:[];return(0,m.jsx)(r.default,{...this.props,type:"DocumentViewer",custom:{icon:(0,m.jsx)(c.Z,{}),title:(null===i||void 0===i?void 0:i.documentTitle)||t.windowTitle||"Documents",color:(null===i||void 0===i?void 0:i.documentColor)||"#ffffff",customPanelHeaderButtons:f,description:"En kort beskrivning som visas i widgeten",height:t.height||"auto",width:t.width||600,scrollable:!1,onMinimize:b,onMaximize:v,onWindowHide:d,draggingEnabled:t.draggingEnabled||!1,resizingEnabled:t.resizingEnabled||!1,allowMaximizedWindow:!1},children:null!=i&&w?h?(0,m.jsx)(a.default,{customTheme:g,activeDocument:i,documentWindowMaximized:o,togglePrintWindow:l,localObserver:e,options:this.props.options,...this.props}):g?(0,m.jsx)(n.Z,{injectFirst:!0,children:(0,m.jsx)(s.Z,{theme:g,children:this.getDocumentViewer()})}):this.getDocumentViewer():(0,m.jsx)(p.default,{})})}}e.default=(0,h.RM)(g)},82389:(t,e,o)=>{o.r(e);var i=o(72791),n=o(66934),s=o(13400),r=o(29823),l=o(5289),a=o(35527),c=o(80184);const p=document.getElementById("map"),d="filter : blur(7px)",h=(0,n.ZP)(s.Z)((t=>{let{theme:e}=t;return{position:"absolute",backgroundColor:e.palette.grey[50],"&:hover":{backgroundColor:e.palette.grey[400]},zIndex:100,right:e.spacing(2),top:e.spacing(2)}})),u=(0,n.ZP)(a.Z)((()=>({maxHeight:"80%",maxWidth:"90%",overflow:"auto",backgroundColor:"transparent",boxShadow:"none",objectFit:"contain"})));function m(t){const{component:e,onClose:o,src:i,altValue:n}=t;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(h,{size:"small",onClick:o,children:(0,c.jsx)(r.Z,{})}),(0,c.jsx)(u,{alt:n,component:e,src:i})]})}class g extends i.PureComponent{constructor(){super(...arguments),this.removeMapBlur=()=>{p.removeAttribute("style",d)},this.addMapBlur=()=>{p.setAttribute("style",d)},this.componentWillUnmount=()=>{this.removeMapBlur()},this.componentDidMount=()=>{}}render(){const{open:t,close:e,image:o}=this.props;return t?this.addMapBlur():this.removeMapBlur(),(0,c.jsx)(l.Z,{maxWidth:"lg",onBackdropClick:e,PaperComponent:m,PaperProps:{component:"img",onClose:e,src:null===o||void 0===o?void 0:o.url,altValue:null===o||void 0===o?void 0:o.altValue},open:t})}}e.default=g},96127:(t,e,o)=>{o.r(e);var i=o(72791),n=o(61889),s=o(13239),r=o(80184);class l extends i.PureComponent{render(){return(0,r.jsx)(n.ZP,{alignItems:"center",justifyContent:"center",container:!0,sx:{height:"100%"},children:(0,r.jsx)(s.Z,{justify:"center",sx:{height:"100%"}})})}}e.default=l},16071:(t,e,o)=>{o.r(e);o(72791);var i=o(49877),n=o(68870),s=o(42847),r=o(12065),l=o(95573),a=o(80184);e.default=t=>(0,a.jsxs)(i.Z,{size:"small",onClick:t.onClick,sx:{position:"fixed",bottom:t=>t.spacing(2),right:t=>t.spacing(3),...t.color&&{backgroundColor:t.color,"&:hover":{backgroundColor:(0,r._j)(t.color,.3)}}},children:[(0,a.jsx)(n.Z,{sx:l.Z,children:"Scrolla till toppen av dokumentet"}),(0,a.jsx)(s.Z,{})]})},37690:(t,e,o)=>{o.r(e);var i=o(72791),n=o(66934),s=o(22885),r=o(81131),l=o(9933),a=o(45484),c=o(49900),p=o(90493),d=o(24518),h=o(61889),u=o(56125),m=o(80184);const g=(0,l.b)((function(t){return(0,m.jsx)(a.ZP,{component:"li",button:!0,size:"small",dense:!0,onClick:t.onCLick,style:{paddingTop:0,paddingBottom:0,paddingLeft:t.theme.spacing(3*t.level)},children:(0,m.jsx)(c.Z,{children:t.children})})})),b=(0,n.ZP)(p.Z)((t=>{let{theme:e}=t;return{width:"100%",padding:e.spacing(0)}})),v=(0,n.ZP)(d.Z)((t=>{let{theme:e}=t;return{paddingLeft:"0px",display:"flex",justifyContent:"space-between","&:focus-visible":{backgroundColor:e.palette.action.selected}}})),w=(0,n.ZP)(h.ZP)((t=>{let{theme:e}=t;return{backgroundColor:"dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[200],tapHighlightColor:"transparent",cursor:"pointer",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(1),paddingBottom:e.spacing(1)}})),f=(0,n.ZP)(u.Z)((t=>{let{theme:e}=t;return{width:"100%"}}));class x extends i.PureComponent{constructor(){super(...arguments),this.state={expanded:this.props.expanded},this.linkClick=t=>{const{localObserver:e}=this.props;e.publish("scroll-to-chapter",t)},this.renderChapters=t=>{let e=0;return(0,m.jsx)(b,{"aria-labelledby":"nested-list-subheader",children:Array.isArray(null===t||void 0===t?void 0:t.chapters)?t.chapters.map((t=>this.renderSubChapters(t,0,(++e).toString()))):null})},this.showSubChapter=t=>{const{chapterLevelsToShow:e}=this.props;return t<e},this.renderSubChapters=(t,e,o)=>{if(!this.showSubChapter(e))return null;let n=e+1,s=0;return(0,m.jsxs)(i.Fragment,{children:[(0,m.jsx)(g,{chapter:t,onCLick:()=>{this.linkClick(t)},level:e,children:t.header}),(0,m.jsx)(p.Z,{disablePadding:!0,children:Array.isArray(t.chapters)?t.chapters.map((t=>this.renderSubChapters(t,n,o.concat("."+ ++s)))):null})]},t.header)}}render(){const{activeDocument:t,title:e,expanded:o,toggleCollapse:i}=this.props;return(0,m.jsxs)(w,{container:!0,children:[(0,m.jsx)(v,{disableRipple:!0,color:"inherit",fullWidth:!0,endIcon:o?(0,m.jsx)(s.Z,{}):(0,m.jsx)(r.Z,{}),onClick:i,children:e}),(0,m.jsx)(f,{in:o,id:"expansion-panel-content","aria-hidden":!o,children:(0,m.jsx)(h.ZP,{container:!0,spacing:0,children:this.renderChapters(t)})})]})}}x.defaultProps={expanded:!0,title:"Inneh\xe5ll"},e.default=x}}]);
//# sourceMappingURL=361.fcc599a9.chunk.js.map