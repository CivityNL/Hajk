"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[7061],{67061:(e,t,i)=>{i.r(t);var r=i(66274),a=i(99359),s=i(56134),l=i(88490),o=i(9501),n=i(5426),h=i(64665),Z=i(66233),c=i(90927),d=i(5400),u=i(69236),b=i(42670),w=i(60313),p=i(30887),v=(0,a.Z)("map"),f=(0,a.Z)("localObserver"),y=(0,a.Z)("options"),g=(0,a.Z)("drawStyleSettings"),P=(0,a.Z)("draw"),O=(0,a.Z)("drawSource"),j=(0,a.Z)("drawLayer"),m=(0,a.Z)("drawTooltipElement"),k=(0,a.Z)("drawTooltipElementStyle"),S=(0,a.Z)("drawTooltip"),F=(0,a.Z)("currentPointerCoordinate"),C=(0,a.Z)("activeProduct"),D=(0,a.Z)("initDrawLayer"),x=(0,a.Z)("bindSubscriptions"),T=(0,a.Z)("createDrawTooltip"),A=(0,a.Z)("removeEventualDrawTooltipElement"),L=(0,a.Z)("removeEventualDrawTooltipOverlay"),M=(0,a.Z)("cleanupMapOverlays"),E=(0,a.Z)("getDrawStyleSettings"),G=(0,a.Z)("getDrawStyle"),I=(0,a.Z)("getFeatureStyle"),N=(0,a.Z)("getFeatureTextStyle"),R=(0,a.Z)("getNewVectorSource"),_=(0,a.Z)("getNewVectorLayer"),H=(0,a.Z)("removeDrawInteraction"),V=(0,a.Z)("removeEventListeners"),X=(0,a.Z)("toggleDrawMethod"),z=(0,a.Z)("enableSelectFeaturesSearch"),B=(0,a.Z)("handleSelectFeatureClick"),J=(0,a.Z)("handleDrawFeatureAdded"),Y=(0,a.Z)("getTotalArea"),q=(0,a.Z)("handleDrawStart"),K=(0,a.Z)("handleDrawEnd"),Q=(0,a.Z)("handlePotentialMultipleGeometriesException"),U=(0,a.Z)("handlePointerMove"),W=(0,a.Z)("handleFeatureChange"),$=(0,a.Z)("getFeatureArea"),ee=(0,a.Z)("getTooltipText"),te=(0,a.Z)("resetDrawing"),ie=(0,a.Z)("getDrawnFeatures");t.default=class{constructor(e){var t=this;Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,y,{writable:!0,value:void 0}),Object.defineProperty(this,g,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),Object.defineProperty(this,O,{writable:!0,value:void 0}),Object.defineProperty(this,j,{writable:!0,value:void 0}),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:()=>{(0,r.Z)(this,O)[O]=(0,r.Z)(this,R)[R](),(0,r.Z)(this,j)[j]=(0,r.Z)(this,_)[_]((0,r.Z)(this,O)[O],(0,r.Z)(this,G)[G](),{layerType:"system",zIndex:5e3,name:"pluginFmeServer"}),(0,r.Z)(this,v)[v].addLayer((0,r.Z)(this,j)[j])}}),Object.defineProperty(this,x,{writable:!0,value:()=>{(0,r.Z)(this,f)[f].subscribe("view.activeProductChange",(e=>{(0,r.Z)(this,C)[C]=e})),(0,r.Z)(this,f)[f].subscribe("map.toggleDrawMethod",(0,r.Z)(this,X)[X]),(0,r.Z)(this,f)[f].subscribe("map.resetDrawing",(0,r.Z)(this,te)[te])}}),Object.defineProperty(this,T,{writable:!0,value:()=>{(0,r.Z)(this,A)[A](),(0,r.Z)(this,m)[m]=document.createElement("div"),(0,r.Z)(this,m)[m].setAttribute("style",(0,r.Z)(this,k)[k]),(0,r.Z)(this,S)[S]=new b.Z({element:(0,r.Z)(this,m)[m],offset:[30,-5],positioning:"bottom-center"}),(0,r.Z)(this,v)[v].addOverlay((0,r.Z)(this,S)[S])}}),Object.defineProperty(this,A,{writable:!0,value:()=>{(0,r.Z)(this,m)[m]&&((0,r.Z)(this,m)[m].parentNode.removeElement((0,r.Z)(this,m)[m]),(0,r.Z)(this,m)[m]=null)}}),Object.defineProperty(this,L,{writable:!0,value:()=>{(0,r.Z)(this,S)[S]&&((0,r.Z)(this,v)[v].removeOverlay((0,r.Z)(this,S)[S]),(0,r.Z)(this,S)[S]=null)}}),Object.defineProperty(this,M,{writable:!0,value:()=>{(0,r.Z)(this,A)[A](),(0,r.Z)(this,L)[L]()}}),Object.defineProperty(this,E,{writable:!0,value:()=>({strokeColor:(0,r.Z)(this,y)[y].drawStrokeColor||"rgba(74,74,74,0.5)",fillColor:(0,r.Z)(this,y)[y].drawFillColor||"rgba(255,255,255,0.07)"})}),Object.defineProperty(this,G,{writable:!0,value:()=>new h.ZP({stroke:new Z.Z({color:(0,r.Z)(this,g)[g].strokeColor,width:4}),fill:new c.Z({color:(0,r.Z)(this,g)[g].fillColor}),image:new d.Z({radius:6,stroke:new Z.Z({color:(0,r.Z)(this,g)[g].strokeColor,width:2})})})}),Object.defineProperty(this,I,{writable:!0,value:e=>{const t=(0,r.Z)(this,G)[G](),i=(0,r.Z)(this,N)[N](e);return t.setText(i),t}}),Object.defineProperty(this,N,{writable:!0,value:e=>new u.Z({textAlign:"center",textBaseline:"middle",font:"12pt sans-serif",fill:new c.Z({color:"#FFF"}),text:(0,r.Z)(this,ee)[ee](e),overflow:!0,stroke:new Z.Z({color:"rgba(0, 0, 0, 0.5)",width:3}),offsetX:0,offsetY:0,rotation:0,scale:1})}),Object.defineProperty(this,R,{writable:!0,value:()=>new n.Z({wrapX:!1})}),Object.defineProperty(this,_,{writable:!0,value:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new o.Z({source:e,style:t,...i})}}),Object.defineProperty(this,H,{writable:!0,value:()=>{(0,r.Z)(this,P)[P]&&(0,r.Z)(this,v)[v].removeInteraction((0,r.Z)(this,P)[P])}}),Object.defineProperty(this,V,{writable:!0,value:()=>{(0,r.Z)(this,v)[v].un("singleclick",(0,r.Z)(this,B)[B]),(0,r.Z)(this,O)[O].un("addfeature",(0,r.Z)(this,J)[J]),(0,r.Z)(this,P)[P]&&((0,r.Z)(this,P)[P].un("drawstart",(0,r.Z)(this,q)[q]),(0,r.Z)(this,P)[P].un("drawend",(0,r.Z)(this,K)[K]),(0,r.Z)(this,v)[v].un("pointermove",(0,r.Z)(this,U)[U]))}}),Object.defineProperty(this,X,{writable:!0,value:function(e){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,r.Z)(t,H)[H](),(0,r.Z)(t,V)[V](),(0,r.Z)(t,v)[v].clickLock.delete("fmeServer"),"Select"===e)return(0,r.Z)(t,z)[z]();e&&""!==e&&((0,r.Z)(t,P)[P]=new s.ZP({source:(0,r.Z)(t,O)[O],type:"Rectangle"===e?"Circle":e,freehand:!!["Circle","Rectangle"].includes(e)||i,stopClick:!0,geometryFunction:"Rectangle"===e?(0,s.dO)():"Circle"===e?(0,s.N_)():null,style:(0,r.Z)(t,G)[G]()}),(0,r.Z)(t,v)[v].clickLock.add("fmeServer"),(0,r.Z)(t,P)[P].on("drawstart",(0,r.Z)(t,q)[q]),(0,r.Z)(t,P)[P].on("drawend",(0,r.Z)(t,K)[K]),(0,r.Z)(t,v)[v].on("pointermove",(0,r.Z)(t,U)[U]),(0,r.Z)(t,v)[v].addInteraction((0,r.Z)(t,P)[P]),(0,r.Z)(t,O)[O].on("addfeature",(0,r.Z)(t,J)[J]))}}),Object.defineProperty(this,z,{writable:!0,value:()=>{(0,r.Z)(this,v)[v].clickLock.add("fmeServer"),(0,r.Z)(this,v)[v].on("singleclick",(0,r.Z)(this,B)[B]),(0,r.Z)(this,O)[O].on("addfeature",(0,r.Z)(this,J)[J])}}),Object.defineProperty(this,B,{writable:!0,value:e=>{(0,p.handleClick)(e,e.map,(e=>{const t=e.features.filter((e=>e.getGeometry()));0!==t.length&&((0,r.Z)(this,Q)[Q](),(0,r.Z)(this,O)[O].addFeature(t[0]))}))}}),Object.defineProperty(this,J,{writable:!0,value:()=>{try{const e=(0,r.Z)(this,ie)[ie](),t=(0,r.Z)(this,Y)[Y](e);(0,r.Z)(this,f)[f].publish("map.featureAdded",{error:0===t,features:e,totalArea:t})}catch(e){(0,r.Z)(this,f)[f].publish("map.featureAdded",{error:!0,features:[],totalArea:0})}}}),Object.defineProperty(this,Y,{writable:!0,value:e=>e.reduce(((e,t)=>e+(0,r.Z)(this,$)[$](t)),0)}),Object.defineProperty(this,q,{writable:!0,value:e=>{e.feature.on("change",(0,r.Z)(this,W)[W])}}),Object.defineProperty(this,K,{writable:!0,value:e=>{(0,r.Z)(this,Q)[Q]();const{feature:t}=e;(0,r.Z)(this,m)[m].innerHTML=null,(0,r.Z)(this,F)[F]=null,(0,r.Z)(this,S)[S].setPosition((0,r.Z)(this,F)[F]),t.setStyle((0,r.Z)(this,I)[I](t))}}),Object.defineProperty(this,Q,{writable:!0,value:()=>{var e;const t=null!==(e=(0,r.Z)(this,C)[C].allowMultipleGeometries)&&void 0!==e&&e,i=(0,r.Z)(this,O)[O].getFeatures().length;t||0===i||((0,r.Z)(this,O)[O].clear(),(0,r.Z)(this,f)[f].publish("map.maxFeaturesExceeded"))}}),Object.defineProperty(this,U,{writable:!0,value:e=>{(0,r.Z)(this,F)[F]=e.coordinate}}),Object.defineProperty(this,W,{writable:!0,value:e=>{const t=e.target,i=(0,r.Z)(this,ee)[ee](t);(0,r.Z)(this,m)[m].innerHTML=i,(0,r.Z)(this,S)[S].setPosition((0,r.Z)(this,F)[F])}}),Object.defineProperty(this,$,{writable:!0,value:e=>{const t=e.getGeometry();if(t instanceof l.Z){const e=t.getRadius();return Math.round(Math.pow(e,2)*Math.PI)}return Math.round(t.getArea())}}),Object.defineProperty(this,ee,{writable:!0,value:e=>{const t=(0,r.Z)(this,$)[$](e);return t>=1e6?"".concat((t/1e6).toFixed(3)," km\xb2"):"".concat(t.toLocaleString()," m\xb2")}}),Object.defineProperty(this,te,{writable:!0,value:()=>{(0,r.Z)(this,v)[v].clickLock.delete("fmeServer"),(0,r.Z)(this,O)[O].clear(),(0,r.Z)(this,H)[H](),(0,r.Z)(this,V)[V](),(0,r.Z)(this,M)[M]()}}),Object.defineProperty(this,ie,{writable:!0,value:()=>(0,r.Z)(this,O)[O].getFeatures()}),this.getAllFeaturesAsGeoJson=()=>{const e=(0,r.Z)(this,ie)[ie]();return 0===e.length?null:1===e.length?(new w.Z).writeFeature(e[0]):(new w.Z).writeFeatures(e)},(0,r.Z)(this,v)[v]=e.map,(0,r.Z)(this,f)[f]=e.localObserver,(0,r.Z)(this,y)[y]=e.options,(0,r.Z)(this,P)[P]=null,(0,r.Z)(this,m)[m]=null,(0,r.Z)(this,S)[S]=null,(0,r.Z)(this,F)[F]=null,(0,r.Z)(this,C)[C]=null,(0,r.Z)(this,k)[k]="position: relative; background: rgba(0, 0, 0, 0.5); border-radius: 4px; color: white; padding: 4px 8px; opacity: 0.7; white-space: nowrap;",(0,r.Z)(this,g)[g]=(0,r.Z)(this,E)[E](),(0,r.Z)(this,D)[D](),(0,r.Z)(this,x)[x](),(0,r.Z)(this,T)[T]()}}}}]);
//# sourceMappingURL=7061.a5801415.chunk.js.map