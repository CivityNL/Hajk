"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[7512,2564],{28619:(t,e,i)=>{i.r(e);var o=i(72791),s=i(66934),r=i(57621),n=i(93044),a=i(66647),l=i(9585),c=i(80184);const p=(0,s.ZP)(r.Z)((t=>{let{theme:e}=t;return{marginBottom:e.spacing(1),width:"210px",[e.breakpoints.down("sm")]:{boxShadow:"none",borderBottom:"1px solid #ccc",borderRadius:0,margin:0,width:"100%",justifyContent:"left"}}})),u=(0,s.ZP)(n.Z)((t=>{let{theme:e}=t;return{background:e.palette.text.primary}}));class d extends o.PureComponent{constructor(){super(...arguments),this.state={open:!1,text:""}}render(){const{abstract:t,icon:e,onClick:i,title:o}=this.props;return(0,c.jsx)(p,{onClick:i,children:(0,c.jsx)(a.Z,{children:(0,c.jsx)(l.Z,{avatar:(0,c.jsx)(u,{children:e}),title:o,subheader:t})})})}}d.defaultProps={abstract:"Beskrivning saknas",title:"Titel saknas"},e.default=d},73151:(t,e,i)=>{i.r(e);var o=i(72791),s=i(85286),r=i(54164),n=i(19538),a=i(45484),l=i(57064),c=i(49900),p=i(26191),u=i(28619),d=i(74599),h=i(80184);class m extends o.PureComponent{constructor(t){var e;super(t),e=this,this.handleButtonClick=t=>{this.showWindow({hideOtherPluginWindows:!0,runCallback:!0}),this.props.app.globalObserver.publish("core.onlyHideDrawerIfNeeded")},this.showWindow=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=t.hideOtherPluginWindows||!0,o=t.runCallback||!0;if(e.props.app.activeTool=e.type,e.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:e.type,activeMap:e.props.app.config.activeMap}),e.props.app.pushPluginIntoHistory({type:e.type,icon:e.props.custom.icon,title:e.title,description:e.description}),!0===e.state.windowVisible)return null;!0===i&&e.props.app.onWindowOpen(e),e.setState({windowVisible:!0},(()=>{e.props.app.globalObserver.publish("core.pluginVisibilityChanged"),!0===o&&"function"===typeof e.props.custom.onWindowShow&&e.props.custom.onWindowShow()}))},this.closeWindow=()=>{this.type===this.props.app.activeTool&&(this.props.app.activeTool=void 0),this.setState({windowVisible:!1},(()=>{this.props.app.globalObserver.publish("core.pluginVisibilityChanged"),"function"===typeof this.props.custom.onWindowHide&&this.props.custom.onWindowHide()}))},this.type=t.type.toLowerCase()||void 0,this.description=t.options.description||t.custom.description;const i=!1===this.props.app.config.mapConfig.map.clean&&(s.isMobile?t.options.visibleAtStartMobile:t.options.visibleAtStart)||!1;i&&this.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:this.type,activeMap:this.props.app.config.activeMap}),this.state={title:t.options.title||t.custom.title||"Unnamed plugin",color:t.options.color||t.custom.color||null,windowVisible:i},this.title=t.options.title||t.custom.title||"Unnamed plugin",this.width=t.options.width||t.custom.width||400,this.height=t.options.height||t.custom.height||"auto",this.position=t.options.position||t.custom.position||"left",t.app.registerWindowPlugin(this);const o="".concat(this.type,".showWindow");t.app.globalObserver.subscribe(o,(t=>{this.showWindow(t)}));const r="".concat(this.type,".closeWindow");t.app.globalObserver.subscribe(r,(()=>{this.closeWindow()}))}componentDidUpdate(t){t.custom.title!==this.props.custom.title&&this.setState({title:this.props.custom.title}),t.custom.color!==this.props.custom.color&&this.setState({color:this.props.custom.color})}pluginIsWidget(t){return["left","right"].includes(t)}renderWindow(t){const{target:e}=this.props.options;return"function"===typeof(null===t||void 0===t?void 0:t.render)?t.render():(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(p.default,{globalObserver:this.props.app.globalObserver,title:this.state.title,color:this.state.color,onClose:this.closeWindow,open:this.state.windowVisible,onResize:this.props.custom.onResize,onMaximize:this.props.custom.onMaximize,onMinimize:this.props.custom.onMinimize,draggingEnabled:this.props.custom.draggingEnabled,customPanelHeaderButtons:this.props.custom.customPanelHeaderButtons,resizingEnabled:this.props.custom.resizingEnabled,scrollable:this.props.custom.scrollable,allowMaximizedWindow:this.props.custom.allowMaximizedWindow,disablePadding:this.props.custom.disablePadding,width:this.width,height:this.height,position:this.position,mode:"window",layerswitcherConfig:this.props.app.config.mapConfig.tools.find((t=>"layerswitcher"===t.type)),children:o.cloneElement(this.props.children,{windowVisible:this.state.windowVisible})}),"hidden"!==e&&this.renderDrawerButton(),this.pluginIsWidget(e)&&this.renderWidgetButton("".concat(e,"-column")),"control"===e&&this.renderControlButton()]})}renderDrawerButton(){return(0,r.createPortal)((0,h.jsx)(n.Z,{mdUp:this.pluginIsWidget(this.props.options.target)||"control"===this.props.options.target,children:(0,h.jsxs)(a.ZP,{button:!0,divider:!0,selected:this.state.windowVisible,onClick:this.handleButtonClick,children:[(0,h.jsx)(l.Z,{children:this.props.custom.icon}),(0,h.jsx)(c.Z,{primary:this.title})]})}),document.getElementById("plugin-buttons"))}renderWidgetButton(t){return(0,r.createPortal)((0,h.jsx)(n.Z,{mdDown:!0,children:(0,h.jsx)(u.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById(t))}renderControlButton(){return(0,r.createPortal)((0,h.jsx)(n.Z,{mdDown:!0,children:(0,h.jsx)(d.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById("plugin-control-buttons"))}render(){return!0!==this.props.app.config.mapConfig.map.clean&&this.renderWindow(this.props.custom)}}e.default=m},57512:(t,e,i)=>{i.r(e);i(72791);var o=i(85194),s=i.n(o),r=i(62553),n=i(73151),a=i(84863),l=i(2564),c=i(67061),p=i(80184);e.default=t=>{const e=s()(),i=new c.default({localObserver:e,map:t.map,options:t.options}),o=new l.default({localObserver:e,app:t.app,mapViewModel:i,options:t.options});return(0,p.jsx)(n.default,{...t,type:"FmeServer",custom:{icon:(0,p.jsx)(r.Z,{}),title:"FME-server",description:"Best\xe4ll jobb fr\xe5n FME-server.",height:"dynamic",width:400,onWindowHide:()=>{e.publish("view.toggleDrawMethod",""),e.publish("map.toggleDrawMethod","")}},children:(0,p.jsx)(a.default,{model:o,mapViewModel:i,options:t.options,localObserver:e})})}},2564:(t,e,i)=>{i.r(e);var o=i(66274),s=i(99359),r=i(25806),n=(0,s.Z)("options"),a=(0,s.Z)("mapServiceBase"),l=(0,s.Z)("mapViewModel"),c=(0,s.Z)("activeUserEmail"),p=(0,s.Z)("createRequestUrlString"),u=(0,s.Z)("getParameterNameValueString"),d=(0,s.Z)("getStepSize"),h=(0,s.Z)("getParameterValue"),m=(0,s.Z)("getParametersToSend"),b=(0,s.Z)("makeRestApiOrder"),g=(0,s.Z)("makeDataDownloadOrder"),v=(0,s.Z)("createGetParametersUrl"),w=(0,s.Z)("createSubmitProductRequestUrl"),f=(0,s.Z)("createDataDownloadUrl"),y=(0,s.Z)("createProductStatusUrl");e.default=class{constructor(t){var e,i;Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,a,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),this.getActiveUserEmail=()=>(0,o.Z)(this,c)[c],this.getProduct=(t,e)=>0===(null===t||void 0===t?void 0:t.length)||0===(null===e||void 0===e?void 0:e.length)?null:(0,o.Z)(this,n)[n].products.find((i=>i.group===t&&i.name===e)),this.makeOrder=(t,e,i,s)=>{const r=this.getProduct(t,e);return""!==s&&r.promptForEmail?(0,o.Z)(this,g)[g](r,i,s):(0,o.Z)(this,b)[b](r,i)},Object.defineProperty(this,p,{writable:!0,value:(t,e,i)=>{let s="opt_servicemode=async&opt_responseformat=json&opt_requesteremail=".concat(i,"&");if(!this.noGeomAttributeSupplied(t)){const e=(0,o.Z)(this,l)[l].getAllFeaturesAsGeoJson();s+="".concat(t.geoAttribute,"=").concat(e,"&")}return e.forEach((t=>{s+="".concat((0,o.Z)(this,u)[u](t),"&")})),s}}),Object.defineProperty(this,u,{writable:!0,value:t=>{var e,i,o,s,r,n;switch(t.type){case"CHOICE":case"LOOKUP_CHOICE":case"STRING":case"TEXT":case"PASSWORD":return"".concat(t.name,"=").concat(null!==(e=null!==(i=t.value)&&void 0!==i?i:t.defaultValue)&&void 0!==e?e:"");case"LISTBOX":case"LOOKUP_LISTBOX":const a=null!==(o=null!==(s=t.value)&&void 0!==s?s:t.defaultValue)&&void 0!==o?o:[];if(0===a.length)return"".concat(t.name,"=");return"".concat(t.name,"=").concat(a.join(","));case"RANGE_SLIDER":const{value:l}=this.getRangeSliderValueAndStep(t);return"".concat(t.name,"=").concat(l);default:return null!==(r=null!==(n=t.value)&&void 0!==n?n:t.defaultValue)&&void 0!==r?r:""}}}),this.noGeomAttributeSupplied=t=>!t||!t.geoAttribute||""===t.geoAttribute||"none"===t.geoAttribute,Object.defineProperty(this,d,{writable:!0,value:t=>0===t?1:Number("0.".concat("1".padStart(t,"0")))}),this.getRangeSliderValueAndStep=t=>{var e;const i=(0,o.Z)(this,d)[d](t.decimalPrecision);return{value:null!==(e=t.value)&&void 0!==e?e:this.getRangeSliderMinimum(t,i),step:i}},this.getRangeSliderMinimum=(t,e)=>t.minimumExclusive?t.minimum+e:t.minimum,this.getRangeSliderMaximum=(t,e)=>t.maximumExclusive?t.maximum-e:t.maximum,Object.defineProperty(this,h,{writable:!0,value:t=>{var e,i,o,s,r,n;switch(t.type){case"CHOICE":case"LOOKUP_CHOICE":case"STRING":case"TEXT":case"PASSWORD":return null!==(e=null!==(i=t.value)&&void 0!==i?i:t.defaultValue)&&void 0!==e?e:"";case"LISTBOX":case"LOOKUP_LISTBOX":return null!==(o=null!==(s=t.value)&&void 0!==s?s:t.defaultValue)&&void 0!==o?o:[];case"RANGE_SLIDER":const{value:a}=this.getRangeSliderValueAndStep(t);return a;default:return null!==(r=null!==(n=t.value)&&void 0!==n?n:t.defaultValue)&&void 0!==r?r:""}}}),Object.defineProperty(this,m,{writable:!0,value:(t,e)=>{const i=[];if(!this.noGeomAttributeSupplied(t)){const e=(0,o.Z)(this,l)[l].getAllFeaturesAsGeoJson();i.push({name:t.geoAttribute,value:e})}return e.forEach((t=>{const e=(0,o.Z)(this,h)[h](t);i.push({name:t.name,value:e})})),i}}),this.getParametersToRender=(t,e,i)=>{const o=this.getProduct(e,i);return o?t.filter((t=>t.name!==o.geoAttribute)):[]},this.getInfoUrl=(t,e)=>{var i;const o=this.getProduct(t,e);return o&&null!==(i=o.infoUrl)&&void 0!==i?i:""},this.shouldPromptForEmail=(t,e)=>{const i=this.getProduct(t,e);return!!i&&i.promptForEmail},this.isValidEmail=t=>{if("string"!==typeof t)return!1;return/\S+@\S+\.\S+/.test(t)},this.getProductParameters=async(t,e)=>{const i=this.getProduct(t,e);if(!i)return{error:!0,parameters:[]};const s=(0,o.Z)(this,v)[v](i);try{const t=await(0,r.hfetch)(s);return{error:!1,parameters:await t.json()}}catch(n){return{error:!0,parameters:[]}}},Object.defineProperty(this,b,{writable:!0,value:async(t,e)=>{const i=(0,o.Z)(this,m)[m](t,e),s=(0,o.Z)(this,w)[w](t),n=JSON.stringify({publishedParameters:i});try{var a;const t=await(0,r.hfetch)(s,{method:"POST",body:n,credentials:"same-origin",headers:{"Content-Type":"application/json"}});return{error:!1,jobId:null!==(a=(await t.json()).id)&&void 0!==a?a:null}}catch(l){return{error:!0,jobId:null}}}}),Object.defineProperty(this,g,{writable:!0,value:async(t,e,i)=>{const s=(0,o.Z)(this,f)[f](t),n=(0,o.Z)(this,p)[p](t,e,i);try{var a,l;const t=await(0,r.hfetch)(s,{method:"POST",body:n,credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),e=await t.json();return{error:!1,jobId:null!==(a=null===e||void 0===e||null===(l=e.serviceResponse)||void 0===l?void 0:l.jobID)&&void 0!==a?a:null}}catch(c){return{error:!0,jobId:null}}}}),this.getJobStatusById=async t=>{if(!t)return{error:!0,status:null};const e=(0,o.Z)(this,y)[y](t);try{var i;const t=await(0,r.hfetch)(e),o=await t.json();return{error:!1,status:null!==(i=null===o||void 0===o?void 0:o.status)&&void 0!==i?i:null}}catch(s){return{error:!0,status:null}}},Object.defineProperty(this,v,{writable:!0,value:t=>"".concat((0,o.Z)(this,a)[a],"/fmeproxy/fmerest/v3/repositories/").concat(t.repository,"/items/").concat(t.workspace,"/parameters/")}),Object.defineProperty(this,w,{writable:!0,value:t=>"".concat((0,o.Z)(this,a)[a],"/fmeproxy/fmerest/v3/transformations/submit/").concat(t.repository,"/").concat(t.workspace,"/")}),Object.defineProperty(this,f,{writable:!0,value:t=>"".concat((0,o.Z)(this,a)[a],"/fmeproxy/fmedatadownload/").concat(t.repository,"/").concat(t.workspace,"/")}),Object.defineProperty(this,y,{writable:!0,value:t=>"".concat((0,o.Z)(this,a)[a],"/fmeproxy/fmerest/v3/transformations/jobs/id/").concat(t,"/")}),(0,o.Z)(this,n)[n]=t.options,(0,o.Z)(this,a)[a]=t.app.config.appConfig.mapserviceBase,(0,o.Z)(this,c)[c]=null!==(e=null===(i=t.app.config.userDetails)||void 0===i?void 0:i.mail)&&void 0!==e?e:"",(0,o.Z)(this,l)[l]=t.mapViewModel}}}}]);
//# sourceMappingURL=7512.917891c7.chunk.js.map