"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[9044],{3190:(e,t,s)=>{s.r(t);var i=s(72791),r=s(29823),a=s(3746),n=s(20165),h=s(5536),l=s(35527),o=s(61889),p=s(24518),c=s(13400),d=s(20890),u=s(42618),g=s(66934),m=s(15473),y=s(80184);const f=(0,g.ZP)(l.Z)((e=>{let{theme:t}=e;return{marginRight:t.spacing(.5),border:"".concat(t.spacing(.1)," solid ").concat(t.palette.divider)}})),v=(0,g.ZP)(o.ZP)((e=>{let{theme:t}=e;return{padding:t.spacing(1)}})),b=(0,g.ZP)(o.ZP)((e=>{let{theme:t}=e;return{paddingLeft:t.spacing(.5)}})),x=(0,g.ZP)("div")((e=>{let{theme:t}=e;return{padding:t.spacing(.5)}}));class j extends i.Component{constructor(e){super(e),this.setHidden=e=>{var t=e.target.getOpacity();this.setState({hidden:0===t})},this.setLayerOpacity=e=>t=>{this.setState({hidden:!this.state.hidden},(()=>{e.setOpacity(this.state.hidden?0:1)}))},this.setLayerVisibility=e=>t=>{e.get("visible")&&(e.setOpacity(1),this.props.app.globalObserver.publish("layerswitcher.hideLayer",e)),e.set("visible",!e.get("visible"))},this.openInformative=e=>{this.props.app.windows.find((e=>"informative"===e.type)).props.custom.open(e)},this.handleClose=()=>{this.setState({anchorEl:null,popoverOpen:!1})},this.state={hidden:0===e.layer.getOpacity(),anchorEl:null,popoverOpen:!1},this.chapters=this.findChapters(this.props.layer.get("name"),this.props.chapters)}componentDidMount(){this.props.layer.on("change:opacity",this.setHidden)}componentWillUnmount(){this.props.layer.un("change:opacity",this.setHidden)}isOverflow(e){if(!e)return!1;let t=e.scrollLeft++;return e.scrollLeft-- >t}findChapters(e,t){return t?t.reduce(((t,s)=>(Array.isArray(s.layers)&&(s.layers.some((t=>t===e))&&(t=[...t,s]),s.chapters.length>0&&(t=[...t,...this.findChapters(e,s.chapters)])),t)),[]):[]}renderChapterLinks(){return this.chapters&&this.chapters.length>0&&this.chapters.length>0?(0,y.jsx)(x,{children:this.chapters.map(((e,t)=>(0,y.jsx)("div",{children:(0,y.jsxs)(p.Z,{size:"small",onClick:()=>{this.setState({popoverOpen:!1}),this.openInformative(e)},children:[e.header,(0,y.jsx)(u.Z,{})]})},t)))}):null}renderChaptersPopover(e){this.setState({anchorEl:e,popoverOpen:!0})}renderInformativeIcon(){return this.props.chapters&&this.chapters&&this.chapters.length>0?(0,y.jsx)(c.Z,{size:"small",onClick:e=>{1===this.chapters.length?this.openInformative(this.chapters[0]):this.renderChaptersPopover(e.target)},children:(0,y.jsx)(h.Z,{})}):null}render(){const{layer:e,title:t,type:s}=this.props,{hidden:i}=this.state;return(0,y.jsxs)(f,{square:"flat"===s,elevation:0,children:[(0,y.jsxs)(v,{container:!0,"data-type":"bread-crumb",justifyContent:"space-between",alignItems:"center",children:[(0,y.jsx)(o.ZP,{item:!0,children:(0,y.jsx)(c.Z,{size:"small",onClick:this.setLayerOpacity(e),"aria-label":"Visa/d\xf6lj lagret tillf\xe4lligt",children:i?(0,y.jsx)(n.Z,{}):(0,y.jsx)(a.Z,{})})}),this.renderInformativeIcon(),(0,y.jsx)(b,{item:!0,children:(0,y.jsx)(d.Z,{variant:"body2",noWrap:!0,children:t})}),(0,y.jsx)(o.ZP,{item:!0,children:(0,y.jsx)(c.Z,{size:"small",onClick:this.setLayerVisibility(e),"aria-label":"Verwijder de laag van de kaart",children:(0,y.jsx)(r.Z,{})})})]}),(0,y.jsx)(m.ZP,{id:"simple-popper",open:this.state.popoverOpen,anchorEl:this.state.anchorEl,onClose:this.handleClose,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:this.renderChapterLinks()})]})}}t.default=j},29044:(e,t,s)=>{s.r(t);var i=s(66274),r=s(99359),a=s(72791),n=s(3190),h=s(66934),l=s(13967),o=s(95193),p=s(61889),c=s(94721),d=s(20890),u=s(24518),g=s(13400),m=s(68439),y=s(19924),f=s(20165),v=s(67728),b=s.n(v),x=s(80184);const j=(0,h.ZP)("div")((e=>{let{theme:t}=e;return{background:t.palette.background.paper,boxShadow:t.shadows[24],left:0,bottom:0,right:0,width:"auto",zIndex:2}})),Z=(0,h.ZP)("div")((e=>{let{theme:t}=e;return{padding:"6px ".concat(t.spacing(2)),display:"flex",alignItems:"center",justifyContent:"space-between"}})),L=(0,h.ZP)("div")((e=>{let{theme:t}=e;return{maxHeight:"300px",overflow:"auto",[t.breakpoints.down("sm")]:{maxHeight:"110px"}}})),C=(0,h.ZP)("div")((()=>({position:"absolute",left:0,right:0,bottom:0,zIndex:2}))),k=(0,h.ZP)("div")((e=>{let{theme:t}=e;return{width:"100%",paddingLeft:t.spacing(.5),paddingBottom:t.spacing(.5)}}));var w,P=(0,r.Z)("resetLayerBuffers");class O extends a.Component{constructor(e){super(e),Object.defineProperty(this,P,{writable:!0,value:()=>{this.addedLayerBuffer=[],this.removedLayerBuffer=[]}}),this.bindLayerEvents=e=>t=>{t.get("visible")&&e.push(t),this.setState({visibleLayers:e}),this.addedLayerBuffer=[],this.removedLayerBuffer=[],t.on("change:visible",(e=>{const t=e.target;clearTimeout(this.timer),this.timer=setTimeout((()=>{const e=[...this.state.visibleLayers,...this.addedLayerBuffer].filter((e=>!this.removedLayerBuffer.some((t=>e===t))));this.setState({visibleLayers:e}),(0,i.Z)(this,P)[P]()}),0),this.props.model.clearing?this.setState({visibleLayers:[]}):t.get("visible")?this.addedLayerBuffer.push(t):this.removedLayerBuffer.push(t)}))},this.clear=()=>{this.props.app.clear()},this.getBreadCrumbCompatibleLayers=()=>this.state.visibleLayers.filter((e=>["layer","group"].includes(e.get("layerType")))),this.toggle=()=>{this.setState({open:!this.state.open})},this.state={chapters:null,visibleLayers:[],open:!1},this.timer=null,e.app.globalObserver.subscribe("informativeLoaded",(e=>{this.setState({chapters:e})}))}getVisibleLayers(){return this.props.map.getLayers().getArray().filter((e=>e.getVisible()))}componentDidMount(){this.props.map&&this.props.map.getLayers().getArray().forEach(this.bindLayerEvents([]))}renderMobile(e){const{open:t}=this.state;return(0,x.jsxs)(j,{children:[(0,x.jsxs)(Z,{children:[(0,x.jsx)(d.Z,{children:"Inneh\xe5ll i kartan"}),(0,x.jsx)(g.Z,{onClick:this.toggle,size:"small",children:t?(0,x.jsx)(y.Z,{}):(0,x.jsx)(m.Z,{})})]}),t&&(0,x.jsx)(c.Z,{}),t?(0,x.jsxs)(L,{children:[e.length>0?(0,x.jsx)(p.ZP,{container:!0,item:!0,xs:12,justifyContent:"center",sx:{marginTop:1,marginBottom:1},children:(0,x.jsxs)(u.Z,{variant:"contained",onClick:this.clear,children:["Verwijder alle inhoud",(0,x.jsx)(f.Z,{sx:{marginLeft:2}})]})}):(0,x.jsx)(d.Z,{children:"Anv\xe4nd s\xf6kfunktionen eller inneh\xe5llsmenyn f\xf6r att visa information i kartan."}),e.map(((e,t)=>(0,x.jsx)(k,{children:(0,x.jsx)(n.default,{title:e.get("caption"),layer:e,chapters:this.state.chapters,app:this.props.app})},"".concat(e.get("caption"),"-").concat(t))))]}):null]})}renderDesktop(e){const t=e.map(((e,t)=>(0,x.jsx)(n.default,{title:e.get("caption"),layer:e,chapters:this.state.chapters,app:this.props.app},"".concat(e.get("caption"),"-").concat(t))));return(0,x.jsx)(C,{children:(0,x.jsx)(b(),{ref:"scrollMenu",data:t,alignCenter:!1})})}render(){const e=this.getBreadCrumbCompatibleLayers();return this.props.isMobile?e.length>0?this.renderMobile(e):null:this.renderDesktop(e)}}t.default=(w=O,e=>{const t=(0,l.Z)(),s=(0,o.Z)(t.breakpoints.down("sm"));return(0,x.jsx)(w,{...e,isMobile:s})})}}]);
//# sourceMappingURL=9044.61ef67d5.chunk.js.map