"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[4366],{44366:(e,t,s)=>{s.r(t);var o=s(72791),i=s(66934),r=s(24518),a=s(16426),n=s(21456),c=s(43526),l=s(20890),d=s(27982),p=s(80184);const h=(0,i.ZP)(r.Z)((e=>{let{theme:t}=e;return{margin:t.spacing(1),width:"115px"}})),v=(0,i.ZP)("div")((e=>{let{theme:t}=e;return{margin:"5px"}}));class g extends o.Component{constructor(e){if(super(e),this.state={activeTool:void 0},this.props.model.observer.subscribe("abortInteraction",(()=>{this.setState({activeTool:void 0})})),this.props.model.wkt){this.props.model.vectorSource.clear();const e=new d.Z,t=this.props.model.formValues[this.props.field];if(t&&t.length>0){e.readFeatures(t).forEach((e=>{this.props.model.vectorSource.addFeature(e)}))}}}componentWillUnmount(){this.props.model.observer.unsubscribe("abortInteraction"),this.props.model.deactivateInteraction()}changeTool(e,t){const{model:s}=this.props;if(this.props.onChangeTool(),t&&this.state.activeTool===t.toLowerCase())return s.deactivateInteraction(),this.setState({activeTool:void 0});if(this.state.activeTool===e)return s.deactivateInteraction(),this.setState({activeTool:void 0});switch(s.deactivateInteraction(),e){case"add":s.activateInteraction("add",t);break;case"remove":s.activateInteraction("remove");break;case"modify":s.activateInteraction("modify");break;case"move":s.activateInteraction("move")}}onAddPointClicked(){this.setState({activeTool:"point"}),this.changeTool("add","Point")}onAddLineClicked(){this.setState({activeTool:"linestring"}),this.changeTool("add","LineString")}onAddPolygonClicked(){this.setState({activeTool:"polygon"}),this.changeTool("add","Polygon")}getStatusMessage(e){return e?e.ExceptionReport?(0,p.jsxs)(l.Z,{children:["Uppdateringen misslyckades:"," ",e.ExceptionReport.Exception.ExceptionText.toString()]}):e.TransactionResponse&&e.TransactionResponse.TransactionSummary?(0,p.jsxs)("div",{children:[(0,p.jsx)(l.Z,{children:"Uppdateringen lyckades."}),(0,p.jsxs)(l.Z,{children:["Antal skapade objekt:"," ",e.TransactionResponse.TransactionSummary.totalInserted.toString()]}),(0,p.jsxs)(l.Z,{children:["Antal borttagna objekt:"," ",e.TransactionResponse.TransactionSummary.totalDeleted.toString()]}),(0,p.jsxs)(l.Z,{children:["Antal uppdaterade objekt:"," ",e.TransactionResponse.TransactionSummary.totalUpdated.toString()]})]}):(0,p.jsx)(l.Z,{children:"Status f\xf6r uppdateringen kunde inte avl\xe4sas ur svaret fr\xe5n servern."}):(0,p.jsx)(l.Z,{children:"Uppdateringen lyckades men det uppt\xe4cktes inte n\xe5gra \xe4ndringar."})}onSaveClicked(){this.props.model.editSource&&this.props.model.save((e=>{this.props.model.filty=!1,this.props.model.refreshEditingLayer(),this.props.app.globalObserver.publish("core.alert",this.getStatusMessage(e))}))}onCancelClicked(){this.props.model.deactivate(),this.props.panel.setState({checked:!1,enabled:!1,selectedSource:!1}),this.setState({activeTool:void 0})}getSelectedStyle(e){var t={};return e===this.state.activeTool&&(t.backgroundColor="#ccc"),t}storeValues(){if(!this.props.model.wkt)return;const e=new d.Z;let t="";this.props.model.vectorSource.getFeatures().length>0&&(t=e.writeFeatures(this.props.model.vectorSource.getFeatures()));let s=Object.assign({},this.props.model.formValues);s[this.props.field]=t,this.props.model.formValues=s,this.props.model.vectorSource.clear()}render(){const e=this.props.serviceConfig;var t=!this.props.enabled,s=!1,o=!1,i=!1;return this.props.model.wkt?(s=-1!==this.props.geotype.indexOf("point"),o=-1!==this.props.geotype.indexOf("polygon"),i=-1!==this.props.geotype.indexOf("line")):e&&(s=e.editPoint,i=e.editLine,o=e.editPolygon),(0,p.jsx)("div",{children:(0,p.jsx)(v,{children:(0,p.jsxs)("div",{children:[(0,p.jsxs)(h,{variant:"contained",disabled:!1===t?!s:t,onClick:()=>{this.onAddPointClicked()},type:"button",title:"L\xe4gg till plats",style:this.getSelectedStyle("point"),children:["Plats",(0,p.jsx)(a.Z,{sx:{marginLeft:1}})]}),(0,p.jsxs)(h,{variant:"contained",disabled:!1===t?!i:t,onClick:()=>{this.onAddLineClicked()},type:"button",title:"L\xe4gg till str\xe4cka",style:this.getSelectedStyle("linestring"),children:["Str\xe4cka",(0,p.jsx)(c.Z,{sx:{marginLeft:1}})]}),(0,p.jsxs)(h,{variant:"contained",disabled:!1===t?!o:t,onClick:()=>{this.onAddPolygonClicked()},type:"button",title:"L\xe4gg till omr\xe5de",style:this.getSelectedStyle("polygon"),children:["Omr\xe5de",(0,p.jsx)(n.Z,{sx:{marginLeft:1}})]})]})})})}}t.default=g},21456:(e,t,s)=>{var o=s(64836);t.Z=void 0;var i=o(s(45649)),r=s(80184),a=(0,i.default)((0,r.jsx)("path",{d:"M15 21h2v-2h-2v2zm4 0h2v-2h-2v2zM7 21h2v-2H7v2zm4 0h2v-2h-2v2zm8-4h2v-2h-2v2zm0-4h2v-2h-2v2zM3 3v18h2V5h16V3H3zm16 6h2V7h-2v2z"}),"BorderStyle");t.Z=a},43526:(e,t,s)=>{var o=s(64836);t.Z=void 0;var i=o(s(45649)),r=s(80184),a=(0,i.default)((0,r.jsx)("path",{d:"M19.5 9.5c-1.03 0-1.9.62-2.29 1.5h-2.92c-.39-.88-1.26-1.5-2.29-1.5s-1.9.62-2.29 1.5H6.79c-.39-.88-1.26-1.5-2.29-1.5C3.12 9.5 2 10.62 2 12s1.12 2.5 2.5 2.5c1.03 0 1.9-.62 2.29-1.5h2.92c.39.88 1.26 1.5 2.29 1.5s1.9-.62 2.29-1.5h2.92c.39.88 1.26 1.5 2.29 1.5 1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5z"}),"LinearScale");t.Z=a},16426:(e,t,s)=>{var o=s(64836);t.Z=void 0;var i=o(s(45649)),r=s(80184),a=(0,i.default)([(0,r.jsx)("circle",{cx:"7",cy:"14",r:"3"},"0"),(0,r.jsx)("circle",{cx:"11",cy:"6",r:"3"},"1"),(0,r.jsx)("circle",{cx:"16.6",cy:"17.6",r:"3"},"2")],"ScatterPlot");t.Z=a}}]);
//# sourceMappingURL=4366.c95fd5be.chunk.js.map