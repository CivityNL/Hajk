{"version":3,"file":"static/js/5354.0aa8ab02.chunk.js","mappings":"yIAAe,MAAMA,EACnBC,YAAYC,GAAW,KAQvBC,kCAAqCC,IACnC,IACE,MAAMC,EAAS,IAAIC,gBAAgBF,GACnC,IAAIG,EAMJ,OAFEA,EAHGF,EAAOG,IAAI,MAASH,EAAOG,IAAI,KAGzB,CAACH,EAAOI,IAAI,KAAMJ,EAAOI,IAAI,MAF7BC,KAAKC,IAAIC,UAAUC,YAIvB,CACLN,OAAQA,EACRO,KAAMT,EAAOI,IAAI,MAAQC,KAAKC,IAAIC,UAAUG,UAC5CC,OAAQX,EAAOI,IAAI,KACnBQ,YAAaZ,EAAOI,IAAI,OAAS,KAYpC,CAVC,MAAOS,GAIP,OAHAC,QAAQD,MAAMA,GAGP,CACLX,OAAQG,KAAKC,IAAIC,UAAUC,YAC3BC,KAAMJ,KAAKC,IAAIC,UAAUG,UACzBC,OAAQ,KACRC,YAAa,KAEhB,GAjCmB,KAoCtBG,kBAAoB,KAClBV,KAAKW,cAAcC,UAAU,UAAWC,IACtCb,KAAKc,eAAeC,QAAQ,uBAC5B,MAAMC,EAAchB,KAAKP,kCAAkCoB,GAEhC,OAAvBG,EAAYV,QAGdN,KAAKiB,SAASC,6BACZF,EAAYV,OACZU,EAAYT,aAMhBP,KAAKmB,MAAMnB,KAAKC,IAAIC,UAAWc,EAAYnB,OAAQmB,EAAYZ,KAA/D,GAfF,EApCAJ,KAAKiB,SAAWzB,EAASyB,SACzBjB,KAAKW,cAAgBnB,EAASmB,cAC9BX,KAAKc,eAAiBtB,EAASsB,eAC/Bd,KAAKC,IAAMT,EAASS,IACpBD,KAAKU,mBACN,CAkDDS,MAAMC,EAAMvB,EAAQO,GAClBgB,EAAKC,QAAQ,CACXxB,OAAQA,EACRO,KAAMA,EACNkB,SAAU,OAEZtB,KAAKW,cAAcI,QAAQ,yBAC5B,E","sources":["plugins/DocumentHandler/MapViewModel.js"],"sourcesContent":["export default class MapViewModel {\n  constructor(settings) {\n    this.appModel = settings.appModel;\n    this.localObserver = settings.localObserver;\n    this.globalObserver = settings.globalObserver;\n    this.map = settings.map;\n    this.bindSubscriptions();\n  }\n\n  convertMapSettingsUrlToOlSettings = (inputUrl) => {\n    try {\n      const params = new URLSearchParams(inputUrl);\n      let center;\n      if (!params.has(\"x\") || !params.has(\"y\")) {\n        center = this.map.getView().getCenter();\n      } else {\n        center = [params.get(\"x\"), params.get(\"y\")];\n      }\n      return {\n        center: center,\n        zoom: params.get(\"z\") || this.map.getView().getZoom(),\n        layers: params.get(\"l\"), // Allow 'null', we handle it later\n        groupLayers: params.get(\"gl\") || \"{}\", // Default to an empty stringified JSON object\n      };\n    } catch (error) {\n      console.error(error);\n      // In case parsing the params failed, let's ensure we have\n      // a valid return object:\n      return {\n        center: this.map.getView().getCenter(),\n        zoom: this.map.getView().getZoom(),\n        layers: null,\n        groupLayers: \"{}\", // Default to an empty stringified JSON object\n      };\n    }\n  };\n\n  bindSubscriptions = () => {\n    this.localObserver.subscribe(\"fly-to\", (url) => {\n      this.globalObserver.publish(\"core.minimizeWindow\");\n      const mapSettings = this.convertMapSettingsUrlToOlSettings(url);\n\n      if (mapSettings.layers !== null) {\n        // Let's use Hajk's generic layer visibility\n        // mechanism as exposed in AppModel\n        this.appModel.setLayerVisibilityFromParams(\n          mapSettings.layers,\n          mapSettings.groupLayers\n        );\n      }\n\n      // Let's ensure we end up in the correct location, even\n      // if no layer's visibility was changed\n      this.flyTo(this.map.getView(), mapSettings.center, mapSettings.zoom);\n    });\n  };\n\n  flyTo(view, center, zoom) {\n    view.animate({\n      center: center,\n      zoom: zoom,\n      duration: 1500,\n    });\n    this.localObserver.publish(\"map-animation-complete\");\n  }\n}\n"],"names":["MapViewModel","constructor","settings","convertMapSettingsUrlToOlSettings","inputUrl","params","URLSearchParams","center","has","get","this","map","getView","getCenter","zoom","getZoom","layers","groupLayers","error","console","bindSubscriptions","localObserver","subscribe","url","globalObserver","publish","mapSettings","appModel","setLayerVisibilityFromParams","flyTo","view","animate","duration"],"sourceRoot":""}