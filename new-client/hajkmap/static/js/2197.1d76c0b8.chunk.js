"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[2197,7959],{28619:(t,e,i)=>{i.r(e);var o=i(72791),s=i(66934),n=i(57621),a=i(93044),r=i(66647),l=i(9585),c=i(80184);const d=(0,s.ZP)(n.Z)((t=>{let{theme:e}=t;return{marginBottom:e.spacing(1),width:"210px",[e.breakpoints.down("sm")]:{boxShadow:"none",borderBottom:"1px solid #ccc",borderRadius:0,margin:0,width:"100%",justifyContent:"left"}}})),h=(0,s.ZP)(a.Z)((t=>{let{theme:e}=t;return{background:e.palette.text.primary}}));class p extends o.PureComponent{constructor(){super(...arguments),this.state={open:!1,text:""}}render(){const{abstract:t,icon:e,onClick:i,title:o}=this.props;return(0,c.jsx)(d,{onClick:i,children:(0,c.jsx)(r.Z,{children:(0,c.jsx)(l.Z,{avatar:(0,c.jsx)(h,{children:e}),title:o,subheader:t})})})}}p.defaultProps={abstract:"Beskrivning saknas",title:"Titel saknas"},e.default=p},73151:(t,e,i)=>{i.r(e);var o=i(72791),s=i(85286),n=i(54164),a=i(19538),r=i(45484),l=i(57064),c=i(49900),d=i(26191),h=i(28619),p=i(74599),u=i(80184);class g extends o.PureComponent{constructor(t){var e;super(t),e=this,this.handleButtonClick=t=>{this.showWindow({hideOtherPluginWindows:!0,runCallback:!0}),this.props.app.globalObserver.publish("core.onlyHideDrawerIfNeeded")},this.showWindow=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=t.hideOtherPluginWindows||!0,o=t.runCallback||!0;if(e.props.app.activeTool=e.type,e.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:e.type,activeMap:e.props.app.config.activeMap}),e.props.app.pushPluginIntoHistory({type:e.type,icon:e.props.custom.icon,title:e.title,description:e.description}),!0===e.state.windowVisible)return null;!0===i&&e.props.app.onWindowOpen(e),e.setState({windowVisible:!0},(()=>{e.props.app.globalObserver.publish("core.pluginVisibilityChanged"),!0===o&&"function"===typeof e.props.custom.onWindowShow&&e.props.custom.onWindowShow()}))},this.closeWindow=()=>{this.type===this.props.app.activeTool&&(this.props.app.activeTool=void 0),this.setState({windowVisible:!1},(()=>{this.props.app.globalObserver.publish("core.pluginVisibilityChanged"),"function"===typeof this.props.custom.onWindowHide&&this.props.custom.onWindowHide()}))},this.type=t.type.toLowerCase()||void 0,this.description=t.options.description||t.custom.description;const i=!1===this.props.app.config.mapConfig.map.clean&&(s.isMobile?t.options.visibleAtStartMobile:t.options.visibleAtStart)||!1;i&&this.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:this.type,activeMap:this.props.app.config.activeMap}),this.state={title:t.options.title||t.custom.title||"Unnamed plugin",color:t.options.color||t.custom.color||null,windowVisible:i},this.title=t.options.title||t.custom.title||"Unnamed plugin",this.width=t.options.width||t.custom.width||400,this.height=t.options.height||t.custom.height||"auto",this.position=t.options.position||t.custom.position||"left",t.app.registerWindowPlugin(this);const o="".concat(this.type,".showWindow");t.app.globalObserver.subscribe(o,(t=>{this.showWindow(t)}));const n="".concat(this.type,".closeWindow");t.app.globalObserver.subscribe(n,(()=>{this.closeWindow()}))}componentDidUpdate(t){t.custom.title!==this.props.custom.title&&this.setState({title:this.props.custom.title}),t.custom.color!==this.props.custom.color&&this.setState({color:this.props.custom.color})}pluginIsWidget(t){return["left","right"].includes(t)}renderWindow(t){const{target:e}=this.props.options;return"function"===typeof(null===t||void 0===t?void 0:t.render)?t.render():(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.default,{globalObserver:this.props.app.globalObserver,title:this.state.title,color:this.state.color,onClose:this.closeWindow,open:this.state.windowVisible,onResize:this.props.custom.onResize,onMaximize:this.props.custom.onMaximize,onMinimize:this.props.custom.onMinimize,draggingEnabled:this.props.custom.draggingEnabled,customPanelHeaderButtons:this.props.custom.customPanelHeaderButtons,resizingEnabled:this.props.custom.resizingEnabled,scrollable:this.props.custom.scrollable,allowMaximizedWindow:this.props.custom.allowMaximizedWindow,disablePadding:this.props.custom.disablePadding,width:this.width,height:this.height,position:this.position,mode:"window",layerswitcherConfig:this.props.app.config.mapConfig.tools.find((t=>"layerswitcher"===t.type)),children:o.cloneElement(this.props.children,{windowVisible:this.state.windowVisible})}),"hidden"!==e&&this.renderDrawerButton(),this.pluginIsWidget(e)&&this.renderWidgetButton("".concat(e,"-column")),"control"===e&&this.renderControlButton()]})}renderDrawerButton(){return(0,n.createPortal)((0,u.jsx)(a.Z,{mdUp:this.pluginIsWidget(this.props.options.target)||"control"===this.props.options.target,children:(0,u.jsxs)(r.ZP,{button:!0,divider:!0,selected:this.state.windowVisible,onClick:this.handleButtonClick,children:[(0,u.jsx)(l.Z,{children:this.props.custom.icon}),(0,u.jsx)(c.Z,{primary:this.title})]})}),document.getElementById("plugin-buttons"))}renderWidgetButton(t){return(0,n.createPortal)((0,u.jsx)(a.Z,{mdDown:!0,children:(0,u.jsx)(h.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById(t))}renderControlButton(){return(0,n.createPortal)((0,u.jsx)(a.Z,{mdDown:!0,children:(0,u.jsx)(p.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById("plugin-control-buttons"))}render(){return!0!==this.props.app.config.mapConfig.map.clean&&this.renderWindow(this.props.custom)}}e.default=g},98648:(t,e,i)=>{i.r(e);var o=i(72791),s=i(98246),n=i(35527),a=i(20068),r=i(66934),l=i(90388),c=i(13239),d=i(13618),h=i(7168),p=i(81910),u=i(77959),g=i(80184);const m=(0,r.ZP)(n.Z)((t=>{let{theme:e}=t;return{marginBottom:e.spacing(1)}})),b=(0,r.ZP)(l.Z)((()=>({minWidth:"unset",color:"unset",paddingLeft:7,paddingRight:7,paddingTop:6,paddingBottom:6}))),w=o.memo((t=>{let{onClick:e,defaultTooltip:i,model:n}=t;const{enqueueSnackbar:r}=(0,s.Ds)(),[l,w]=o.useState(!1),[y,v]=o.useState(i),[k,f]=o.useState((0,g.jsx)(d.Z,{})),C=(0,o.useCallback)((t=>{const e={};for(let o in t)e[o]=Number.isFinite(t[o])?t[o].toFixed(1):t[o];const i=[...e.accuracy?["Nogranhet: ".concat(e.accuracy," m\n")]:[],...e.altitude&&e.altitudeAccuracy?["H\xf6jd: ".concat(e.altitude," (+/- ").concat(e.altitudeAccuracy,") m\n")]:[],...e.speed?["Hastighet: ".concat(e.speed," km/h\n")]:[],...e.heading?["Riktning: ".concat(e.heading," rad\n")]:[]],s=(0,g.jsx)(o.Fragment,{children:i.map(((t,e)=>(0,g.jsx)("div",{style:{display:"block"},children:t},e)))});v(s)}),[]),x=(0,o.useCallback)((t=>{switch(t){case"loading":f((0,g.jsx)(c.Z,{size:24}));break;case"on":f((0,g.jsx)(p.Z,{}));break;case"error":f((0,g.jsx)(h.Z,{})),v("Positionera: position ej tillg\xe4nglig");break;default:f((0,g.jsx)(d.Z,{})),v(i)}}),[i]),j=(0,o.useCallback)((t=>{1===t.code?r(u.LOCATION_DENIED_SNACK_MESSAGE,u.LOCATION_DENIED_SNACK_OPTIONS):r("Kunde inte fastst\xe4lla din plats. Felkod: ".concat(t.code,'. Detaljer: "').concat(t.message,'".'),{variant:"error"})}),[r]);return(0,o.useEffect)((()=>{const t=n.localObserver.subscribe("geolocationChange",C),e=n.localObserver.subscribe("locationStatus",x),i=n.localObserver.subscribe("geolocationError",j);return()=>{t.unsubscribe(),e.unsubscribe(),i.unsubscribe()}}),[n,C,x,j]),(0,g.jsx)(a.Z,{disableInteractive:!0,title:y,children:(0,g.jsx)(m,{children:(0,g.jsx)(b,{"aria-label":i,onClick:e,value:"check",selected:l,onChange:()=>{l?n.disable():n.enable(),w(!l)},children:k})})})}));e.default=w},72105:(t,e,i)=>{i.r(e);var o=i(72791),s=i(54164),n=i(85194),a=i.n(n),r=i(81910),l=i(73151),c=i(99716),d=i(10294),h=i(98648),p=i(80184);class u extends o.PureComponent{constructor(t){super(t),this.localObserver=a()(),this.model=new c.default({...this.props,localObserver:this.localObserver})}renderControlButton(){return(0,s.createPortal)((0,p.jsx)(h.default,{defaultTooltip:"Positionera: Visa min position i kartan",model:this.model}),document.getElementById("plugin-control-buttons"))}render(){return(0,p.jsx)(l.default,{...this.props,type:"Location",custom:{icon:(0,p.jsx)(r.Z,{}),title:"Positionera",description:"Visa min position i kartan",height:450,width:430,top:void 0,left:void 0,model:this.model,render:"control"===this.props.options.target?this.renderControlButton:null},children:(0,p.jsx)(d.default,{map:this.props.map,model:this.model})})}}e.default=u},99716:(t,e,i)=>{i.r(e);var o=i(73803),s=i(62652),n=i(29409),a=i(9501),r=i(5426),l=i(29868),c=i(75004),d=i(35201),h=i(64665),p=i(5400),u=i(66233),g=i(90927);e.default=class{constructor(t){this.handleGeolocationChange=t=>{this.localObserver.publish("geolocationChange",{accuracy:t.target.getAccuracy(),altitude:t.target.getAltitude(),altitudeAccuracy:t.target.getAltitudeAccuracy(),heading:t.target.getHeading(),speed:t.target.getSpeed()})},this.handleGeolocationError=t=>{this.localObserver.publish("locationStatus","error"),this.localObserver.publish("geolocationError",t)},this.handleGeolocationChangeAccuracy=t=>{this.accuracyFeature.setGeometry(t.target.getAccuracyGeometry())},this.handleGeolocationChangePosition=t=>{const e=t.target.getPosition();if(this.positionFeature.setGeometry(e?new n.Z(e):null),this.localObserver.publish("locationStatus","on"),this.zoomToLocation){const t=this.map.getView().getMaxZoom(),i=this.map.getView().getMinZoom(),o=Math.ceil(.5*(t-i));this.map.getView().animate({duration:2500,center:e,zoom:o}),this.zoomToLocation=!1}},this.toggleTracking=t=>{this.localObserver.publish("locationStatus",t?"loading":"off"),this.geolocation.setTracking(t),!1===t?(this.layer.getSource().clear(),this.zoomToLocation=!0):(this.layer.getSource().addFeature(this.accuracyFeature),this.layer.getSource().addFeature(this.positionFeature),setInterval((()=>{this.flash(this.positionFeature)}),3e3))},this.flash=t=>{const e=3e3,i=Date.now(),o=t.getGeometry().clone(),s=this.layer.on("postrender",(t=>{const n=t.frameState.time-i;if(n>=e)return void(0,d.B)(s);const a=(0,c.getVectorContext)(t),r=n/e,g=25*(0,l.Vv)(r)+5,m=(0,l.Vv)(1-r),b=new h.ZP({image:new p.Z({radius:g,stroke:new u.Z({color:"rgba(255, 0, 0, "+m+")",width:.25+m})})});a.setStyle(b),a.drawGeometry(o),this.map.render()}))},this.map=t.map,this.localObserver=t.localObserver,this.zoomToLocation=!0,this.source=new r.Z({wrapX:!1}),this.layer=new a.Z({source:this.source,layerType:"system",zIndex:5e3,name:"pluginLocation",caption:"Location layer"}),this.map.addLayer(this.layer),this.accuracyFeature=new s.Z,this.positionFeature=new s.Z,this.positionFeature.setStyle(new h.ZP({image:new p.Z({radius:6,fill:new g.Z({color:"#3399CC"}),stroke:new u.Z({color:"#fff",width:2})})})),this.geolocation=new o.Z({trackingOptions:{enableHighAccuracy:!0},projection:this.map.getView().getProjection()}),this.geolocation.on("change",this.handleGeolocationChange),this.geolocation.on("error",this.handleGeolocationError),this.geolocation.on("change:accuracyGeometry",this.handleGeolocationChangeAccuracy),this.geolocation.on("change:position",this.handleGeolocationChangePosition)}enable(){this.toggleTracking(!0)}disable(){this.toggleTracking(!1)}}},10294:(t,e,i)=>{i.r(e);var o=i(72791),s=i(98246),n=i(79012),a=i(85523),r=i(89891),l=i(79836),c=i(53382),d=i(53994),h=i(56890),p=i(35855),u=i(35527),g=i(57482),m=i(77959),b=i(80184);class w extends o.PureComponent{constructor(){super(...arguments),this.state={loading:!1,track:!1,accuracy:void 0,altitude:void 0,altitudeAccuracy:void 0,heading:void 0,speed:void 0},this.locationDetails={accuracy:{id:0,label:"Precision (m)"},altitude:{id:1,label:"H\xf6jd (m. \xf6. h.)"},altitudeAccuracy:{id:2,label:"H\xf6jdprecision (m)"},heading:{id:3,label:"Riktning (rad)"},speed:{id:4,label:"Hastighet (m/s)"}},this.toggleTracking=t=>{const{checked:e}=t.target;e?this.model.enable():this.model.disable(),this.setState({track:e}),this.setState({loading:e})}}componentDidMount(){this.map=this.props.map,this.model=this.props.model,this.model.localObserver.subscribe("geolocationChange",(t=>{let{accuracy:e,altitude:i,altitudeAccuracy:o,heading:s,speed:n}=t;this.setState({accuracy:e,altitude:i,altitudeAccuracy:o,heading:s,speed:n})})),this.model.localObserver.subscribe("locationStatus",(t=>{if("loading"===t)this.setState({loading:!0});else this.setState({loading:!1})})),this.model.localObserver.subscribe("geolocationError",(t=>{1===t.code?this.props.enqueueSnackbar(m.LOCATION_DENIED_SNACK_MESSAGE,m.LOCATION_DENIED_SNACK_OPTIONS):this.props.enqueueSnackbar("Kunde inte fastst\xe4lla din plats. Felkod: ".concat(t.code,'. Detaljer: "').concat(t.message,'".'),{variant:"error"})}))}renderLocationDetails(){return!1===this.state.track?null:(0,b.jsx)(u.Z,{children:(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(h.Z,{children:(0,b.jsxs)(p.Z,{children:[(0,b.jsx)(d.Z,{children:"Egenskap"}),(0,b.jsx)(d.Z,{align:"right",children:"V\xe4rde"})]})}),(0,b.jsx)(c.Z,{children:Object.keys(this.locationDetails).map((t=>{let e=this.locationDetails[t];return(0,b.jsxs)(p.Z,{children:[(0,b.jsx)(d.Z,{component:"th",scope:"row",children:e.label}),(0,b.jsx)(d.Z,{align:"right",children:this.state[t]?this.state[t]:"\u2013"})]},e.id)}))})]})})}render(){return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Z,{row:!0,children:(0,b.jsx)(a.Z,{control:(0,b.jsx)(r.Z,{checked:this.state.track,onChange:this.toggleTracking,value:"track"}),label:"Visa min position"})}),this.state.loading&&(0,b.jsx)(g.Z,{}),this.renderLocationDetails()]})}}e.default=(0,s.RM)(w)},77959:(t,e,i)=>{i.r(e),i.d(e,{LOCATION_DENIED_SNACK_MESSAGE:()=>o,LOCATION_DENIED_SNACK_OPTIONS:()=>s});const o="Du beh\xf6ver till\xe5ta att applikationen visar din position. F\xf6r datorer: De flesta webbl\xe4sare har en l\xe5s-ikon i adressf\xe4ltet som du kan klicka p\xe5 f\xf6r att till\xe5ta Plats/Position.",s=Object.freeze({variant:"info",persist:!1,anchorOrigin:{vertical:"top",horizontal:"center"}})}}]);
//# sourceMappingURL=2197.1d76c0b8.chunk.js.map