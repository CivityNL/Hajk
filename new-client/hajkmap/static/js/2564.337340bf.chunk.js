"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[2564],{2564:(e,t,r)=>{r.r(t);var a=r(66274),i=r(99359),o=r(25806),n=(0,i.Z)("options"),s=(0,i.Z)("mapServiceBase"),l=(0,i.Z)("mapViewModel"),u=(0,i.Z)("activeUserEmail"),c=(0,i.Z)("createRequestUrlString"),d=(0,i.Z)("getParameterNameValueString"),h=(0,i.Z)("getStepSize"),m=(0,i.Z)("getParameterValue"),p=(0,i.Z)("getParametersToSend"),v=(0,i.Z)("makeRestApiOrder"),f=(0,i.Z)("makeDataDownloadOrder"),b=(0,i.Z)("createGetParametersUrl"),g=(0,i.Z)("createSubmitProductRequestUrl"),P=(0,i.Z)("createDataDownloadUrl"),y=(0,i.Z)("createProductStatusUrl");t.default=class{constructor(e){var t,r;Object.defineProperty(this,n,{writable:!0,value:void 0}),Object.defineProperty(this,s,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),this.getActiveUserEmail=()=>(0,a.Z)(this,u)[u],this.getProduct=(e,t)=>0===(null===e||void 0===e?void 0:e.length)||0===(null===t||void 0===t?void 0:t.length)?null:(0,a.Z)(this,n)[n].products.find((r=>r.group===e&&r.name===t)),this.makeOrder=(e,t,r,i)=>{const o=this.getProduct(e,t);return""!==i&&o.promptForEmail?(0,a.Z)(this,f)[f](o,r,i):(0,a.Z)(this,v)[v](o,r)},Object.defineProperty(this,c,{writable:!0,value:(e,t,r)=>{let i="opt_servicemode=async&opt_responseformat=json&opt_requesteremail=".concat(r,"&");if(!this.noGeomAttributeSupplied(e)){const t=(0,a.Z)(this,l)[l].getAllFeaturesAsGeoJson();i+="".concat(e.geoAttribute,"=").concat(t,"&")}return t.forEach((e=>{i+="".concat((0,a.Z)(this,d)[d](e),"&")})),i}}),Object.defineProperty(this,d,{writable:!0,value:e=>{var t,r,a,i,o,n;switch(e.type){case"CHOICE":case"LOOKUP_CHOICE":case"STRING":case"TEXT":case"PASSWORD":return"".concat(e.name,"=").concat(null!==(t=null!==(r=e.value)&&void 0!==r?r:e.defaultValue)&&void 0!==t?t:"");case"LISTBOX":case"LOOKUP_LISTBOX":const s=null!==(a=null!==(i=e.value)&&void 0!==i?i:e.defaultValue)&&void 0!==a?a:[];if(0===s.length)return"".concat(e.name,"=");return"".concat(e.name,"=").concat(s.join(","));case"RANGE_SLIDER":const{value:l}=this.getRangeSliderValueAndStep(e);return"".concat(e.name,"=").concat(l);default:return null!==(o=null!==(n=e.value)&&void 0!==n?n:e.defaultValue)&&void 0!==o?o:""}}}),this.noGeomAttributeSupplied=e=>!e||!e.geoAttribute||""===e.geoAttribute||"none"===e.geoAttribute,Object.defineProperty(this,h,{writable:!0,value:e=>0===e?1:Number("0.".concat("1".padStart(e,"0")))}),this.getRangeSliderValueAndStep=e=>{var t;const r=(0,a.Z)(this,h)[h](e.decimalPrecision);return{value:null!==(t=e.value)&&void 0!==t?t:this.getRangeSliderMinimum(e,r),step:r}},this.getRangeSliderMinimum=(e,t)=>e.minimumExclusive?e.minimum+t:e.minimum,this.getRangeSliderMaximum=(e,t)=>e.maximumExclusive?e.maximum-t:e.maximum,Object.defineProperty(this,m,{writable:!0,value:e=>{var t,r,a,i,o,n;switch(e.type){case"CHOICE":case"LOOKUP_CHOICE":case"STRING":case"TEXT":case"PASSWORD":return null!==(t=null!==(r=e.value)&&void 0!==r?r:e.defaultValue)&&void 0!==t?t:"";case"LISTBOX":case"LOOKUP_LISTBOX":return null!==(a=null!==(i=e.value)&&void 0!==i?i:e.defaultValue)&&void 0!==a?a:[];case"RANGE_SLIDER":const{value:s}=this.getRangeSliderValueAndStep(e);return s;default:return null!==(o=null!==(n=e.value)&&void 0!==n?n:e.defaultValue)&&void 0!==o?o:""}}}),Object.defineProperty(this,p,{writable:!0,value:(e,t)=>{const r=[];if(!this.noGeomAttributeSupplied(e)){const t=(0,a.Z)(this,l)[l].getAllFeaturesAsGeoJson();r.push({name:e.geoAttribute,value:t})}return t.forEach((e=>{const t=(0,a.Z)(this,m)[m](e);r.push({name:e.name,value:t})})),r}}),this.getParametersToRender=(e,t,r)=>{const a=this.getProduct(t,r);return a?e.filter((e=>e.name!==a.geoAttribute)):[]},this.getInfoUrl=(e,t)=>{var r;const a=this.getProduct(e,t);return a&&null!==(r=a.infoUrl)&&void 0!==r?r:""},this.shouldPromptForEmail=(e,t)=>{const r=this.getProduct(e,t);return!!r&&r.promptForEmail},this.isValidEmail=e=>{if("string"!==typeof e)return!1;return/\S+@\S+\.\S+/.test(e)},this.getProductParameters=async(e,t)=>{const r=this.getProduct(e,t);if(!r)return{error:!0,parameters:[]};const i=(0,a.Z)(this,b)[b](r);try{const e=await(0,o.hfetch)(i);return{error:!1,parameters:await e.json()}}catch(n){return{error:!0,parameters:[]}}},Object.defineProperty(this,v,{writable:!0,value:async(e,t)=>{const r=(0,a.Z)(this,p)[p](e,t),i=(0,a.Z)(this,g)[g](e),n=JSON.stringify({publishedParameters:r});try{var s;const e=await(0,o.hfetch)(i,{method:"POST",body:n,credentials:"same-origin",headers:{"Content-Type":"application/json"}});return{error:!1,jobId:null!==(s=(await e.json()).id)&&void 0!==s?s:null}}catch(l){return{error:!0,jobId:null}}}}),Object.defineProperty(this,f,{writable:!0,value:async(e,t,r)=>{const i=(0,a.Z)(this,P)[P](e),n=(0,a.Z)(this,c)[c](e,t,r);try{var s,l;const e=await(0,o.hfetch)(i,{method:"POST",body:n,credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded"}}),t=await e.json();return{error:!1,jobId:null!==(s=null===t||void 0===t||null===(l=t.serviceResponse)||void 0===l?void 0:l.jobID)&&void 0!==s?s:null}}catch(u){return{error:!0,jobId:null}}}}),this.getJobStatusById=async e=>{if(!e)return{error:!0,status:null};const t=(0,a.Z)(this,y)[y](e);try{var r;const e=await(0,o.hfetch)(t),a=await e.json();return{error:!1,status:null!==(r=null===a||void 0===a?void 0:a.status)&&void 0!==r?r:null}}catch(i){return{error:!0,status:null}}},Object.defineProperty(this,b,{writable:!0,value:e=>"".concat((0,a.Z)(this,s)[s],"/fmeproxy/fmerest/v3/repositories/").concat(e.repository,"/items/").concat(e.workspace,"/parameters/")}),Object.defineProperty(this,g,{writable:!0,value:e=>"".concat((0,a.Z)(this,s)[s],"/fmeproxy/fmerest/v3/transformations/submit/").concat(e.repository,"/").concat(e.workspace,"/")}),Object.defineProperty(this,P,{writable:!0,value:e=>"".concat((0,a.Z)(this,s)[s],"/fmeproxy/fmedatadownload/").concat(e.repository,"/").concat(e.workspace,"/")}),Object.defineProperty(this,y,{writable:!0,value:e=>"".concat((0,a.Z)(this,s)[s],"/fmeproxy/fmerest/v3/transformations/jobs/id/").concat(e,"/")}),(0,a.Z)(this,n)[n]=e.options,(0,a.Z)(this,s)[s]=e.app.config.appConfig.mapserviceBase,(0,a.Z)(this,u)[u]=null!==(t=null===(r=e.app.config.userDetails)||void 0===r?void 0:r.mail)&&void 0!==t?t:"",(0,a.Z)(this,l)[l]=e.mapViewModel}}}}]);
//# sourceMappingURL=2564.337340bf.chunk.js.map