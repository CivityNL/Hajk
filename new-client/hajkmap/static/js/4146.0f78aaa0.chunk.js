"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[4146,6527,3418],{74390:(e,t,i)=>{i.r(t);var s=i(66274),n=i(99359),r=i(72791),o=i(98246),a=i(66934),l=i(20890),h=i(20068),d=i(24518),c=i(61889),p=i(91964),g=i(42618),u=i(25878),m=i(19924),v=i(77907),f=i(32791),b=i(16378),x=i(98937),y=i(2094),Z=i(29823),j=i(16788),k=i(43214),z=i(61611),w=i(4976),S=i(80184);const L=(0,a.ZP)("div")((e=>{let{theme:t}=e;return{paddingLeft:"0",borderBottom:"".concat(t.spacing(.2)," solid ").concat(t.palette.divider)}})),C=(0,a.ZP)("div")((e=>{let{theme:t}=e;return{display:"flex",justifyContent:"space-between",marginTop:"0"}})),M=(0,a.ZP)("div")((()=>({display:"flex",alignItems:"center",cursor:"pointer",float:"left",marginRight:"5px"}))),T=(0,a.ZP)("div")((e=>{let{theme:t}=e;return{margin:"10px 45px"}})),I=(0,a.ZP)(l.Z)((e=>{let{theme:t}=e;return{cursor:"pointer",fontSize:t.typography.pxToRem(15)}})),V=(0,a.ZP)("img")((e=>{let{theme:t}=e;return{width:t.typography.pxToRem(18),height:t.typography.pxToRem(18),marginRight:"5px"}})),E=(0,a.ZP)("div")((()=>({display:"flex",alignItems:"center"}))),O=(0,a.ZP)("div")((()=>({display:"flex",alignItems:"center",width:35,height:35,cursor:"pointer"}))),P=(0,a.ZP)("ul")((()=>({padding:0,margin:0,listStyle:"none"})));var F=(0,n.Z)("showAttributeTable");class B extends r.PureComponent{constructor(e){super(e),this.zoomEndHandler=e=>{const t=this.props.model.olMap.getView().getZoom(),i=this.props.layer.getProperties(),s=t>i.minZoom&&t<=i.maxZoom;let n=!1;return!0===this.minMaxZoomAlertOnToggleOnly?this.state.visible||s||"click"!==(null===e||void 0===e?void 0:e.type)||(n=!0):s||!this.state.zoomVisible&&this.state.visible||(n=!0),!0===n&&this.showZoomSnack(),this.setState({zoomVisible:s}),s},this.toggleVisible=e=>{const t=this.props.layer;if(this.isBackgroundLayer){if(document.getElementById("map").style.backgroundColor="#FFF",t.isFakeMapLayer)if("-2"===this.name)document.getElementById("map").style.backgroundColor="#000";else document.getElementById("map").style.backgroundColor="#FFF";else t.setVisible(!0);this.setState({visible:!0}),t.localObserver.publish("backgroundLayerChanged",this.name)}else{const t=!this.state.visible;this.setState({visible:t}),this.props.layer.setVisible(t),this.triggerZoomCheck(e,t)}},this.renderInfoButton=()=>this.isInfoEmpty()?null:(0,S.jsx)(h.Z,{title:"Mer information om lagret",children:(0,S.jsx)(O,{children:this.state.infoVisible?(0,S.jsx)(m.Z,{onClick:this.toggleInfo}):(0,S.jsx)(u.Z,{onClick:this.toggleInfo,sx:{boxShadow:this.state.infoVisible?"rgb(204, 204, 204) 2px 3px 1px":"inherit",borderRadius:"100%"}})})}),this.renderMoreButton=()=>(0,S.jsx)(h.Z,{title:"Fler inst\xe4llningar",children:(0,S.jsx)(O,{children:this.state.toggleSettings?(0,S.jsx)(Z.Z,{onClick:this.toggleSettings}):(0,S.jsx)(y.Z,{onClick:this.toggleSettings})})}),this.openInformative=e=>t=>{this.props.onOpenChapter(e)},this.toggleSettings=()=>{this.setState({toggleSettings:!this.state.toggleSettings})},this.toggleInfo=()=>{this.setState({infoVisible:!this.state.infoVisible})},this.getLayerToggler=()=>{const{visible:e}=this.state,t=e?this.isBackgroundLayer?(0,S.jsx)(f.Z,{}):(0,S.jsx)(v.Z,{sx:{fill:e=>!this.state.zoomVisible&&this.state.visible?e.palette.warning.dark:""}}):this.isBackgroundLayer?(0,S.jsx)(b.Z,{}):(0,S.jsx)(x.Z,{});return(0,S.jsx)(M,{children:t})},Object.defineProperty(this,F,{writable:!0,value:async()=>{try{const e=this.props.layer.getSource().get("url").replace("wms","wfs"),{LAYERS:t}=this.props.layer.getSource().getParams(),i=e.includes("?")?"&":"?",s="".concat(e).concat(i,"service=WFS&version=1.0.0&request=GetFeature&typeName=").concat(t,"&maxFeatures=5000&outputFormat=application%2Fjson"),n="".concat(e).concat(i,"service=WFS&version=1.0.0&request=DescribeFeatureType&typeName=").concat(t,"&outputFormat=application%2Fjson"),r=await fetch(s),o=await r.json(),a=await fetch(n),l=(await a.json()).featureTypes.find((e=>e.typeName===t)).properties.filter((e=>!e.type.toLowerCase().includes("gml"))).map((e=>({field:e.name,headerName:e.name,type:"int"===e.localType?"number":e.localType,flex:1}))),h=o.features.map(((e,t)=>({...e.properties,id:t})));this.props.app.globalObserver.publish("core.showAttributeTable",{title:"".concat(this.caption," (").concat(t,")"),content:{columns:l,rows:h}})}catch(e){console.error(e),console.log(this),this.props.enqueueSnackbar('Serverfel: attributtabellen f\xf6r lagret "'.concat(this.caption,'" kunde inte visas'),{variant:"error"})}}});const{layer:t}=e,i=t.get("layerInfo");this.isBackgroundLayer="base"===i.layerType,this.caption=i.caption,this.name=t.get("name"),this.legend=i.legend,this.legendIcon=i.legendIcon,this.infoTitle=i.infoTitle,this.infoText=i.infoText,this.infoUrl=i.infoUrl,this.infoUrlText=i.infoUrlText,this.infoOwner=i.infoOwner,this.localObserver=t.localObserver,this.showAttributeTableButton=i.showAttributeTableButton||!1,this.usesMinMaxZoom=this.layerUsesMinMaxZoom(),this.minMaxZoomAlertOnToggleOnly=t.get("minMaxZoomAlertOnToggleOnly"),this.state={visible:t.get("visible"),status:"ok",zoomVisible:!0,open:!1,toggleSettings:!1,infoVisible:!1},this.isBackgroundLayer&&t.localObserver.subscribe("backgroundLayerChanged",(e=>{e!==this.name&&(t.isFakeMapLayer||t.setVisible(!1),this.setState({visible:!1}))}))}componentDidMount(){var e,t;null===(e=(t=this.props.layer).on)||void 0===e||e.call(t,"change:visible",(e=>{const t=!e.oldValue;this.setState({visible:t}),this.listenToZoomChange(t)})),this.state.visible&&this.triggerZoomCheck(null,this.state.visible),this.listenToZoomChange(this.state.visible),this.props.app.globalObserver.subscribe("layerswitcher.wmsLayerLoadStatus",(e=>{"loaderror"!==this.state.status&&this.name===e.id&&this.setState({status:e.status})}))}layerUsesMinMaxZoom(){var e,t;const i=this.props.layer.getProperties(),s=null!==(e=i.maxZoom)&&void 0!==e?e:0,n=null!==(t=i.minZoom)&&void 0!==t?t:0;return s>0&&s<1/0||n>0&&n<1/0}listenToZoomChange(e){if(!this.usesMinMaxZoom)return;const t="core.zoomEnd";e&&!this.zoomEndListener?this.zoomEndListener=this.props.app.globalObserver.subscribe(t,this.zoomEndHandler):this.zoomEndListener&&(this.props.app.globalObserver.unsubscribe(t,this.zoomEndListener),this.zoomEndListener=null)}showZoomSnack(){if(this.zoomWarningSnack)return;const e=this.props.layer.get("layerInfo"),t=e?e.layersInfo:void 0;t&&Object.keys(t).length>1||(this.zoomWarningSnack=this.props.enqueueSnackbar('Lagret "'.concat(this.caption,'"  \xe4r inte synligt vid aktuell zoomniv\xe5.'),{variant:"warning",preventDuplicate:!0,onClose:()=>{this.zoomWarningSnack=null}}))}triggerZoomCheck(e,t){if(this.usesMinMaxZoom&&(this.zoomEndHandler(e),!1===t)){if(!this.zoomWarningSnack)return;this.props.closeSnackbar(this.zoomWarningSnack),this.zoomWarningSnack=null}}renderStatusButton(){return"loaderror"===this.state.status&&(0,S.jsx)(h.Z,{disableInteractive:!0,title:"Lagret kunde inte laddas in. Kartservern svarar inte.",children:(0,S.jsx)(O,{children:(0,S.jsx)(p.Z,{})})})}renderLegendImage(){const e=this.legend&&this.legend[0]&&this.legend[0].url?this.legend[0].url:"";return e?(0,S.jsx)("img",{width:"30",alt:"legend",src:e}):null}isInfoEmpty(){let e=this.findChapters(this.name,this.props.chapters);return!(this.infoCaption||this.infoUrl||this.infoOwner||this.infoText||e.length>0)}findChapters(e,t){let i=[];return Array.isArray(t)&&(i=t.reduce(((t,i)=>(Array.isArray(i.layers)&&(i.layers.some((t=>t===e))&&(t=[...t,i]),i.chapters.length>0&&(t=[...t,...this.findChapters(e,i.chapters)])),t)),[])),i}renderChapterLinks(e){if(e&&e.length>0){let t=this.findChapters(this.name,e);return t.length>0?(0,S.jsxs)(T,{children:[(0,S.jsx)(l.Z,{children:"Inneh\xe5ll fr\xe5n denna kategori finns ben\xe4mnt i f\xf6ljande kapitel i \xf6versiktsplanen:"}),(0,S.jsx)(P,{children:t.map(((e,t)=>(0,S.jsx)("li",{children:(0,S.jsxs)(d.Z,{size:"small",onClick:this.openInformative(e),children:[e.header,(0,S.jsx)(g.Z,{sx:{marginLeft:1,fontSize:"16px"}})]})},t)))})]}):null}return null}toggle(){this.setState({open:!this.state.open})}renderInfo(){return this.infoText?(0,S.jsxs)(T,{children:[(0,S.jsx)(l.Z,{variant:"subtitle2",children:this.infoTitle}),(0,S.jsx)(l.Z,{variant:"body2",dangerouslySetInnerHTML:{__html:this.infoText}})]}):null}renderMetadataLink(){return this.infoUrl?(0,S.jsx)(T,{children:(0,S.jsx)("a",{href:this.infoUrl,target:"_blank",rel:"noopener noreferrer",children:this.infoUrlText||this.infoUrl})}):null}renderOwner(){return this.infoOwner?(0,S.jsx)(T,{children:(0,S.jsx)(l.Z,{variant:"body2",dangerouslySetInnerHTML:{__html:this.infoOwner}})}):null}renderDetails(){if(this.state.infoVisible)return(0,S.jsxs)("div",{children:[this.renderInfo(),this.renderMetadataLink(),this.renderOwner(),(0,S.jsx)("div",{children:this.renderChapterLinks(this.props.chapters||[])})]})}renderLegendIcon(){return(0,S.jsx)(V,{alt:"Teckenf\xf6rklaring",src:this.legendIcon})}render(){var e;const{layer:t,model:i,app:n,chapters:r}=this.props,o=(null===(e=this.props.app.config.mapConfig.map)||void 0===e?void 0:e.cqlFilterVisible)||!1;return this.caption?"group"===t.get("layerType")?(0,S.jsx)(k.default,{appConfig:n.config.appConfig,mapConfig:n.config.mapConfig,layer:t,model:i,options:this.props.options,chapters:r,cqlFilterVisible:o,onOpenChapter:e=>{n.windows.find((e=>"informative"===e.type)).props.custom.open(e)}}):(0,S.jsxs)(L,{sx:{marginLeft:this.isBackgroundLayer?"0px":"45px"},children:[(0,S.jsxs)(C,{children:[(0,S.jsxs)(c.ZP,{wrap:"nowrap",alignItems:"center",alignContent:"center",container:!0,onClick:this.toggleVisible.bind(this),children:[(0,S.jsx)(c.ZP,{item:!0,children:this.getLayerToggler()}),this.legendIcon&&this.renderLegendIcon(),(0,S.jsx)(I,{children:this.caption})]}),(0,S.jsxs)(E,{children:[t.isFakeMapLayer?null:(0,S.jsx)(w.default,{layer:this.props.layer,enableDownloadLink:this.props.app.config.mapConfig.map.enableDownloadLink}),this.renderStatusButton(),this.renderInfoButton(),this.showAttributeTableButton&&(0,S.jsx)(h.Z,{title:"Visa lagrets attributtabell",children:(0,S.jsx)(O,{children:(0,S.jsx)(j.Z,{onClick:(0,s.Z)(this,F)[F]})})}),this.renderMoreButton()]})]}),(0,S.jsxs)("div",{children:[this.renderDetails(),this.state.toggleSettings&&this.state.infoVisible&&!this.isInfoEmpty()?(0,S.jsx)("hr",{}):null,t.isFakeMapLayer?null:(0,S.jsx)(z.default,{options:this.props.options,layer:t,toggled:this.state.toggleSettings,showOpacity:!0,showLegend:!0,cqlFilterVisible:o})]})]}):null}}t.default=(0,o.RM)(B)},42618:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"}),"CallMade");t.Z=o},77907:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");t.Z=o},98937:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");t.Z=o},22007:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"}),"CloudDownload");t.Z=o},85172:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");t.Z=o},5397:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight");t.Z=o},2094:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");t.Z=o},32791:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonChecked");t.Z=o},43950:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");t.Z=o},19924:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"}),"RemoveCircle");t.Z=o},16788:(e,t,i)=>{var s=i(64836);t.Z=void 0;var n=s(i(45649)),r=i(80184),o=(0,n.default)((0,r.jsx)("path",{d:"M19 7H9c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm0 2v2H9V9h10zm-6 6v-2h2v2h-2zm2 2v2h-2v-2h2zm-4-2H9v-2h2v2zm6-2h2v2h-2v-2zm-8 4h2v2H9v-2zm8 2v-2h2v2h-2zM6 17H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v1h-2V5H5v10h1v2z"}),"TableView");t.Z=o},63466:(e,t,i)=>{i.d(t,{Z:()=>j});var s=i(63366),n=i(87462),r=i(72791),o=i(28182),a=i(94419),l=i(14036),h=i(20890),d=i(93840),c=i(52930),p=i(66934),g=i(75878),u=i(21217);function m(e){return(0,u.Z)("MuiInputAdornment",e)}var v,f=(0,g.Z)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),b=i(31402),x=i(80184);const y=["children","className","component","disablePointerEvents","disableTypography","position","variant"],Z=(0,p.ZP)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:i}=e;return[t.root,t["position".concat((0,l.Z)(i.position))],!0===i.disablePointerEvents&&t.disablePointerEvents,t[i.variant]]}})((e=>{let{theme:t,ownerState:i}=e;return(0,n.Z)({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active},"filled"===i.variant&&{["&.".concat(f.positionStart,"&:not(.").concat(f.hiddenLabel,")")]:{marginTop:16}},"start"===i.position&&{marginRight:8},"end"===i.position&&{marginLeft:8},!0===i.disablePointerEvents&&{pointerEvents:"none"})}));var j=r.forwardRef((function(e,t){const i=(0,b.Z)({props:e,name:"MuiInputAdornment"}),{children:p,className:g,component:u="div",disablePointerEvents:f=!1,disableTypography:j=!1,position:k,variant:z}=i,w=(0,s.Z)(i,y),S=(0,c.Z)()||{};let L=z;z&&S.variant,S&&!L&&(L=S.variant);const C=(0,n.Z)({},i,{hiddenLabel:S.hiddenLabel,size:S.size,disablePointerEvents:f,position:k,variant:L}),M=(e=>{const{classes:t,disablePointerEvents:i,hiddenLabel:s,position:n,size:r,variant:o}=e,h={root:["root",i&&"disablePointerEvents",n&&"position".concat((0,l.Z)(n)),o,s&&"hiddenLabel",r&&"size".concat((0,l.Z)(r))]};return(0,a.Z)(h,m,t)})(C);return(0,x.jsx)(d.Z.Provider,{value:null,children:(0,x.jsx)(Z,(0,n.Z)({as:u,ownerState:C,className:(0,o.default)(M.root,g),ref:t},w,{children:"string"!==typeof p||j?(0,x.jsxs)(r.Fragment,{children:["start"===k?v||(v=(0,x.jsx)("span",{className:"notranslate",children:"\u200b"})):null,p]}):(0,x.jsx)(h.Z,{color:"text.secondary",children:p})}))})}))}}]);
//# sourceMappingURL=4146.0f78aaa0.chunk.js.map