{"version":3,"file":"static/js/9413.206e5105.chunk.js","mappings":"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","sources":["plugins/DocumentHandler/documentWindow/Contents.js","plugins/DocumentHandler/documentWindow/DocumentViewer.js","plugins/DocumentHandler/documentWindow/ImagePopupModal.js","plugins/DocumentHandler/documentWindow/ScrollToTop.js","plugins/DocumentHandler/documentWindow/TableOfContents.js","plugins/DocumentHandler/utils/helpers.js"],"sourcesContent":["import React from \"react\";\nimport Typography from \"@mui/material/Typography\";\nimport ImagePopupModal from \"./ImagePopupModal\";\nimport { flattenChaptersTree } from \"../utils/helpers\";\nimport { Box } from \"@mui/material\";\n\nclass Contents extends React.PureComponent {\n  state = {\n    popupImage: null,\n    activeContent: null,\n  };\n\n  constructor(props) {\n    super(props);\n    this.internalIds = [];\n  }\n\n  /* TODO...\n   * This should be refactored in some other way.\n   * right now we are \"creating\" components for printing here\n   * because we need to use the render in this component\n   */\n  bindPrintSpecificHandlers = () => {\n    const { localObserver, model } = this.props;\n    localObserver.unsubscribe(\"append-chapter-components\");\n\n    localObserver.subscribe(\"append-document-components\", (documents) => {\n      let chapters = [];\n      let headerChapter = [];\n\n      documents.forEach((document) => {\n        /*\n         * add an H1 tag for menu parents when printing.\n         * chapters if a group of documents has a parent document, the header of the parent\n         * is printed if any of the children are printed.\n         */\n        if (document.isGroupHeader) {\n          headerChapter.push(\n            this.createGroupHeadingTag(document.title, document.id)\n          );\n          chapters.push(headerChapter);\n          headerChapter = [];\n        } else {\n          document.chapters.forEach((chapter) => {\n            model.appendComponentsToChapter(chapter);\n          });\n\n          let renderedChapters = [];\n          let flatChaptersTree = flattenChaptersTree(document.chapters);\n          flatChaptersTree = flatChaptersTree.map((item) => {\n            if (item.mustReplace) {\n              let newItem = {};\n              item = newItem;\n            }\n            return item;\n          });\n\n          renderedChapters.push(this.renderChapters(flatChaptersTree, true));\n          chapters.push(renderedChapters);\n        }\n      });\n\n      localObserver.publish(\"chapter-components-appended\", chapters);\n    });\n  };\n\n  componentDidMount = () => {\n    const { localObserver } = this.props;\n    this.bindPrintSpecificHandlers();\n    localObserver.subscribe(\"image-popup\", this.showPopupModal);\n  };\n\n  componentWillUnmount = () => {\n    const { localObserver } = this.props;\n    localObserver.unsubscribe(\"chapter-components-appended\");\n  };\n\n  closePopupModal = () => {\n    this.setState({ popupImage: null });\n  };\n\n  showPopupModal = (image) => {\n    this.setState({ popupImage: image });\n  };\n\n  renderImageInModal = () => {\n    const { popupImage } = this.state;\n\n    return (\n      <ImagePopupModal\n        open={popupImage == null ? false : true}\n        close={this.closePopupModal}\n        image={popupImage}\n      ></ImagePopupModal>\n    );\n  };\n\n  createGroupHeadingTag = (title, id) => {\n    return (\n      <Typography key={id} data-type=\"chapter-header\" variant=\"h1\">\n        {title}\n      </Typography>\n    );\n  };\n\n  /**\n   * Renders the document with all it's chapters and sub chapters.\n   * @param {object} document The document that will be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapters = (chapters, isPrintMode) => {\n    return Array.isArray(chapters)\n      ? chapters.map((chapter) => this.renderChapter(chapter, isPrintMode))\n      : null;\n  };\n\n  /**\n   * Renders a chapter with a headline an a content.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapter = (chapter, isPrintMode) => {\n    return (\n      <React.Fragment key={chapter.id}>\n        {this.renderHeadline(chapter, isPrintMode)}\n        {chapter.components}\n        {Array.isArray(chapter.chapters)\n          ? chapter.chapters.map((subChapter) => this.renderChapter(subChapter))\n          : null}\n      </React.Fragment>\n    );\n  };\n\n  getHeaderVariant = (chapter, isPrintMode) => {\n    let headerSize = 2; //Chapters start with h2\n\n    //If we are printing, we have a flattened chapters tree, so use the chapter.level property to set the heading\n    //instead of cycling through the parent chapter objects.\n    if (isPrintMode) {\n      headerSize += chapter.level;\n      return `h${headerSize}`;\n    }\n    while (chapter.parent) {\n      headerSize++;\n      chapter = chapter.parent;\n    }\n    return `h${headerSize}`;\n  };\n\n  /**\n   * Render the headline of a chapter.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderHeadline = (chapter, isPrintMode) => {\n    return (\n      <>\n        <Typography\n          ref={chapter.scrollRef}\n          sx={{ overflowWrap: \"break-word\" }}\n          data-type=\"chapter-header\"\n          variant={this.getHeaderVariant(chapter, isPrintMode)}\n        >\n          {chapter.header}\n        </Typography>\n      </>\n    );\n  };\n\n  render = () => {\n    if (this.props.activeDocument) {\n      return (\n        <Box style={{ display: \"block\", maxWidth: \"100%\" }}>\n          {this.renderImageInModal()}\n          {this.renderChapters(this.props.activeDocument.chapters)}\n        </Box>\n      );\n    } else {\n      return null;\n    }\n  };\n}\n\nexport default Contents;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\n\nimport Grid from \"@mui/material/Grid\";\nimport TableOfContents from \"./TableOfContents\";\nimport Contents from \"./Contents\";\nimport { delay } from \"../../../utils/Delay\";\nimport { animateScroll as scroll } from \"react-scroll\";\nimport ScrollToTop from \"./ScrollToTop\";\n\nconst GridContainer = styled(Grid)(() => ({\n  maxHeight: \"100%\",\n  overflowY: \"auto\",\n  overflowX: \"hidden\",\n  userSelect: \"text\",\n  outline: \"none\",\n}));\n\nconst ContentContainer = styled(Grid)(({ theme }) => ({\n  paddingBottom: theme.spacing(1),\n  paddingLeft: theme.spacing(2),\n  paddingRight: theme.spacing(2),\n  outline: \"none\",\n}));\n\nconst TocGridWrapper = styled(Grid)(({ theme }) => ({\n  marginBottom: theme.spacing(2),\n}));\n\nconst expandedTocOnStart = (props) => {\n  const { activeDocument, options } = props;\n  const mapConfigSetting = options?.tableOfContents?.expanded;\n  const documentSetting = activeDocument?.tableOfContents?.expanded;\n  if (documentSetting || documentSetting === false) {\n    return documentSetting;\n  }\n  if (mapConfigSetting || mapConfigSetting === false) {\n    return mapConfigSetting;\n  }\n  return true;\n};\n\nclass DocumentViewer extends React.PureComponent {\n  state = {\n    showScrollButton: false,\n    showPrintWindow: false,\n    expandedTableOfContents: expandedTocOnStart(this.props),\n  };\n\n  constructor(props) {\n    super(props);\n    this.documentViewerRef = React.createRef();\n    this.setScrollButtonLimit();\n    this.bindSubscriptions();\n  }\n\n  setScrollButtonLimit = () => {\n    const { options } = this.props;\n    let showScrollButtonLimit = options.showScrollButtonLimit;\n    this.scrollLimit =\n      showScrollButtonLimit != null && showScrollButtonLimit !== \"\"\n        ? showScrollButtonLimit\n        : 400;\n  };\n\n  bindSubscriptions = () => {\n    const { localObserver } = this.props;\n\n    localObserver.subscribe(\"scroll-to-chapter\", async (chapter) => {\n      /*scrollIntoView is buggy without dirty fix - \n      tried using react life cycle methods but is, for some reason, not working*/\n      await delay(100);\n      chapter.scrollRef.current.scrollIntoView();\n    });\n\n    localObserver.subscribe(\"scroll-to-top\", () => {\n      this.scrollToTop();\n    });\n  };\n\n  onScroll = (e) => {\n    if (e.target.scrollTop > this.scrollLimit) {\n      this.setState({\n        showScrollButton: true,\n      });\n    } else {\n      this.setState({\n        showScrollButton: false,\n      });\n    }\n  };\n\n  componentDidUpdate = (prevProps) => {\n    if (prevProps.activeDocument !== this.props.activeDocument) {\n      this.setState({\n        expandedTableOfContents: expandedTocOnStart(this.props),\n      });\n    }\n  };\n\n  scrollToTop = async () => {\n    scroll.scrollTo(0, {\n      containerId: \"documentViewer\",\n      smooth: false,\n      duration: 0,\n      delay: 100,\n    });\n  };\n\n  selectAllText = () => {\n    let range = document.createRange();\n    range.selectNode(this.documentViewerRef.current);\n    window.getSelection().removeAllRanges();\n    window.getSelection().addRange(range);\n  };\n\n  toggleCollapse = (e) => {\n    this.setState({\n      expandedTableOfContents: !this.state.expandedTableOfContents,\n    });\n  };\n\n  getTocTitle = () => {\n    const { activeDocument, options } = this.props;\n    const documentSettingTitle = activeDocument?.tableOfContents?.title;\n    const mapConfigSettingTitle = options?.tableOfContents?.title;\n\n    if (documentSettingTitle || documentSettingTitle === false) {\n      return documentSettingTitle;\n    }\n    if (mapConfigSettingTitle || mapConfigSettingTitle === false) {\n      return mapConfigSettingTitle;\n    }\n    return \"Innehållsförteckning\";\n  };\n\n  getChapterLevelsToShowInToc = () => {\n    const { activeDocument, options } = this.props;\n\n    const documentSettingLevels =\n      activeDocument?.tableOfContents?.chapterLevelsToShow;\n    const mapConfigSettingLevels =\n      options?.tableOfContents?.chapterLevelsToShow;\n\n    if (documentSettingLevels) {\n      return documentSettingLevels;\n    }\n    if (mapConfigSettingLevels) {\n      return mapConfigSettingLevels;\n    }\n\n    return 100;\n  };\n\n  getShouldShowTableOfContents = () => {\n    const { activeDocument, options } = this.props;\n\n    const documentSetting = activeDocument?.tableOfContents?.active;\n    const mapConfigSetting = options?.tableOfContents?.active;\n\n    if (documentSetting || documentSetting === false) {\n      return documentSetting;\n    }\n    if (mapConfigSetting || mapConfigSetting === false) {\n      return mapConfigSetting;\n    }\n    return true;\n  };\n\n  getTableOfContents = () => {\n    const { expandedTableOfContents } = this.state;\n    const { activeDocument, localObserver } = this.props;\n\n    const title = this.getTocTitle();\n    const chapterLevelsToShow = this.getChapterLevelsToShowInToc();\n    return (\n      <TableOfContents\n        localObserver={localObserver}\n        toggleCollapse={this.toggleCollapse}\n        activeDocument={activeDocument}\n        expanded={expandedTableOfContents}\n        title={title}\n        chapterLevelsToShow={chapterLevelsToShow}\n      />\n    );\n  };\n\n  render() {\n    const {\n      activeDocument,\n      localObserver,\n      documentWindowMaximized,\n      model,\n      options,\n    } = this.props;\n\n    const { showScrollButton } = this.state;\n    const showTableOfContents = this.getShouldShowTableOfContents();\n    return (\n      <>\n        <GridContainer\n          onScroll={this.onScroll}\n          id=\"documentViewer\"\n          ref={this.documentViewerRef}\n          container\n        >\n          {showTableOfContents && (\n            <TocGridWrapper xs={12} item>\n              {this.getTableOfContents()}\n            </TocGridWrapper>\n          )}\n\n          <ContentContainer\n            tabIndex=\"0\" //Focus grid to be able to use onKeyDown\n            onKeyDown={(e) => {\n              //If ctrl-a or command-a is pressed\n              if ((e.ctrlKey || e.metaKey) && e.keyCode === 65) {\n                this.selectAllText();\n                e.preventDefault();\n              }\n            }}\n            sx={{ marginTop: showTableOfContents ? 0 : 2 }}\n            container\n            item\n          >\n            <Contents\n              options={options}\n              model={model}\n              localObserver={localObserver}\n              activeDocument={activeDocument}\n            />\n          </ContentContainer>\n        </GridContainer>\n        {showScrollButton && documentWindowMaximized && (\n          <ScrollToTop\n            color={activeDocument.documentColor}\n            onClick={this.scrollToTop}\n          ></ScrollToTop>\n        )}\n      </>\n    );\n  }\n}\n\nexport default DocumentViewer;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport IconButton from \"@mui/material/IconButton\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport Dialog from \"@mui/material/Dialog\";\nimport Paper from \"@mui/material/Paper\";\n\nconst mapDiv = document.getElementById(\"map\");\nconst blurCss = \"filter : blur(7px)\";\n\nconst CloseButton = styled(IconButton)(({ theme }) => ({\n  position: \"absolute\",\n  backgroundColor: theme.palette.grey[50],\n\n  \"&:hover\": {\n    backgroundColor: theme.palette.grey[400],\n  },\n\n  zIndex: 100,\n  right: theme.spacing(2),\n  top: theme.spacing(2),\n}));\n\nconst StyledPaper = styled(Paper)(() => ({\n  maxHeight: \"80%\",\n  maxWidth: \"90%\",\n  overflow: \"auto\",\n  backgroundColor: \"transparent\",\n  boxShadow: \"none\",\n  objectFit: \"contain\",\n}));\n\nfunction PaperComponent(props) {\n  const { component, onClose, src, altValue } = props;\n  return (\n    <>\n      <CloseButton size=\"small\" onClick={onClose}>\n        <CloseIcon />\n      </CloseButton>\n      <StyledPaper alt={altValue} component={component} src={src} />\n    </>\n  );\n}\n\nclass ImagePopupModal extends React.PureComponent {\n  removeMapBlur = () => {\n    mapDiv.removeAttribute(\"style\", blurCss);\n  };\n\n  addMapBlur = () => {\n    mapDiv.setAttribute(\"style\", blurCss);\n  };\n\n  componentWillUnmount = () => {\n    this.removeMapBlur();\n  };\n\n  componentDidMount = () => {};\n\n  render() {\n    const { open, close, image } = this.props;\n    open ? this.addMapBlur() : this.removeMapBlur();\n\n    return (\n      <Dialog\n        maxWidth=\"lg\"\n        onBackdropClick={close}\n        PaperComponent={PaperComponent}\n        PaperProps={{\n          component: \"img\",\n          onClose: close,\n          src: image?.url,\n          altValue: image?.altValue,\n        }}\n        open={open}\n      />\n    );\n  }\n}\n\nexport default ImagePopupModal;\n","import React from \"react\";\nimport { Box, Fab } from \"@mui/material\";\nimport NavigationIcon from \"@mui/icons-material/Navigation\";\nimport { darken } from \"@mui/material/styles\";\nimport { visuallyHidden } from \"@mui/utils\";\n\nconst ScrollToTop = (props) => {\n  return (\n    // Pass on all props to the styled component\n    <Fab\n      size=\"small\"\n      onClick={props.onClick}\n      sx={{\n        position: \"fixed\",\n        bottom: (theme) => theme.spacing(2),\n        right: (theme) => theme.spacing(3),\n        ...(props.color && {\n          backgroundColor: props.color,\n          \"&:hover\": {\n            backgroundColor: darken(props.color, 0.3),\n          },\n        }),\n      }}\n    >\n      <Box sx={visuallyHidden}>Scrolla till toppen av dokumentet</Box>\n      <NavigationIcon />\n    </Fab>\n  );\n};\n\nexport default ScrollToTop;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport { withTheme } from \"@emotion/react\";\nimport {\n  Grid,\n  List,\n  ListItem,\n  ListItemText,\n  Button,\n  Collapse,\n} from \"@mui/material\";\n\nfunction NestedListItemRaw(props) {\n  return (\n    <ListItem\n      component=\"li\"\n      button\n      size=\"small\"\n      dense\n      onClick={props.onCLick}\n      style={{\n        paddingTop: 0,\n        paddingBottom: 0,\n        paddingLeft: props.theme.spacing(props.level * 3),\n      }}\n    >\n      <ListItemText>{props.children}</ListItemText>\n    </ListItem>\n  );\n}\n\nconst NestedListItem = withTheme(NestedListItemRaw);\n\nconst ListRoot = styled(List)(({ theme }) => ({\n  width: \"100%\",\n  padding: theme.spacing(0),\n}));\n\nconst StyledButton = styled(Button)(({ theme }) => ({\n  paddingLeft: \"0px\",\n  display: \"flex\",\n  justifyContent: \"space-between\",\n  \"&:focus-visible\": {\n    backgroundColor: theme.palette.action.selected,\n  },\n}));\n\nconst GridTableOfContents = styled(Grid)(({ theme }) => ({\n  //Need to manually change color when switching between dark/light-mode\n  backgroundColor:\n    theme.palette.mode === \"dark\"\n      ? theme.palette.grey[700]\n      : theme.palette.grey[200],\n\n  tapHighlightColor: \"transparent\",\n  cursor: \"pointer\",\n  paddingLeft: theme.spacing(2),\n  paddingRight: theme.spacing(2),\n  paddingTop: theme.spacing(1),\n  paddingBottom: theme.spacing(1),\n}));\n\nconst CollapseCollapseContainer = styled(Collapse)(({ theme }) => ({\n  width: \"100%\",\n}));\n\nclass TableOfContents extends React.PureComponent {\n  state = {\n    expanded: this.props.expanded,\n  };\n\n  static defaultProps = {\n    expanded: true,\n    title: \"Innehåll\",\n  };\n\n  linkClick = (chapter) => {\n    const { localObserver } = this.props;\n    localObserver.publish(\"scroll-to-chapter\", chapter);\n  };\n  /**\n   * Render all chapters of the activeDocument.\n   * @param {Array} activeDocument An array with all chapters of the activeDocument.\n   *\n   * @memberof TableOfContents\n   */\n  renderChapters = (activeDocument) => {\n    let mainChapter = 0;\n    return (\n      <ListRoot aria-labelledby=\"nested-list-subheader\">\n        {Array.isArray(activeDocument?.chapters)\n          ? activeDocument.chapters.map((chapter) =>\n              this.renderSubChapters(chapter, 0, (++mainChapter).toString())\n            )\n          : null}\n      </ListRoot>\n    );\n  };\n\n  showSubChapter = (level) => {\n    const { chapterLevelsToShow } = this.props;\n    return level < chapterLevelsToShow;\n  };\n\n  /**\n   * Private help method that recursive renders all sub chapters of a chapter.\n   * @param {object} chapter A chapter with all it's sub chapters that will be rendered.\n   * @param {string} level A recursive level that help with the table construction.\n   * @param {number} subChapterNumber A counter of the current sub chapter number\n   *\n   * @memberof TableOfContents\n   */\n  renderSubChapters = (chapter, level, subChapterNumber) => {\n    if (!this.showSubChapter(level)) {\n      return null;\n    }\n    let newLevel = level + 1;\n    let number = 0;\n\n    return (\n      <React.Fragment key={chapter.header}>\n        <NestedListItem\n          chapter={chapter}\n          onCLick={() => {\n            this.linkClick(chapter);\n          }}\n          level={level}\n        >\n          {chapter.header}\n        </NestedListItem>\n        <List disablePadding>\n          {Array.isArray(chapter.chapters)\n            ? chapter.chapters.map((subChapter) =>\n                this.renderSubChapters(\n                  subChapter,\n                  newLevel,\n                  subChapterNumber.concat(\".\" + ++number)\n                )\n              )\n            : null}\n        </List>\n      </React.Fragment>\n    );\n  };\n\n  render() {\n    const { activeDocument, title, expanded, toggleCollapse } = this.props;\n\n    return (\n      <GridTableOfContents container>\n        <StyledButton\n          disableRipple\n          color=\"inherit\"\n          fullWidth\n          endIcon={\n            expanded ? (\n              <ExpandLessIcon></ExpandLessIcon>\n            ) : (\n              <ExpandMoreIcon></ExpandMoreIcon>\n            )\n          }\n          onClick={toggleCollapse}\n        >\n          {title}\n        </StyledButton>\n        <CollapseCollapseContainer\n          in={expanded}\n          id=\"expansion-panel-content\"\n          aria-hidden={!expanded}\n        >\n          <Grid container spacing={0}>\n            {this.renderChapters(activeDocument)}\n          </Grid>\n        </CollapseCollapseContainer>\n      </GridTableOfContents>\n    );\n  }\n}\n\nexport default TableOfContents;\n","export const splitAndTrimOnCommas = (searchString) => {\n  return searchString.split(\",\").map((string) => {\n    return string.trim();\n  });\n};\n\nexport const getStringArray = (searchString) => {\n  let tempStringArray = splitAndTrimOnCommas(searchString);\n  return tempStringArray.join(\" \").split(\" \");\n};\n\nexport const hasSubMenu = (item) => {\n  return item.menu && item.menu.length > 0;\n};\n\nexport const flattenChaptersTree = (chapters) => {\n  return chapters.reduce((acc, chapter) => {\n    if (chapter.header) {\n      let chapterStrippedFromSubChapters = { ...chapter };\n      chapterStrippedFromSubChapters.chapters = [];\n      acc = [...acc, chapterStrippedFromSubChapters];\n    }\n    if (chapter.chapters && chapter.chapters.length > 0) {\n      return [...acc, ...flattenChaptersTree(chapter.chapters)];\n    }\n    return acc;\n  }, []);\n};\n"],"names":["Contents","React","constructor","props","super","state","popupImage","activeContent","bindPrintSpecificHandlers","localObserver","model","this","unsubscribe","subscribe","documents","chapters","headerChapter","forEach","document","isGroupHeader","push","createGroupHeadingTag","title","id","chapter","appendComponentsToChapter","renderedChapters","flatChaptersTree","flattenChaptersTree","map","item","mustReplace","renderChapters","publish","componentDidMount","showPopupModal","componentWillUnmount","closePopupModal","setState","image","renderImageInModal","open","close","variant","isPrintMode","Array","isArray","renderChapter","renderHeadline","components","subChapter","getHeaderVariant","headerSize","level","parent","ref","scrollRef","sx","overflowWrap","header","render","activeDocument","style","display","maxWidth","internalIds","GridContainer","styled","Grid","maxHeight","overflowY","overflowX","userSelect","outline","ContentContainer","theme","paddingBottom","spacing","paddingLeft","paddingRight","TocGridWrapper","marginBottom","expandedTocOnStart","options","mapConfigSetting","tableOfContents","expanded","documentSetting","DocumentViewer","showScrollButton","showPrintWindow","expandedTableOfContents","setScrollButtonLimit","showScrollButtonLimit","scrollLimit","bindSubscriptions","async","delay","current","scrollIntoView","scrollToTop","onScroll","e","target","scrollTop","componentDidUpdate","prevProps","scroll","containerId","smooth","duration","selectAllText","range","createRange","selectNode","documentViewerRef","window","getSelection","removeAllRanges","addRange","toggleCollapse","getTocTitle","documentSettingTitle","mapConfigSettingTitle","getChapterLevelsToShowInToc","documentSettingLevels","chapterLevelsToShow","mapConfigSettingLevels","getShouldShowTableOfContents","active","getTableOfContents","documentWindowMaximized","showTableOfContents","container","xs","tabIndex","onKeyDown","ctrlKey","metaKey","keyCode","preventDefault","marginTop","color","documentColor","onClick","mapDiv","getElementById","blurCss","CloseButton","IconButton","position","backgroundColor","palette","grey","zIndex","right","top","StyledPaper","Paper","overflow","boxShadow","objectFit","PaperComponent","component","onClose","src","altValue","size","alt","ImagePopupModal","removeMapBlur","removeAttribute","addMapBlur","setAttribute","onBackdropClick","PaperProps","url","bottom","darken","visuallyHidden","NestedListItem","withTheme","button","dense","onCLick","paddingTop","children","ListRoot","List","width","padding","StyledButton","Button","justifyContent","action","selected","GridTableOfContents","mode","tapHighlightColor","cursor","CollapseCollapseContainer","Collapse","TableOfContents","linkClick","mainChapter","renderSubChapters","toString","showSubChapter","subChapterNumber","newLevel","number","disablePadding","concat","disableRipple","fullWidth","endIcon","in","defaultProps","splitAndTrimOnCommas","searchString","split","string","trim","getStringArray","join","hasSubMenu","menu","length","reduce","acc","chapterStrippedFromSubChapters"],"sourceRoot":""}