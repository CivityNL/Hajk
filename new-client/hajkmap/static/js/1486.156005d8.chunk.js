"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[1486],{11486:(e,t,s)=>{s.r(t);var a=s(66274),o=s(99359),r=s(10736),i=s(42468),g=(0,o.Z)("storageKey");t.default=class{constructor(e){Object.defineProperty(this,g,{writable:!0,value:void 0}),this.handleChangeCookieSettingsClick=()=>{this.globalObserver.publish("core.showCookieBanner")},this.map=e.map,this.app=e.app,this.globalObserver=e.app.globalObserver,this.bookmarks=this.readFromStorage()||{},(0,a.Z)(this,g)[g]=e.storageKey||"bookmarks"}getVisibleLayers(){return this.map.getLayers().getArray().filter((e=>e.getVisible()&&e.getProperties().name&&(0,r.isValidLayerId)(e.getProperties().name))).map((e=>e.getProperties().name)).join(",")}setVisibleLayers(e){let t=e.split(",");this.map.getLayers().getArray().filter((e=>e.getProperties().name&&(0,r.isValidLayerId)(e.getProperties().name))).forEach((e=>{e.setVisible(t.indexOf(e.getProperties().name)>-1)}))}getMapState(){const e=this.map.getView(),t=e.getCenter(),s={x:t[0],y:t[1],z:e.getZoom()};return{m:this.app.config.activeMap,l:this.getVisibleLayers(),...s}}setMapState(e){if(!e)return;e=this.getDecodedBookmark(e),this.setVisibleLayers(e.settings.l);let t=this.map.getView();t.setCenter([e.settings.x,e.settings.y]),t.setZoom(e.settings.z),e=null}readFromStorage(){if(localStorage.getItem("bookmarks_v1.0")){const e=JSON.parse(localStorage.getItem("bookmarks_v1.0")),t={};e.forEach((e=>{const s=this.getDecodedBookmark(e);if(!s)return;const o=s.settings.m||this.app.config.activeMap;try{i.default.setKeyName(o)}catch(l){console.log("An error occurred while trying to set the bookmarks in localStorage: ".concat(l))}const r=i.default.get((0,a.Z)(this,g)[g]||"bookmarks");t[o]=r||{},t[o][s.name]={settings:e.settings},i.default.set((0,a.Z)(this,g)[g]||"bookmarks",t[o])})),localStorage.removeItem("bookmarks_v1.0"),i.default.setKeyName(this.app.config.activeMap)}const e=i.default.get((0,a.Z)(this,g)[g]);this.bookmarks=e||{}}writeToStorage(){i.default.set((0,a.Z)(this,g)[g],this.bookmarks)}getDecodedBookmark(e){let t=null;return e&&(t={...e},t.settings=JSON.parse(atob(e.settings))),t}bookmarkWithNameExists(e){return Object.keys(this.bookmarks).includes(e)}replaceBookmark(e){e&&(e.settings=btoa(JSON.stringify(this.getMapState())),this.writeToStorage())}addBookmark(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bookmarkWithNameExists(e)&&t?this.replaceBookmark(this.bookmarks[e]):(this.bookmarks[e]={settings:btoa(JSON.stringify(this.getMapState()))},this.writeToStorage())}deleteBookmark(e){delete this.bookmarks[e],this.writeToStorage()}}}}]);
//# sourceMappingURL=1486.156005d8.chunk.js.map