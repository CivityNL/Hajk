"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[8412,8619,3151,3624,8574],{28619:(e,t,i)=>{i.r(t);var o=i(72791),s=i(66934),r=i(57621),a=i(93044),n=i(66647),l=i(9585),c=i(80184);const h=(0,s.ZP)(r.Z)((e=>{let{theme:t}=e;return{marginBottom:t.spacing(1),width:"210px",[t.breakpoints.down("sm")]:{boxShadow:"none",borderBottom:"1px solid #ccc",borderRadius:0,margin:0,width:"100%",justifyContent:"left"}}})),d=(0,s.ZP)(a.Z)((e=>{let{theme:t}=e;return{background:t.palette.text.primary}}));class p extends o.PureComponent{constructor(){super(...arguments),this.state={open:!1,text:""}}render(){const{abstract:e,icon:t,onClick:i,title:o}=this.props;return(0,c.jsx)(h,{onClick:i,children:(0,c.jsx)(n.Z,{children:(0,c.jsx)(l.Z,{avatar:(0,c.jsx)(d,{children:t}),title:o,subheader:e})})})}}p.defaultProps={abstract:"Beskrivning saknas",title:"Titel saknas"},t.default=p},73151:(e,t,i)=>{i.r(t);var o=i(72791),s=i(85286),r=i(54164),a=i(19538),n=i(45484),l=i(57064),c=i(49900),h=i(26191),d=i(28619),p=i(74599),u=i(80184);class m extends o.PureComponent{constructor(e){var t;super(e),t=this,this.handleButtonClick=e=>{this.showWindow({hideOtherPluginWindows:!0,runCallback:!0}),this.props.app.globalObserver.publish("core.onlyHideDrawerIfNeeded")},this.showWindow=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e.hideOtherPluginWindows||!0,o=e.runCallback||!0;if(t.props.app.activeTool=t.type,t.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:t.type,activeMap:t.props.app.config.activeMap}),t.props.app.pushPluginIntoHistory({type:t.type,icon:t.props.custom.icon,title:t.title,description:t.description}),!0===t.state.windowVisible)return null;!0===i&&t.props.app.onWindowOpen(t),t.setState({windowVisible:!0},(()=>{t.props.app.globalObserver.publish("core.pluginVisibilityChanged"),!0===o&&"function"===typeof t.props.custom.onWindowShow&&t.props.custom.onWindowShow()}))},this.closeWindow=()=>{this.type===this.props.app.activeTool&&(this.props.app.activeTool=void 0),this.setState({windowVisible:!1},(()=>{this.props.app.globalObserver.publish("core.pluginVisibilityChanged"),"function"===typeof this.props.custom.onWindowHide&&this.props.custom.onWindowHide()}))},this.type=e.type.toLowerCase()||void 0,this.description=e.options.description||e.custom.description;const i=!1===this.props.app.config.mapConfig.map.clean&&(s.isMobile?e.options.visibleAtStartMobile:e.options.visibleAtStart)||!1;i&&this.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:this.type,activeMap:this.props.app.config.activeMap}),this.state={title:e.options.title||e.custom.title||"Unnamed plugin",color:e.options.color||e.custom.color||null,windowVisible:i},this.title=e.options.title||e.custom.title||"Unnamed plugin",this.width=e.options.width||e.custom.width||400,this.height=e.options.height||e.custom.height||"auto",this.position=e.options.position||e.custom.position||"left",e.app.registerWindowPlugin(this);const o="".concat(this.type,".showWindow");e.app.globalObserver.subscribe(o,(e=>{this.showWindow(e)}));const r="".concat(this.type,".closeWindow");e.app.globalObserver.subscribe(r,(()=>{this.closeWindow()}))}componentDidUpdate(e){e.custom.title!==this.props.custom.title&&this.setState({title:this.props.custom.title}),e.custom.color!==this.props.custom.color&&this.setState({color:this.props.custom.color})}pluginIsWidget(e){return["left","right"].includes(e)}renderWindow(e){const{target:t}=this.props.options;return"function"===typeof(null===e||void 0===e?void 0:e.render)?e.render():(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(h.default,{globalObserver:this.props.app.globalObserver,title:this.state.title,color:this.state.color,onClose:this.closeWindow,open:this.state.windowVisible,onResize:this.props.custom.onResize,onMaximize:this.props.custom.onMaximize,onMinimize:this.props.custom.onMinimize,draggingEnabled:this.props.custom.draggingEnabled,customPanelHeaderButtons:this.props.custom.customPanelHeaderButtons,resizingEnabled:this.props.custom.resizingEnabled,scrollable:this.props.custom.scrollable,allowMaximizedWindow:this.props.custom.allowMaximizedWindow,disablePadding:this.props.custom.disablePadding,width:this.width,height:this.height,position:this.position,mode:"window",layerswitcherConfig:this.props.app.config.mapConfig.tools.find((e=>"layerswitcher"===e.type)),children:o.cloneElement(this.props.children,{windowVisible:this.state.windowVisible})}),"hidden"!==t&&this.renderDrawerButton(),this.pluginIsWidget(t)&&this.renderWidgetButton("".concat(t,"-column")),"control"===t&&this.renderControlButton()]})}renderDrawerButton(){return(0,r.createPortal)((0,u.jsx)(a.Z,{mdUp:this.pluginIsWidget(this.props.options.target)||"control"===this.props.options.target,children:(0,u.jsxs)(n.ZP,{button:!0,divider:!0,selected:this.state.windowVisible,onClick:this.handleButtonClick,children:[(0,u.jsx)(l.Z,{children:this.props.custom.icon}),(0,u.jsx)(c.Z,{primary:this.title})]})}),document.getElementById("plugin-buttons"))}renderWidgetButton(e){return(0,r.createPortal)((0,u.jsx)(a.Z,{mdDown:!0,children:(0,u.jsx)(d.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById(e))}renderControlButton(){return(0,r.createPortal)((0,u.jsx)(a.Z,{mdDown:!0,children:(0,u.jsx)(p.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById("plugin-control-buttons"))}render(){return!0!==this.props.app.config.mapConfig.map.clean&&this.renderWindow(this.props.custom)}}t.default=m},48412:(e,t,i)=>{i.r(t);var o=i(72791),s=i(73151),r=i(15776),a=i(85194),n=i.n(a),l=i(68574),c=i(73624),h=i(80184);class d extends o.Component{constructor(e){super(e),this.onWindowHide=()=>{this.collectorModel.reset(),this.collectorModel.observer.publish("abortInteraction")},this.app=e.app,this.options=e.options,this.form=this.options.form||[],this.serviceConfig=this.getLayerConfigById(this.options.serviceId),this.observer=new(n()),this.collectorModel=new c.default({map:e.map,app:e.app,observer:this.observer,globalObserver:this.app.globalObserver,options:{...e.options,serviceConfig:this.serviceConfig}})}getLayerConfigById(e){return this.app.config.layersConfig.find((t=>"edit"===t.type&&t.id===e))}render(){return(0,h.jsx)(s.default,{...this.props,type:"Collector",custom:{icon:(0,h.jsx)(r.Z,{}),title:"Tyck till",description:"Vi vill veta vad du tycker!",height:450,width:430,onWindowHide:this.onWindowHide},children:(0,h.jsx)(l.default,{onClose:this.onWindowHide,model:this.collectorModel,form:this.form,serviceConfig:this.serviceConfig,options:this.options})})}}t.default=d},73624:(e,t,i)=>{i.r(t);var o=i(63252),s=i(64665),r=i(66233),a=i(90927),n=i(5400),l=i(50315),c=i(18029),h=i(56957),d=i(95881),p=i(62652),u=i(9501),m=i(5426),g=i(28562),v=i(56134),f=i(50007),b=i.n(f),w=i(25806);t.default=class{constructor(e){var t;this.setFormValuesFromConfig=()=>{this.serviceConfig?this.formValues=this.serviceConfig.editableFields.reduce(((e,t)=>(e[t.name]=this.valueByDataType(t),e)),{}):this.formValues={}},this.app=e.app,this.map=e.map,this.observer=e.observer,this.globalObserver=e.globalObserver,this.activeServices=[e.options.serviceId],this.sources=[e.options.serviceConfig],this.vectorSource=void 0,this.layer=void 0,this.select=void 0,this.modify=void 0,this.key=void 0,this.editFeature=void 0,this.editSource=void 0,this.filty=!1,this.saving=!1,this.geometryName="geom",this.wkt=null!==(t=e.options.wkt)&&void 0!==t&&t,this.serviceConfig=e.options.serviceConfig,this.serviceConfig?(this.setFormValuesFromConfig(),this.setLayer(e.options.serviceConfig)):console.warn("Edit service is missing or not properly configured.")}valueByDataType(e){switch(e.dataType){case"date-time":return(new Date).getTime();case"int":case"number":return 0;case"string":return"flerval"===e.textType?e.values.map((e=>({checked:!1,value:e}))):"";default:return""}}write(e){var t=new o.Z,i=this.editSource.layers[0].split(":"),s=2===i.length?i[0]:"",r=2===i.length?i[1]:i[0],a={featureNS:this.editSource.uri,featurePrefix:s,featureType:r,hasZ:!1,version:"1.1.0",srsName:this.editSource.projection};return t.writeTransaction(e.inserts,e.updates,e.deletes,a)}refreshLayer(e){var t,i=this.map.getLayers().getArray().find((t=>{var i=!1;if(t.getSource().getParams){let o=t.getSource().getParams();if("object"===typeof o){let t=o.LAYERS.split(":"),s=e.split(":");2===t.length&&2===s.length&&(i=e===o.LAYERS),1===t.length&&(i=s[1]===o.LAYERS)}}return i}));i&&((t=i.getSource()).changed(),t.updateParams({time:Date.now()}),this.map.updateSize())}parseWFSTresponse(e){var t="string"!==typeof e?(new XMLSerializer).serializeToString(e):e;return(new(b())).xml2js(t)}transact(e,t){var i=this.write(e),o=new XMLSerializer,s=this.editSource,r=i?o.serializeToString(i):void 0;r&&!1===this.saving&&(this.saving=!0,(0,w.hfetch)(s.url,{method:"POST",body:r,credentials:"same-origin",headers:{"Content-Type":"text/xml"}}).then((e=>{this.saving=!1,e.text().then((e=>{this.refreshLayer(s.layers[0]),this.vectorSource.getFeatures().filter((e=>void 0!==e.modification)).forEach((e=>e.modification=void 0)),t(this.parseWFSTresponse(e))}))})).catch((e=>{this.saving=!1,e.text().then((e=>{t(e)}))})))}save(e){var t=this.vectorSource.getFeatures();const i={...this.formValues};Object.keys(i).forEach((e=>{Array.isArray(i[e])&&(i[e]=i[e].filter((e=>e.checked)).map((e=>e.value)).join(", "))})),0===t.length&&t.push(new p.Z),t.length>0&&(t[0].setProperties(i),this.transact({inserts:t},e))}getSelectStyle(e){return[new s.ZP({stroke:new r.Z({color:"rgba(0, 255, 255, 1)",width:3}),fill:new a.Z({color:"rgba(0, 0, 0, 0.5)"}),image:new n.Z({fill:new a.Z({color:"rgba(0, 0, 0, 0.5)"}),stroke:new r.Z({color:"rgba(0, 255, 255, 1)",width:2}),radius:3})}),new s.ZP({image:new l.Z({fill:new a.Z({color:"rgba(0, 0, 0, 0.2)"}),stroke:new r.Z({color:"rgba(0, 0, 0, 1)",width:2}),points:4,radius:8,angle:Math.PI/4}),geometry:e=>{var t=e.getGeometry()instanceof h.ZP?e.getGeometry().getCoordinates()[0]:e.getGeometry().getCoordinates();return new d.Z(t)}})]}getVectorStyle(e){return[new s.ZP({stroke:new r.Z({color:"rgba(255, 165, 20, 1)",width:3}),fill:new a.Z({color:"rgba(255, 165, 20, 0.5)"}),image:new c.Z({scale:.5,anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:"marker_x2.png"})})]}getHiddenStyle(e){return[new s.ZP({stroke:new r.Z({color:"rgba(0, 0, 0, 0)",width:0}),fill:new a.Z({color:"rgba(1, 2, 3, 0)"}),image:new n.Z({fill:new a.Z({color:"rgba(0, 0, 0, 0)"}),stroke:new r.Z({color:"rgba(0, 0, 0, 0)",width:0}),radius:0})})]}getSketchStyle(){return[new s.ZP({fill:new a.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new r.Z({color:"rgba(0, 0, 0, 0.5)",width:4}),image:new n.Z({radius:6,fill:new a.Z({color:"rgba(0, 0, 0, 0.5)"}),stroke:new r.Z({color:"rgba(255, 255, 255, 0.5)",width:2})})})]}refreshEditingLayer(){this.map.getLayers().getArray().filter((e=>e.getProperties().caption===this.editSource.caption)).forEach((e=>{if(e.getSource){let i=e.getSource();if(i.clear&&i.clear(),i.getParams){var t=i.getParams();t.t=(new Date).getMilliseconds(),i.updateParams(t)}i.changed&&i.changed()}}))}setLayer(e){this.source=e,this.filty=!0,this.vectorSource=new m.Z({strategy:g.$6,projection:this.source.projection}),this.layer=new u.Z({layerType:"system",zIndex:5e3,name:"pluginCollector",caption:"Collector layer",source:this.vectorSource,style:this.getVectorStyle()}),this.layer&&this.map.removeLayer(this.layer),this.map.addLayer(this.layer),this.editSource=this.source,this.editFeature=null,this.observer.publish("editSource",this.source),this.observer.publish("editFeature",null),this.observer.publish("layerChanged",this.layer)}activateAdd(e){this.draw=new v.ZP({source:this.vectorSource,style:this.getSketchStyle(),type:e,geometryName:this.geometryName}),this.draw.on("drawend",(e=>{this.wkt||this.vectorSource.clear(),e.feature.modification="added"})),this.map.addInteraction(this.draw),this.map.clickLock.add("collector")}activateInteraction(e,t){"add"===e&&this.activateAdd(t),"move"===e&&this.activateMove(),"modify"===e&&this.activateModify(),"remove"===e&&(this.map.clickLock.add("collector"),this.activateRemove()),this.map.snapHelper.add("collector")}deactivateInteraction(){this.map.snapHelper.delete("collector"),this.select&&this.map.removeInteraction(this.select),this.modify&&this.map.removeInteraction(this.modify),this.draw&&this.map.removeInteraction(this.draw),this.move&&this.map.removeInteraction(this.move),this.snap&&this.map.removeInteraction(this.snap),this.remove&&(this.remove=!1,this.map.clickLock.delete("collector"),this.map.un("singleclick",this.removeSelected))}reset(){this.vectorSource&&this.vectorSource.clear(),this.map.clickLock.delete("collector"),this.deactivateInteraction(),this.setFormValuesFromConfig(),this.observer.publish("reset")}deactivate(){this.reset(),this.observer.publish("editFeature",this.editFeature),this.observer.publish("editSource",this.editSource),this.observer.publish("deactivate")}getSources(){return this.sources.filter((e=>this.activeServices.some((t=>t===e.id))))}}},68574:(e,t,i)=>{i.r(t),i.d(t,{default:()=>n});var o=i(72791),s=i(31041),r=i(80184);class a extends o.Component{constructor(e){super(e),this.onClose=()=>{this.props.onClose()},this.state={},this.model=e.model}componentDidMount(){}render(){return(0,r.jsx)(s.default,{localObserver:this.props.localObserver,model:this.model,onClose:this.onClose,form:this.props.form,serviceConfig:this.props.serviceConfig,options:this.props.options})}}var n=a},15776:(e,t,i)=>{var o=i(64836);t.Z=void 0;var s=o(i(45649)),r=i(80184),a=(0,s.default)((0,r.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 14v-2.47l6.88-6.88c.2-.2.51-.2.71 0l1.77 1.77c.2.2.2.51 0 .71L8.47 14H6zm12 0h-7.5l2-2H18v2z"}),"RateReview");t.Z=a},66647:(e,t,i)=>{i.d(t,{Z:()=>w});var o=i(87462),s=i(63366),r=i(72791),a=i(28182),n=i(94419),l=i(31402),c=i(66934),h=i(75878),d=i(21217);function p(e){return(0,d.Z)("MuiCardActionArea",e)}var u=(0,h.Z)("MuiCardActionArea",["root","focusVisible","focusHighlight"]),m=i(50533),g=i(80184);const v=["children","className","focusVisibleClassName"],f=(0,c.ZP)(m.Z,{name:"MuiCardActionArea",slot:"Root",overridesResolver:(e,t)=>t.root})((e=>{let{theme:t}=e;return{display:"block",textAlign:"inherit",width:"100%",["&:hover .".concat(u.focusHighlight)]:{opacity:(t.vars||t).palette.action.hoverOpacity,"@media (hover: none)":{opacity:0}},["&.".concat(u.focusVisible," .").concat(u.focusHighlight)]:{opacity:(t.vars||t).palette.action.focusOpacity}}})),b=(0,c.ZP)("span",{name:"MuiCardActionArea",slot:"FocusHighlight",overridesResolver:(e,t)=>t.focusHighlight})((e=>{let{theme:t}=e;return{overflow:"hidden",pointerEvents:"none",position:"absolute",top:0,right:0,bottom:0,left:0,borderRadius:"inherit",opacity:0,backgroundColor:"currentcolor",transition:t.transitions.create("opacity",{duration:t.transitions.duration.short})}}));var w=r.forwardRef((function(e,t){const i=(0,l.Z)({props:e,name:"MuiCardActionArea"}),{children:r,className:c,focusVisibleClassName:h}=i,d=(0,s.Z)(i,v),u=i,m=(e=>{const{classes:t}=e;return(0,n.Z)({root:["root"],focusHighlight:["focusHighlight"]},p,t)})(u);return(0,g.jsxs)(f,(0,o.Z)({className:(0,a.default)(m.root,c),focusVisibleClassName:(0,a.default)(h,m.focusVisible),ref:t,ownerState:u},d,{children:[r,(0,g.jsx)(b,{className:m.focusHighlight,ownerState:u})]}))}))},9585:(e,t,i)=>{i.d(t,{Z:()=>Z});var o=i(63366),s=i(87462),r=i(72791),a=i(28182),n=i(94419),l=i(20890),c=i(31402),h=i(66934),d=i(75878),p=i(21217);function u(e){return(0,p.Z)("MuiCardHeader",e)}var m=(0,d.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),g=i(80184);const v=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],f=(0,h.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,s.Z)({["& .".concat(m.title)]:t.title,["& .".concat(m.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),b=(0,h.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),w=(0,h.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),y=(0,h.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"});var Z=r.forwardRef((function(e,t){const i=(0,c.Z)({props:e,name:"MuiCardHeader"}),{action:r,avatar:h,className:d,component:p="div",disableTypography:m=!1,subheader:Z,subheaderTypographyProps:C,title:S,titleTypographyProps:x}=i,k=(0,o.Z)(i,v),P=(0,s.Z)({},i,{component:p,disableTypography:m}),M=(e=>{const{classes:t}=e;return(0,n.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},u,t)})(P);let j=S;null==j||j.type===l.Z||m||(j=(0,g.jsx)(l.Z,(0,s.Z)({variant:h?"body2":"h5",className:M.title,component:"span",display:"block"},x,{children:j})));let H=Z;return null==H||H.type===l.Z||m||(H=(0,g.jsx)(l.Z,(0,s.Z)({variant:h?"body2":"body1",className:M.subheader,color:"text.secondary",component:"span",display:"block"},C,{children:H}))),(0,g.jsxs)(f,(0,s.Z)({className:(0,a.default)(M.root,d),as:p,ref:t,ownerState:P},k,{children:[h&&(0,g.jsx)(b,{className:M.avatar,ownerState:P,children:h}),(0,g.jsxs)(y,{className:M.content,ownerState:P,children:[j,H]}),r&&(0,g.jsx)(w,{className:M.action,ownerState:P,children:r})]}))}))},57621:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(87462),s=i(63366),r=i(72791),a=i(28182),n=i(94419),l=i(66934),c=i(31402),h=i(35527),d=i(75878),p=i(21217);function u(e){return(0,p.Z)("MuiCard",e)}(0,d.Z)("MuiCard",["root"]);var m=i(80184);const g=["className","raised"],v=(0,l.ZP)(h.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})((()=>({overflow:"hidden"})));var f=r.forwardRef((function(e,t){const i=(0,c.Z)({props:e,name:"MuiCard"}),{className:r,raised:l=!1}=i,h=(0,s.Z)(i,g),d=(0,o.Z)({},i,{raised:l}),p=(e=>{const{classes:t}=e;return(0,n.Z)({root:["root"]},u,t)})(d);return(0,m.jsx)(v,(0,o.Z)({className:(0,a.default)(p.root,r),elevation:l?8:void 0,ref:t,ownerState:d},h))}))}}]);
//# sourceMappingURL=8412.5adae6b6.chunk.js.map