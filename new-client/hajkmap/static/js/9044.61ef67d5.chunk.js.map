{"version":3,"file":"static/js/9044.61ef67d5.chunk.js","mappings":"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","sources":["plugins/LayerSwitcher/components/BreadCrumb.js","plugins/LayerSwitcher/components/BreadCrumbs.js"],"sourcesContent":["import React, { Component } from \"react\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport VisibilityIcon from \"@mui/icons-material/Visibility\";\nimport VisibilityOffIcon from \"@mui/icons-material/VisibilityOff\";\nimport LaunchIcon from \"@mui/icons-material/Launch\";\nimport { Button, IconButton, Grid, Typography, Paper } from \"@mui/material\";\nimport CallMadeIcon from \"@mui/icons-material/CallMade\";\nimport { styled } from \"@mui/material/styles\";\nimport Popover from \"@mui/material/Popover\";\n\nconst StyledPaper = styled(Paper)(({ theme }) => ({\n  marginRight: theme.spacing(0.5),\n  border: `${theme.spacing(0.1)} solid ${theme.palette.divider}`,\n}));\n\nconst ContentGridContainer = styled(Grid)(({ theme }) => ({\n  padding: theme.spacing(1),\n}));\n\nconst TitleGridContainer = styled(Grid)(({ theme }) => ({\n  paddingLeft: theme.spacing(0.5),\n}));\n\nconst LinkContainer = styled(\"div\")(({ theme }) => ({\n  padding: theme.spacing(0.5),\n}));\n\nclass BreadCrumb extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      hidden: props.layer.getOpacity() === 0,\n      anchorEl: null,\n      popoverOpen: false,\n    };\n    this.chapters = this.findChapters(\n      this.props.layer.get(\"name\"),\n      this.props.chapters\n    );\n  }\n\n  setHidden = (e) => {\n    var o = e.target.getOpacity();\n    this.setState({\n      hidden: o === 0,\n    });\n  };\n\n  componentDidMount() {\n    this.props.layer.on(\"change:opacity\", this.setHidden);\n  }\n\n  componentWillUnmount() {\n    this.props.layer.un(\"change:opacity\", this.setHidden);\n  }\n\n  setLayerOpacity = (layer) => (event) => {\n    this.setState(\n      {\n        hidden: !this.state.hidden,\n      },\n      () => {\n        layer.setOpacity(this.state.hidden ? 0 : 1);\n      }\n    );\n  };\n\n  setLayerVisibility = (layer) => (event) => {\n    if (layer.get(\"visible\")) {\n      layer.setOpacity(1);\n      this.props.app.globalObserver.publish(\"layerswitcher.hideLayer\", layer);\n    }\n    layer.set(\"visible\", !layer.get(\"visible\"));\n  };\n\n  isOverflow(el) {\n    if (!el) return false;\n    let original = el.scrollLeft++;\n    let overflow = el.scrollLeft-- > original;\n    return overflow;\n  }\n\n  findChapters(id, chapters) {\n    if (!chapters) {\n      return [];\n    }\n    return chapters.reduce((chaptersWithLayer, chapter) => {\n      if (Array.isArray(chapter.layers)) {\n        if (chapter.layers.some((layerId) => layerId === id)) {\n          chaptersWithLayer = [...chaptersWithLayer, chapter];\n        }\n        if (chapter.chapters.length > 0) {\n          chaptersWithLayer = [\n            ...chaptersWithLayer,\n            ...this.findChapters(id, chapter.chapters),\n          ];\n        }\n      }\n      return chaptersWithLayer;\n    }, []);\n  }\n\n  renderChapterLinks() {\n    if (this.chapters && this.chapters.length > 0) {\n      if (this.chapters.length > 0) {\n        return (\n          <LinkContainer>\n            {this.chapters.map((chapter, i) => {\n              return (\n                <div key={i}>\n                  <Button\n                    size=\"small\"\n                    onClick={() => {\n                      this.setState({\n                        popoverOpen: false,\n                      });\n                      this.openInformative(chapter);\n                    }}\n                  >\n                    {chapter.header}\n                    <CallMadeIcon />\n                  </Button>\n                </div>\n              );\n            })}\n          </LinkContainer>\n        );\n      } else {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  openInformative = (chapter) => {\n    const informativeWindow = this.props.app.windows.find(\n      (window) => window.type === \"informative\"\n    );\n    informativeWindow.props.custom.open(chapter);\n  };\n\n  handleClose = () => {\n    this.setState({\n      anchorEl: null,\n      popoverOpen: false,\n    });\n  };\n\n  renderChaptersPopover(target) {\n    this.setState({\n      anchorEl: target,\n      popoverOpen: true,\n    });\n  }\n\n  renderInformativeIcon() {\n    if (!this.props.chapters) {\n      return null;\n    }\n    if (this.chapters && this.chapters.length > 0) {\n      return (\n        <IconButton\n          size=\"small\"\n          onClick={(e) => {\n            this.chapters.length === 1\n              ? this.openInformative(this.chapters[0])\n              : this.renderChaptersPopover(e.target);\n          }}\n        >\n          <LaunchIcon />\n        </IconButton>\n      );\n    } else {\n      return null;\n    }\n  }\n\n  render() {\n    const { layer, title, type } = this.props;\n    const { hidden } = this.state;\n    return (\n      <StyledPaper square={type === \"flat\"} elevation={0}>\n        <ContentGridContainer\n          container\n          data-type=\"bread-crumb\"\n          justifyContent=\"space-between\"\n          alignItems=\"center\"\n        >\n          <Grid item>\n            <IconButton\n              size=\"small\"\n              onClick={this.setLayerOpacity(layer)}\n              aria-label=\"Visa/dölj lagret tillfälligt\"\n            >\n              {!hidden ? <VisibilityIcon /> : <VisibilityOffIcon />}\n            </IconButton>\n          </Grid>\n          {this.renderInformativeIcon()}\n          <TitleGridContainer item>\n            <Typography variant=\"body2\" noWrap>\n              {title}\n            </Typography>\n          </TitleGridContainer>\n          <Grid item>\n            <IconButton\n              size=\"small\"\n              onClick={this.setLayerVisibility(layer)}\n              aria-label=\"Verwijder de laag van de kaart\"\n            >\n              <CloseIcon />\n            </IconButton>\n          </Grid>\n        </ContentGridContainer>\n        <Popover\n          id=\"simple-popper\"\n          open={this.state.popoverOpen}\n          anchorEl={this.state.anchorEl}\n          onClose={this.handleClose}\n          anchorOrigin={{\n            vertical: \"top\",\n            horizontal: \"center\",\n          }}\n          transformOrigin={{\n            vertical: \"bottom\",\n            horizontal: \"center\",\n          }}\n        >\n          {this.renderChapterLinks()}\n        </Popover>\n      </StyledPaper>\n    );\n  }\n}\n\nexport default BreadCrumb;\n","import React, { Component } from \"react\";\nimport BreadCrumb from \"./BreadCrumb.js\";\nimport { styled } from \"@mui/material/styles\";\nimport { useTheme } from \"@mui/material\";\nimport { useMediaQuery } from \"@mui/material\";\nimport Grid from \"@mui/material/Grid\";\nimport Divider from \"@mui/material/Divider\";\nimport Typography from \"@mui/material/Typography\";\nimport Button from \"@mui/material/Button\";\nimport IconButton from \"@mui/material/IconButton\";\nimport AddCircleIcon from \"@mui/icons-material/AddCircle\";\nimport RemoveCircleIcon from \"@mui/icons-material/RemoveCircle\";\nimport VisibilityOffIcon from \"@mui/icons-material/VisibilityOff\";\nimport ScrollMenu from \"react-horizontal-scrolling-menu\";\n\n// A HOC that pipes isMobile to the children. See this as a proposed\n// solution. It is not pretty, but if we move this to a separate file\n// we could use this HOC instead of the isMobile helper function in ../../utils/.\n// TODO: Move to some /hooks folder\nconst withIsMobile = () => (WrappedComponent) => (props) => {\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down(\"sm\"));\n  return <WrappedComponent {...props} isMobile={isMobile} />;\n};\n\nconst MobileRoot = styled(\"div\")(({ theme }) => ({\n  background: theme.palette.background.paper,\n  boxShadow: theme.shadows[24],\n  left: 0,\n  bottom: 0,\n  right: 0,\n  width: \"auto\",\n  zIndex: 2,\n}));\n\nconst MobileHeader = styled(\"div\")(({ theme }) => ({\n  padding: `6px ${theme.spacing(2)}`,\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"space-between\",\n}));\n\nconst BreadCrumbsContainerMobile = styled(\"div\")(({ theme }) => ({\n  maxHeight: \"300px\",\n  overflow: \"auto\",\n  [theme.breakpoints.down(\"sm\")]: {\n    maxHeight: \"110px\",\n  },\n}));\n\nconst BreadCrumbsContainer = styled(\"div\")(() => ({\n  position: \"absolute\",\n  left: 0,\n  right: 0,\n  bottom: 0,\n  zIndex: 2,\n}));\n\nconst MobileBreadCrumbWrapper = styled(\"div\")(({ theme }) => ({\n  width: \"100%\",\n  paddingLeft: theme.spacing(0.5),\n  paddingBottom: theme.spacing(0.5),\n}));\n\nclass BreadCrumbs extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      chapters: null,\n      visibleLayers: [],\n      open: false,\n    };\n    this.timer = null; // Timer used to buffer layer-state updates\n    props.app.globalObserver.subscribe(\"informativeLoaded\", (chapters) => {\n      this.setState({\n        chapters: chapters,\n      });\n    });\n  }\n\n  #resetLayerBuffers = () => {\n    this.addedLayerBuffer = [];\n    this.removedLayerBuffer = [];\n  };\n\n  bindLayerEvents = (visibleLayers) => (layer) => {\n    if (layer.get(\"visible\")) {\n      visibleLayers.push(layer);\n    }\n\n    this.setState({\n      visibleLayers: visibleLayers,\n    });\n\n    this.addedLayerBuffer = [];\n    this.removedLayerBuffer = [];\n\n    layer.on(\"change:visible\", (e) => {\n      const changedLayer = e.target;\n      // Since many layers might be activated at the same time, we have to buffer the state update!\n      // First, make sure to clear eventual earlier timer.\n      clearTimeout(this.timer);\n      // Then we'll create a new one...\n      this.timer = setTimeout(() => {\n        // The layers that are supposed to be shown are the visible layers from earlier combined with\n        // the layers that has been activated recently...\n        const allLayers = [\n          ...this.state.visibleLayers,\n          ...this.addedLayerBuffer,\n        ];\n        // ... minus the layers that has been deactivated recently!\n        const visibleLayers = allLayers.filter((l) => {\n          return !this.removedLayerBuffer.some(\n            (removedLayer) => l === removedLayer\n          );\n        });\n        // Let's update the state with the currently visible layers!\n        this.setState({\n          visibleLayers: visibleLayers,\n        });\n        // Finally we have to make sure to reset the layer buffers.\n        this.#resetLayerBuffers();\n      }, 0);\n\n      if (this.props.model.clearing) {\n        this.setState({\n          visibleLayers: [],\n        });\n      } else {\n        if (changedLayer.get(\"visible\")) {\n          this.addedLayerBuffer.push(changedLayer);\n        } else {\n          this.removedLayerBuffer.push(changedLayer);\n        }\n      }\n    });\n  };\n\n  getVisibleLayers() {\n    return this.props.map\n      .getLayers()\n      .getArray()\n      .filter((layer) => {\n        return layer.getVisible();\n      });\n  }\n\n  clear = () => {\n    this.props.app.clear();\n  };\n\n  componentDidMount() {\n    var visibleLayers = [];\n    if (this.props.map) {\n      this.props.map\n        .getLayers()\n        .getArray()\n        .forEach(this.bindLayerEvents(visibleLayers));\n    }\n  }\n\n  // Returns all active layers except background layers\n  getBreadCrumbCompatibleLayers = () => {\n    return this.state.visibleLayers.filter((layer) =>\n      [\"layer\", \"group\"].includes(layer.get(\"layerType\"))\n    );\n  };\n\n  toggle = () => {\n    this.setState({\n      open: !this.state.open,\n    });\n  };\n\n  renderMobile(layers) {\n    const { open } = this.state;\n    return (\n      <MobileRoot>\n        <MobileHeader>\n          <Typography>Innehåll i kartan</Typography>\n          <IconButton onClick={this.toggle} size=\"small\">\n            {open ? <RemoveCircleIcon /> : <AddCircleIcon />}\n          </IconButton>\n        </MobileHeader>\n        {open && <Divider />}\n        {!open ? null : (\n          <BreadCrumbsContainerMobile>\n            {layers.length > 0 ? (\n              <Grid\n                container\n                item\n                xs={12}\n                justifyContent=\"center\"\n                sx={{ marginTop: 1, marginBottom: 1 }}\n              >\n                <Button variant=\"contained\" onClick={this.clear}>\n                  Verwijder alle inhoud\n                  <VisibilityOffIcon sx={{ marginLeft: 2 }} />\n                </Button>\n              </Grid>\n            ) : (\n              <Typography>\n                Använd sökfunktionen eller innehållsmenyn för att visa\n                information i kartan.\n              </Typography>\n            )}\n            {layers.map((layer, index) => (\n              <MobileBreadCrumbWrapper key={`${layer.get(\"caption\")}-${index}`}>\n                <BreadCrumb\n                  title={layer.get(\"caption\")}\n                  layer={layer}\n                  chapters={this.state.chapters}\n                  app={this.props.app}\n                />\n              </MobileBreadCrumbWrapper>\n            ))}\n          </BreadCrumbsContainerMobile>\n        )}\n      </MobileRoot>\n    );\n  }\n\n  renderDesktop(layers) {\n    const breadCrumbs = layers.map((layer, index) => (\n      <BreadCrumb\n        key={`${layer.get(\"caption\")}-${index}`}\n        title={layer.get(\"caption\")}\n        layer={layer}\n        chapters={this.state.chapters}\n        app={this.props.app}\n      />\n    ));\n    return (\n      <BreadCrumbsContainer>\n        <ScrollMenu ref=\"scrollMenu\" data={breadCrumbs} alignCenter={false} />\n      </BreadCrumbsContainer>\n    );\n  }\n\n  render() {\n    // We've never been mobile, huh?...\n    //const isMobile = this.state.width < 600;\n    const layers = this.getBreadCrumbCompatibleLayers();\n    if (this.props.isMobile) {\n      // We don't want to show the breadcrumbs-summary if there are no layers\n      return layers.length > 0 ? this.renderMobile(layers) : null;\n    } else {\n      return this.renderDesktop(layers);\n    }\n  }\n}\n\nexport default withIsMobile()(BreadCrumbs);\n"],"names":["StyledPaper","styled","Paper","theme","marginRight","spacing","border","palette","divider","ContentGridContainer","Grid","padding","TitleGridContainer","paddingLeft","LinkContainer","BreadCrumb","Component","constructor","props","super","setHidden","e","o","target","getOpacity","this","setState","hidden","setLayerOpacity","layer","event","state","setOpacity","setLayerVisibility","get","app","globalObserver","publish","set","openInformative","chapter","windows","find","window","type","custom","open","handleClose","anchorEl","popoverOpen","chapters","findChapters","componentDidMount","on","componentWillUnmount","un","isOverflow","el","original","scrollLeft","id","reduce","chaptersWithLayer","Array","isArray","layers","some","layerId","length","renderChapterLinks","map","i","size","onClick","header","renderChaptersPopover","renderInformativeIcon","render","title","square","elevation","container","justifyContent","alignItems","item","variant","noWrap","onClose","anchorOrigin","vertical","horizontal","transformOrigin","MobileRoot","background","paper","boxShadow","shadows","left","bottom","right","width","zIndex","MobileHeader","display","BreadCrumbsContainerMobile","maxHeight","overflow","breakpoints","down","BreadCrumbsContainer","position","MobileBreadCrumbWrapper","paddingBottom","WrappedComponent","BreadCrumbs","addedLayerBuffer","removedLayerBuffer","bindLayerEvents","visibleLayers","push","changedLayer","clearTimeout","timer","setTimeout","filter","l","removedLayer","model","clearing","clear","getBreadCrumbCompatibleLayers","includes","toggle","subscribe","getVisibleLayers","getLayers","getArray","getVisible","forEach","renderMobile","xs","sx","marginTop","marginBottom","marginLeft","index","renderDesktop","breadCrumbs","ref","data","alignCenter","isMobile","useTheme","useMediaQuery"],"sourceRoot":""}