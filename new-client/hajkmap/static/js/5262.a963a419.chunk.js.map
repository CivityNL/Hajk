{"version":3,"file":"static/js/5262.a963a419.chunk.js","mappings":"sSAgBe,SAASA,EAAT,GAIX,IAJyC,cAC3CC,EAD2C,UAE3CC,EAF2C,MAG3CC,GACC,EAGD,MAAOC,EAAOC,GAAYC,EAAAA,SAAe,CACvCC,gBAAiB,GACjBC,uBAAwB,GACxBC,mBAAoB,OAIhBC,EAAaJ,EAAAA,aAAkB,KACnCD,EAAS,CACPE,gBAAiB,GACjBC,uBAAwB,GACxBC,mBAAoB,MAHtB,GAKC,IAIGE,EAAwBL,EAAAA,aAAmBC,IAC/CF,GAAUD,IAAD,IAAiBA,EAAOG,qBAAjC,GACC,IAkBGK,EAAc,KAElBR,EAAMK,oBACJP,EAAUW,cAAcT,EAAMK,oBAEhCC,GAAY,EA+Cd,OAPAJ,EAAAA,WAAgB,KACdL,EAAca,UAAU,yBAA0BH,GAC3C,KACLV,EAAcc,YAAY,yBAA1B,IAED,CAACd,EAAeU,KAEZK,EAAAA,EAAAA,eACL,UAAC,IAAD,CACEC,KAAMb,EAAMG,gBAAgBW,OAAS,EACrCC,QAASP,EAETQ,YAAcC,IACZA,EAAEC,iBAAF,EALJ,WAQE,SAAC,IAAD,iDACA,SAAC,IAAD,WACE,SAAC,IAAD,CAAMC,GAAI,CAAEC,MAAO,OAAQC,UAAW,QAAtC,SACGrB,EAAMG,gBAAgBmB,KAAI,CAACC,EAASC,KACnC,SAAC,KAAD,CACEC,gBAAc,EAEdC,aAAc,IAjDAF,KAExB,MAAMG,EAAiB3B,EAAMG,gBAAgBqB,GAEvCI,EAAmB7B,EAAM8B,uBAAuBF,GAEtD7B,EAAUgC,WAAWF,EAAkB,CAAEG,QAAQ,IAEjD9B,EAAS,IACJD,EACHK,mBAAoBuB,GAFtB,EAyC8BI,CAAiBR,GACrCS,aAAc,KAjCxBjC,EAAMK,oBACJP,EAAUW,cAAcT,EAAMK,mBA4BxB,YAME,UAAC,IAAD,CACE6B,QAAS,IAtFYC,KAEjC,MAAMC,GACoD,IAAxDpC,EAAMI,uBAAuBiC,QAAQF,GACjCnC,EAAMI,uBAAuBkC,QAAQC,GAAMA,IAAMJ,IACjD,IAAInC,EAAMI,uBAAwB+B,GAExClC,GAAUD,IAAD,IACJA,EACHI,uBAAwBgC,KAF1B,EA+E2BI,CAA0BhB,GACzCiB,OAAK,EAFP,WAIE,SAAC,IAAD,WACE,SAAC,IAAD,CACEC,KAAK,QACLC,SAA0D,IAAjD3C,EAAMI,uBAAuBiC,QAAQb,GAC9CoB,UAAW,EACXC,eAAa,OAGjB,SAAC,IAAD,CAAcC,QAASvB,EAAQwB,cAhB5BvB,UAsBb,UAAC,IAAD,YACE,SAAC,IAAD,CACEwB,SAAkD,IAAxChD,EAAMI,uBAAuBU,OACvCoB,QAlFc,KACpBlC,EAAMI,uBAAuBkB,KAAKE,GACzB1B,EAAUmD,oBAAoBjD,EAAMG,gBAAgBqB,MAE7DlB,GAAY,EA4ER,iBAMA,SAAC,IAAD,CAAQ4B,QAAS1B,EAAjB,6BAGJ0C,SAASC,eAAe,OAE3B,C","sources":["plugins/Sketch/components/SelectFeaturesDialog.js"],"sourcesContent":["import React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport {\n  Button,\n  Checkbox,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  List,\n  ListItem,\n  ListItemButton,\n  ListItemIcon,\n  ListItemText,\n} from \"@mui/material\";\n\nexport default function SelectFeaturesDialog({\n  localObserver,\n  drawModel,\n  model,\n}) {\n  // Let's keep everything in one state here since all properties are\n  // changing at the same time (almost).\n  const [state, setState] = React.useState({\n    clickedFeatures: [],\n    selectedFeatureIndexes: [],\n    highlightedFeature: null,\n  });\n\n  // Resets the state back to init.\n  const resetState = React.useCallback(() => {\n    setState({\n      clickedFeatures: [],\n      selectedFeatureIndexes: [],\n      highlightedFeature: null,\n    });\n  }, []);\n\n  // Handles map-click-event from drawModel and updates the clickedFeatures\n  // with the payload.\n  const handleDrawSelectClick = React.useCallback((clickedFeatures) => {\n    setState((state) => ({ ...state, clickedFeatures }));\n  }, []);\n\n  // Handles selection of features in the dialog-list. If the feature-index is already\n  // selected, we remove it, otherwise we add it to the selection.\n  const handleFeatureSelectChange = (featureIndex) => {\n    // Create the new selected feature-indexes...\n    const newSelectedFeatureIndexes =\n      state.selectedFeatureIndexes.indexOf(featureIndex) !== -1\n        ? state.selectedFeatureIndexes.filter((i) => i !== featureIndex)\n        : [...state.selectedFeatureIndexes, featureIndex];\n    // ...and update the state\n    setState((state) => ({\n      ...state,\n      selectedFeatureIndexes: newSelectedFeatureIndexes,\n    }));\n  };\n\n  // Handles dialog abort, resets the state so that the dialog can close.\n  const handleAbort = () => {\n    // We have to remove the eventual highlighted feature when aborting...\n    state.highlightedFeature &&\n      drawModel.removeFeature(state.highlightedFeature);\n    // ...and reset the state.\n    resetState();\n  };\n\n  // Handles confirmation from the dialog. Let's the drawModel add the feature,\n  // and then the state is reset so that the dialog is closed.\n  const handleConfirm = () => {\n    state.selectedFeatureIndexes.map((index) => {\n      return drawModel.drawSelectedFeature(state.clickedFeatures[index]);\n    });\n    resetState();\n  };\n\n  // Handler for mouse-enter on list of clicked features. Creates a new\n  // feature (which is used to show where the clicked feature is in the map).\n  const handleMouseEnter = (index) => {\n    // Let's get the clicked feature we're currently hoovering.\n    const hoveredFeature = state.clickedFeatures[index];\n    // Then we can create a corresponding highlight-feature.\n    const highlightFeature = model.createHighlightFeature(hoveredFeature);\n    // We'll add the highlight-feature to the draw-layer...\n    drawModel.addFeature(highlightFeature, { silent: true });\n    // ...and update the state so that we can keep track of what we are highlighting.\n    setState({\n      ...state,\n      highlightedFeature: highlightFeature,\n    });\n  };\n\n  // Handler for mouse-leave on the list of clicked features. Removes the currently\n  // highlighted feature from the draw-layer.\n  const handleMouseLeave = () => {\n    state.highlightedFeature &&\n      drawModel.removeFeature(state.highlightedFeature);\n  };\n\n  // An effect that handles subscriptions (and un-subscriptions) to the observer-\n  // event fired from the drawModel when the user has clicked a feature with the\n  // \"select feature from map\"-tool active. The event will only be fired if there\n  // is more than one feature present at the location on which the user clicked.\n  // (If there's zero or one, the drawModel will take care of it).\n  React.useEffect(() => {\n    localObserver.subscribe(\"drawModel.select.click\", handleDrawSelectClick);\n    return () => {\n      localObserver.unsubscribe(\"drawModel.select.click\");\n    };\n  }, [localObserver, handleDrawSelectClick]);\n\n  return createPortal(\n    <Dialog\n      open={state.clickedFeatures.length > 1}\n      onClose={handleAbort}\n      // Must stop event-bubbling. Otherwise the parent element in react can be dragged etc.\n      onMouseDown={(e) => {\n        e.stopPropagation();\n      }}\n    >\n      <DialogTitle>VÃ¤lj de objekt du vill kopiera</DialogTitle>\n      <DialogContent>\n        <List sx={{ width: \"100%\", maxHeight: \"30vh\" }}>\n          {state.clickedFeatures.map((feature, index) => (\n            <ListItem\n              disableGutters\n              key={index}\n              onMouseEnter={() => handleMouseEnter(index)}\n              onMouseLeave={() => handleMouseLeave(index)}\n            >\n              <ListItemButton\n                onClick={() => handleFeatureSelectChange(index)}\n                dense\n              >\n                <ListItemIcon>\n                  <Checkbox\n                    edge=\"start\"\n                    checked={state.selectedFeatureIndexes.indexOf(index) !== -1}\n                    tabIndex={-1}\n                    disableRipple\n                  />\n                </ListItemIcon>\n                <ListItemText primary={feature.getId()} />\n              </ListItemButton>\n            </ListItem>\n          ))}\n        </List>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          disabled={state.selectedFeatureIndexes.length === 0}\n          onClick={handleConfirm}\n        >\n          OK\n        </Button>\n        <Button onClick={handleAbort}>Annuleren</Button>\n      </DialogActions>\n    </Dialog>,\n    document.getElementById(\"map\")\n  );\n}\n"],"names":["SelectFeaturesDialog","localObserver","drawModel","model","state","setState","React","clickedFeatures","selectedFeatureIndexes","highlightedFeature","resetState","handleDrawSelectClick","handleAbort","removeFeature","subscribe","unsubscribe","createPortal","open","length","onClose","onMouseDown","e","stopPropagation","sx","width","maxHeight","map","feature","index","disableGutters","onMouseEnter","hoveredFeature","highlightFeature","createHighlightFeature","addFeature","silent","handleMouseEnter","onMouseLeave","onClick","featureIndex","newSelectedFeatureIndexes","indexOf","filter","i","handleFeatureSelectChange","dense","edge","checked","tabIndex","disableRipple","primary","getId","disabled","drawSelectedFeature","document","getElementById"],"sourceRoot":""}