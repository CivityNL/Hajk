"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[9044],{3190:function(e,t,n){n.r(t);var r=n(93433),i=n(15671),a=n(43144),s=n(60136),o=n(29388),l=n(72791),c=n(29823),p=n(3746),u=n(20165),h=n(5536),d=n(56650),f=n(45953),v=n(61091),y=n(13811),g=n(4565),m=n(42618),b=n(76863),Z=n(4407),x=n(80184),j=(0,b.ZP)(d.Z)((function(e){var t=e.theme;return{marginRight:t.spacing(.5),border:"".concat(t.spacing(.1)," solid ").concat(t.palette.divider)}})),k=(0,b.ZP)(f.ZP)((function(e){return{padding:e.theme.spacing(1)}})),L=(0,b.ZP)(f.ZP)((function(e){return{paddingLeft:e.theme.spacing(.5)}})),C=(0,b.ZP)("div")((function(e){return{padding:e.theme.spacing(.5)}})),P=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).setHidden=function(e){var t=e.target.getOpacity();r.setState({hidden:0===t})},r.setLayerOpacity=function(e){return function(t){r.setState({hidden:!r.state.hidden},(function(){e.setOpacity(r.state.hidden?0:1)}))}},r.setLayerVisibility=function(e){return function(t){e.get("visible")&&(e.setOpacity(1),r.props.app.globalObserver.publish("layerswitcher.hideLayer",e)),e.set("visible",!e.get("visible"))}},r.openInformative=function(e){r.props.app.windows.find((function(e){return"informative"===e.type})).props.custom.open(e)},r.handleClose=function(){r.setState({anchorEl:null,popoverOpen:!1})},r.state={hidden:0===e.layer.getOpacity(),anchorEl:null,popoverOpen:!1},r.chapters=r.findChapters(r.props.layer.get("name"),r.props.chapters),r}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){this.props.layer.on("change:opacity",this.setHidden)}},{key:"componentWillUnmount",value:function(){this.props.layer.un("change:opacity",this.setHidden)}},{key:"isOverflow",value:function(e){if(!e)return!1;var t=e.scrollLeft++;return e.scrollLeft-- >t}},{key:"findChapters",value:function(e,t){var n=this;return t?t.reduce((function(t,i){return Array.isArray(i.layers)&&(i.layers.some((function(t){return t===e}))&&(t=[].concat((0,r.Z)(t),[i])),i.chapters.length>0&&(t=[].concat((0,r.Z)(t),(0,r.Z)(n.findChapters(e,i.chapters))))),t}),[]):[]}},{key:"renderChapterLinks",value:function(){var e=this;return this.chapters&&this.chapters.length>0&&this.chapters.length>0?(0,x.jsx)(C,{children:this.chapters.map((function(t,n){return(0,x.jsx)("div",{children:(0,x.jsxs)(v.Z,{size:"small",onClick:function(){e.setState({popoverOpen:!1}),e.openInformative(t)},children:[t.header,(0,x.jsx)(m.Z,{})]})},n)}))}):null}},{key:"renderChaptersPopover",value:function(e){this.setState({anchorEl:e,popoverOpen:!0})}},{key:"renderInformativeIcon",value:function(){var e=this;return this.props.chapters&&this.chapters&&this.chapters.length>0?(0,x.jsx)(y.Z,{size:"small",onClick:function(t){1===e.chapters.length?e.openInformative(e.chapters[0]):e.renderChaptersPopover(t.target)},children:(0,x.jsx)(h.Z,{})}):null}},{key:"render",value:function(){var e=this.props,t=e.layer,n=e.title,r=e.type,i=this.state.hidden;return(0,x.jsxs)(j,{square:"flat"===r,elevation:0,children:[(0,x.jsxs)(k,{container:!0,"data-type":"bread-crumb",justifyContent:"space-between",alignItems:"center",children:[(0,x.jsx)(f.ZP,{item:!0,children:(0,x.jsx)(y.Z,{size:"small",onClick:this.setLayerOpacity(t),"aria-label":"Visa/d\xf6lj lagret tillf\xe4lligt",children:i?(0,x.jsx)(u.Z,{}):(0,x.jsx)(p.Z,{})})}),this.renderInformativeIcon(),(0,x.jsx)(L,{item:!0,children:(0,x.jsx)(g.Z,{variant:"body2",noWrap:!0,children:n})}),(0,x.jsx)(f.ZP,{item:!0,children:(0,x.jsx)(y.Z,{size:"small",onClick:this.setLayerVisibility(t),"aria-label":"Ta bort lagret fr\xe5n kartan",children:(0,x.jsx)(c.Z,{})})})]}),(0,x.jsx)(Z.ZP,{id:"simple-popper",open:this.state.popoverOpen,anchorEl:this.state.anchorEl,onClose:this.handleClose,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:this.renderChapterLinks()})]})}}]),n}(l.Component);t.default=P},29044:function(e,t,n){n.r(t);var r,i=n(93433),a=n(15671),s=n(43144),o=n(60136),l=n(29388),c=n(4942),p=n(1413),u=n(72791),h=n(3190),d=n(76863),f=n(74142),v=n(52797),y=n(45953),g=n(81872),m=n(4565),b=n(61091),Z=n(13811),x=n(68439),j=n(19924),k=n(20165),L=n(67728),C=n.n(L),P=n(80184),O=(0,d.ZP)("div")((function(e){var t=e.theme;return{background:t.palette.background.paper,boxShadow:t.shadows[24],left:0,bottom:0,right:0,width:"auto",zIndex:2}})),w=(0,d.ZP)("div")((function(e){var t=e.theme;return{padding:"6px ".concat(t.spacing(2)),display:"flex",alignItems:"center",justifyContent:"space-between"}})),B=(0,d.ZP)("div")((function(e){var t=e.theme;return(0,c.Z)({maxHeight:"300px",overflow:"auto"},t.breakpoints.down("sm"),{maxHeight:"110px"})})),I=(0,d.ZP)("div")((function(){return{position:"absolute",left:0,right:0,bottom:0,zIndex:2}})),S=(0,d.ZP)("div")((function(e){var t=e.theme;return{width:"100%",paddingLeft:t.spacing(.5),paddingBottom:t.spacing(.5)}})),z=function(e){(0,o.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).bindLayerEvents=function(e){return function(t){t.get("visible")&&e.push(t),r.setState({visibleLayers:e}),r.addedLayerBuffer=[],r.removedLayerBuffer=[],t.on("change:visible",(function(e){var t=e.target;setTimeout((function(){var e=[].concat((0,i.Z)(r.state.visibleLayers),(0,i.Z)(r.addedLayerBuffer));e=e.filter((function(e){return!r.removedLayerBuffer.some((function(t){return e===t}))})),r.setState({visibleLayers:e}),r.addedLayerBuffer=[],r.removedLayerBuffer=[]}),0),r.props.model.clearing?r.setState({visibleLayers:[]}):t.get("visible")?r.addedLayerBuffer.push(t):r.removedLayerBuffer.push(t)}))}},r.clear=function(){r.props.app.clear()},r.getBreadCrumbCompatibleLayers=function(){return r.state.visibleLayers.filter((function(e){return["layer","group"].includes(e.get("layerType"))}))},r.toggle=function(){r.setState({open:!r.state.open})},r.state={chapters:null,visibleLayers:[],open:!1},e.app.globalObserver.subscribe("informativeLoaded",(function(e){r.setState({chapters:e})})),r}return(0,s.Z)(n,[{key:"getVisibleLayers",value:function(){return this.props.map.getLayers().getArray().filter((function(e){return e.getVisible()}))}},{key:"componentDidMount",value:function(){this.props.map&&this.props.map.getLayers().getArray().forEach(this.bindLayerEvents([]))}},{key:"renderMobile",value:function(e){var t=this,n=this.state.open;return(0,P.jsxs)(O,{children:[(0,P.jsxs)(w,{children:[(0,P.jsx)(m.Z,{children:"Inneh\xe5ll i kartan"}),(0,P.jsx)(Z.Z,{onClick:this.toggle,size:"small",children:n?(0,P.jsx)(j.Z,{}):(0,P.jsx)(x.Z,{})})]}),n&&(0,P.jsx)(g.Z,{}),n?(0,P.jsxs)(B,{children:[e.length>0?(0,P.jsx)(y.ZP,{container:!0,item:!0,xs:12,justifyContent:"center",sx:{marginTop:1,marginBottom:1},children:(0,P.jsxs)(b.Z,{variant:"contained",onClick:this.clear,children:["Ta bort allt inneh\xe5ll",(0,P.jsx)(k.Z,{sx:{marginLeft:2}})]})}):(0,P.jsx)(m.Z,{children:"Anv\xe4nd s\xf6kfunktionen eller inneh\xe5llsmenyn f\xf6r att visa information i kartan."}),e.map((function(e,n){return(0,P.jsx)(S,{children:(0,P.jsx)(h.default,{title:e.get("caption"),layer:e,chapters:t.state.chapters,app:t.props.app})},"".concat(e.get("caption"),"-").concat(n))}))]}):null]})}},{key:"renderDesktop",value:function(e){var t=this,n=e.map((function(e,n){return(0,P.jsx)(h.default,{title:e.get("caption"),layer:e,chapters:t.state.chapters,app:t.props.app},"".concat(e.get("caption"),"-").concat(n))}));return(0,P.jsx)(I,{children:(0,P.jsx)(C(),{ref:"scrollMenu",data:n,alignCenter:!1})})}},{key:"render",value:function(){var e=this.getBreadCrumbCompatibleLayers();return this.props.isMobile?e.length>0?this.renderMobile(e):null:this.renderDesktop(e)}}]),n}(u.Component);t.default=(r=z,function(e){var t=(0,f.Z)(),n=(0,v.Z)(t.breakpoints.down("sm"));return(0,P.jsx)(r,(0,p.Z)((0,p.Z)({},e),{},{isMobile:n}))})}}]);
//# sourceMappingURL=9044.d6ed1401.chunk.js.map