"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[6669],{28619:function(t,e,i){i.r(e);var n=i(15671),o=i(43144),r=i(60136),s=i(29388),a=i(4942),l=i(72791),c=i(76863),d=i(48928),u=i(73978),p=i(58487),h=i(16398),g=i(80184),v=(0,c.ZP)(d.Z)((function(t){var e=t.theme;return(0,a.Z)({marginBottom:e.spacing(1),width:"210px"},e.breakpoints.down("sm"),{boxShadow:"none",borderBottom:"1px solid #ccc",borderRadius:0,margin:0,width:"100%",justifyContent:"left"})})),b=(0,c.ZP)(u.Z)((function(t){return{background:t.theme.palette.text.primary}})),y=function(t){(0,r.Z)(i,t);var e=(0,s.Z)(i);function i(){var t;(0,n.Z)(this,i);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).state={open:!1,text:""},t}return(0,o.Z)(i,[{key:"render",value:function(){var t=this.props,e=t.abstract,i=t.icon,n=t.onClick,o=t.title;return(0,g.jsx)(v,{onClick:n,children:(0,g.jsx)(p.Z,{children:(0,g.jsx)(h.Z,{avatar:(0,g.jsx)(b,{children:i}),title:o,subheader:e})})})}}]),i}(l.PureComponent);y.defaultProps={abstract:"Beskrivning saknas",title:"Titel saknas"},e.default=y},73151:function(t,e,i){i.r(e);var n=i(15671),o=i(43144),r=i(97326),s=i(60136),a=i(29388),l=i(72791),c=i(85286),d=i(54164),u=i(66788),p=i(35110),h=i(65514),g=i(4346),v=i(26191),b=i(28619),y=i(74599),m=i(80184),w=function(t){(0,s.Z)(i,t);var e=(0,a.Z)(i);function i(t){var o;(0,n.Z)(this,i),(o=e.call(this,t)).handleButtonClick=function(t){o.showWindow({hideOtherPluginWindows:!0,runCallback:!0}),o.props.app.globalObserver.publish("core.onlyHideDrawerIfNeeded")},o.showWindow=function(t){var e=t.hideOtherPluginWindows||!0,i=t.runCallback||!0;if(o.props.app.activeTool=o.type,o.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:o.type,activeMap:o.props.app.config.activeMap}),!0===o.state.windowVisible)return null;!0===e&&o.props.app.onWindowOpen((0,r.Z)(o)),o.setState({windowVisible:!0},(function(){!0===i&&"function"===typeof o.props.custom.onWindowShow&&o.props.custom.onWindowShow()}))},o.closeWindow=function(){o.type===o.props.app.activeTool&&(o.props.app.activeTool=void 0),o.setState({windowVisible:!1},(function(){"function"===typeof o.props.custom.onWindowHide&&o.props.custom.onWindowHide()}))},o.type=t.type.toLowerCase()||void 0,o.description=t.options.description||t.custom.description;var s=!1===o.props.app.config.mapConfig.map.clean&&(c.isMobile?t.options.visibleAtStartMobile:t.options.visibleAtStart)||!1;s&&o.props.app.globalObserver.publish("analytics.trackEvent",{eventName:"pluginShown",pluginName:o.type,activeMap:o.props.app.config.activeMap}),o.state={title:t.options.title||t.custom.title||"Unnamed plugin",color:t.options.color||t.custom.color||null,windowVisible:s},o.title=t.options.title||t.custom.title||"Unnamed plugin",o.width=t.options.width||t.custom.width||400,o.height=t.options.height||t.custom.height||"auto",o.position=t.options.position||t.custom.position||"left",t.app.registerWindowPlugin((0,r.Z)(o));var a="".concat(o.type,".showWindow");t.app.globalObserver.subscribe(a,(function(t){o.showWindow(t)}));var l="".concat(o.type,".closeWindow");return t.app.globalObserver.subscribe(l,(function(){o.closeWindow()})),o}return(0,o.Z)(i,[{key:"componentDidUpdate",value:function(t){t.custom.title!==this.props.custom.title&&this.setState({title:this.props.custom.title}),t.custom.color!==this.props.custom.color&&this.setState({color:this.props.custom.color})}},{key:"pluginIsWidget",value:function(t){return["left","right"].includes(t)}},{key:"renderWindow",value:function(t){var e=this.props.options.target;return"function"===typeof(null===t||void 0===t?void 0:t.render)?t.render():(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(v.default,{globalObserver:this.props.app.globalObserver,title:this.state.title,color:this.state.color,onClose:this.closeWindow,open:this.state.windowVisible,onResize:this.props.custom.onResize,onMaximize:this.props.custom.onMaximize,onMinimize:this.props.custom.onMinimize,draggingEnabled:this.props.custom.draggingEnabled,customPanelHeaderButtons:this.props.custom.customPanelHeaderButtons,resizingEnabled:this.props.custom.resizingEnabled,scrollable:this.props.custom.scrollable,allowMaximizedWindow:this.props.custom.allowMaximizedWindow,disablePadding:this.props.custom.disablePadding,width:this.width,height:this.height,position:this.position,mode:"window",layerswitcherConfig:this.props.app.config.mapConfig.tools.find((function(t){return"layerswitcher"===t.type})),children:l.cloneElement(this.props.children,{windowVisible:this.state.windowVisible})}),("toolbar"===e||this.pluginIsWidget(e))&&this.renderDrawerButton(),this.pluginIsWidget(e)&&this.renderWidgetButton("".concat(e,"-column")),"control"===e&&this.renderControlButton()]})}},{key:"renderDrawerButton",value:function(){return(0,d.createPortal)((0,m.jsx)(u.Z,{mdUp:this.pluginIsWidget(this.props.options.target),children:(0,m.jsxs)(p.ZP,{button:!0,divider:!0,selected:this.state.windowVisible,onClick:this.handleButtonClick,children:[(0,m.jsx)(h.Z,{children:this.props.custom.icon}),(0,m.jsx)(g.Z,{primary:this.title})]})}),document.getElementById("plugin-buttons"))}},{key:"renderWidgetButton",value:function(t){return(0,d.createPortal)((0,m.jsx)(u.Z,{mdDown:!0,children:(0,m.jsx)(b.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description})}),document.getElementById(t))}},{key:"renderControlButton",value:function(){return(0,d.createPortal)((0,m.jsx)(y.default,{icon:this.props.custom.icon,onClick:this.handleButtonClick,title:this.title,abstract:this.description}),document.getElementById("plugin-control-buttons"))}},{key:"render",value:function(){return!0!==this.props.app.config.mapConfig.map.clean&&this.renderWindow(this.props.custom)}}]),i}(l.PureComponent);e.default=w},66669:function(t,e,i){i.r(e);var n=i(1413),o=i(15671),r=i(43144),s=i(60136),a=i(29388),l=i(72791),c=i(73151),d=i(13684),u=i(77646),p=i(13016),h=i(85194),g=i.n(h),v=i(80184),b=function(t){(0,s.Z)(i,t);var e=(0,a.Z)(i);function i(t){var n;return(0,o.Z)(this,i),(n=e.call(this,t)).localObserver=g()(),n.routingModel=new u.default({map:t.map,app:t.app,options:t.options,localObserver:n.localObserver}),n}return(0,r.Z)(i,[{key:"render",value:function(){return(0,v.jsx)(c.default,(0,n.Z)((0,n.Z)({},this.props),{},{type:"Routing",custom:{icon:(0,v.jsx)(d.Z,{}),title:"Navigation",description:"Hitta r\xe4tt v\xe4g till din destination",height:"auto",width:400},children:(0,v.jsx)(p.default,{model:this.routingModel,app:this.props.app,localObserver:this.localObserver})}))}}]),i}(l.PureComponent);e.default=b},77646:function(t,e,i){i.r(e);var n=i(15671),o=i(43144),r=i(64665),s=i(18029),a=i(90927),l=i(66233),c=i(5400),d=i(5426),u=i(34951),p=i(29409),h=i(62652),g=i(42708),v=i(67738),b=i(96603),y=function(){function t(e){var i=this;(0,n.Z)(this,t),this.setTravelMode=function(t){i.travelMode=i.googleMapsApi.DirectionsTravelMode.hasOwnProperty(t)?i.googleMapsApi.DirectionsTravelMode[t]:"WALKING",i.travelModeLabel=i.travelModeLabels[i.travelMode],i.localObserver.publish("doneWithStep",3)},this.getCurrentPositionSuccess=function(t){i.position={latitude:t.coords.latitude,longitude:t.coords.longitude},i.setPosition()},this.getCurrentPositionError=function(t){console.error(t)},this.setPosition=function(){if(i.layer_start.getSource().clear(),i.position.longitude&&i.position.latitude){var t=new p.Z([i.position.longitude,i.position.latitude]),e=(0,g.vs)(t.getCoordinates(),"EPSG:4326",i.olMap.getView().getProjection());t.setCoordinates(e);var n=new h.Z({geometry:t});n.setStyle(i.style_start),i.layer_start.getSource().addFeature(n),i.olMap.getView().setCenter(t.getCoordinates()),i.localObserver.publish("doneWithStep",1),i.localObserver.publish("startModeSelected","gps")}},this.getLocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(i.getCurrentPositionSuccess,i.getCurrentPositionError):window.alert("Kan inte f\xe5 position. Skriv startposition i rutan eller tryck position p\xe5 kartan.")},this.activateStartMode=function(){i.olMap.once("singleclick",i.startPointSelection)},this.startPointSelection=function(t){var e=new h.Z;e.setGeometry(new p.Z(t.coordinate));var n=(0,g.vs)(e.getGeometry().getCoordinates(),i.projection,"EPSG:4326"),o=n[0],r=n[1];i.layer_start.getSource().clear(),i.layer_start.getSource().addFeature(e),e.setStyle(i.style_start);var s=i.position;s.latitude=r,s.longitude=o,i.position=s,i.localObserver.publish("doneWithStep",1),i.localObserver.publish("startModeSelected","manual")},this.activateEndMode=function(){i.onEndKey=i.olMap.once("singleclick",i.endPointSelection)},this.endPointSelection=function(t){var e=new h.Z;e.setGeometry(new p.Z(t.coordinate));var n=(0,g.vs)(e.getGeometry().getCoordinates(),i.projection,"EPSG:4326"),o=n[0],r=n[1];i.layer_end.getSource().clear(),i.layer_end.getSource().addFeature(e),e.setStyle(i.style_end);var s=i.position;s.latitudeEnd=r,s.longitudeEnd=o,i.position=s,i.localObserver.publish("doneWithStep",2)},this.olMap=e.map,this.localObserver=e.localObserver,this.apiKey=e.options.apiKey,this.travelMode="WALKING",this.travelModeLabels={WALKING:"G\xe5",DRIVING:"K\xf6r",TRANSIT:"Kollektivtrafik",BICYCLING:"Cykla"},this.position={latitude:void 0,longitude:void 0,latitudeEnd:void 0,longitudeEnd:void 0},this.projection=e.app.config.mapConfig.map.projection,b({key:this.apiKey}).then((function(t){i.googleMapsApi=t})),this.initiateRoutingLayerInOpenLayersMap()}return(0,o.Z)(t,[{key:"generatePinIcon",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000000",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"24",i='<?xml version="1.0" encoding="UTF-8"?>\n    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"  width="'.concat(e,'" height="').concat(e,'" viewBox="0 0 ').concat(e," ").concat(e,'">\n    <path fill="').concat(t,'" d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z" />\n    </svg>');return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(i)}},{key:"initiateRoutingLayerInOpenLayersMap",value:function(){this.style_start=new r.ZP({image:new s.Z({src:this.generatePinIcon("#00a83b","36")})}),this.style_end=new r.ZP({image:new s.Z({src:this.generatePinIcon("#ff4747")})}),this.style_route=new r.ZP({image:new s.Z({src:this.generatePinIcon("#6e6e6e")})}),this.style_route_normal=this.style_route,this.style_route_highlight=new r.ZP({image:new s.Z({src:this.generatePinIcon("#47ff87")})}),this.layer_drawing_style=new r.ZP({fill:new a.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new l.Z({color:"rgba(0, 0, 255, 0.5)",width:4}),image:new c.Z({radius:6,fill:new a.Z({color:"rgba(0, 0, 0, 0.5)"}),stroke:new l.Z({color:"rgba(255, 255, 255, 0.5)",width:2})})});var t=new d.Z({}),e=new d.Z({}),i=new d.Z({}),n=new d.Z({});void 0===this.layer_start&&(this.layer_start=new u.Z({layerType:"system",zIndex:5e3,source:t,name:"pluginRoutingStart",content:"point",queryable:!1,style:this.style_start}),this.layer_end=new u.Z({layerType:"system",zIndex:5e3,source:e,name:"pluginRoutingEnd",content:"point",queryable:!1,style:this.style_end}),this.layer_route=new u.Z({layerType:"system",zIndex:5e3,source:i,name:"pluginRoutingRoute",content:"point",queryable:!0,style:this.style_route}),this.layer_drawing=new u.Z({layerType:"system",zIndex:5e3,source:n,name:"pluginRoutingDrawing",content:"line",queryable:!1,style:this.layer_drawing_style}),this.olMap.addLayer(this.layer_start),this.olMap.addLayer(this.layer_end),this.olMap.addLayer(this.layer_route),this.olMap.addLayer(this.layer_drawing))}},{key:"activateRoutingMode",value:function(){this.searchTrip()}},{key:"searchTrip",value:function(){var t=this,e=this.position;if(void 0===e.latitude||void 0===e.longitude||void 0===e.latitudeEnd||void 0===e.longitudeEnd)this.localObserver.publish("startStopPointsMissing");else{var i=new this.googleMapsApi.DirectionsService,n={origin:{lat:e.latitude,lng:e.longitude},destination:{lat:e.latitudeEnd,lng:e.longitudeEnd},travelMode:this.travelMode};i.route(n,(function(e){switch(e.status){case"REQUEST_DENIED":t.localObserver.publish("requestDenied");break;case"ZERO_RESULTS":t.localObserver.publish("zeroResults");break;case"OK":t.plotRoute(e,t.map,t.layer_route,t.layer_drawing);break;default:t.localObserver.publish("otherError",e.status)}}))}}},{key:"plotRoute",value:function(t,e,i,n){i.getSource().clear();var o=t.routes[0].legs[0].steps,r=document.createElement("div"),s=document.createElement("p"),a=document.createElement("ol");s.innerHTML='\n                    <table class="table table-condensed">\n                      <tbody>\n                        <tr><td><b>F\xe4rds\xe4tt</b></td><td>'.concat(this.travelModeLabel,"</td></tr>\n                        <tr><td><b>Avst\xe5nd</b></td><td>").concat(t.routes[0].legs[0].distance.text," (").concat(t.routes[0].legs[0].distance.value," m)</td></tr>\n                        <tr><td><b>Tid</b></td><td>").concat(t.routes[0].legs[0].duration.text,"</td></tr>\n                        <tr><td><b>Startadress</b></td><td>").concat(t.routes[0].legs[0].start_address,"</td></tr>\n                        <tr><td><b>Slutadress</b></td><td>").concat(t.routes[0].legs[0].end_address,"</td></tr>\n                      </tbody>\n                    </table>\n                    "),r.appendChild(s);for(var l=0;l<o.length;l++){var c=o[l].start_location.lat(),d=o[l].start_location.lng(),u=new p.Z([d,c]),b=(0,g.vs)(u.getCoordinates(),"EPSG:4326",this.projection);u.setCoordinates(b);var y=l+1,m=new h.Z({geometry:u,info:o[l].instructions});m.number=""+y,m.setStyle(this.style_route),i.getSource().addFeature(m);var w=document.createElement("li");w.onclick=this.highlightFeature.bind(this),w.id="step_number"+y,w.innerHTML=o[l].instructions,a.appendChild(w)}r.appendChild(a);for(var f=document.getElementById("resultList");f.firstChild;)f.removeChild(f.firstChild);document.getElementById("resultList").appendChild(r);var S=new v.ZP({}).readGeometry(t.routes[0].overview_polyline,{dataProjection:"EPSG:4326",featureProjection:this.projection});n.getSource().clear();var k=new h.Z({type:"routing",geometry:S});k.setStyle(this.layer_drawing_style),n.getSource().addFeature(k);var Z=(this.position.latitude+this.position.latitudeEnd)/2,M=(this.position.longitude+this.position.longitudeEnd)/2;this.olMap.getView().setCenter((0,g.vs)([M,Z],"EPSG:4326",this.projection)),this.olMap.getView().fit(n.getSource().getExtent(),this.olMap.getSize())}},{key:"highlightFeature",value:function(t){var e=-1;e="B"===t.target.nodeName?t.target.parentNode.id.substring("step_number".length):t.target.id.substring("step_number".length);for(var i=this.layer_route.getSource().getFeatures(),n=0;n<i.length;n++)i[n].number===e?i[n].setStyle(this.style_route_highlight):i[n].setStyle(this.style_route_normal)}},{key:"drawRoute",value:function(t){var e=new v.ZP({}).readGeometry(t),i=new h.Z({type:"routing",geometry:e});i.setStyle(this.style_route),this.get("layer_drawing").getSource().addFeature(i)}},{key:"clearMap",value:function(){this.layer_start.getSource().clear(),this.layer_end.getSource().clear(),this.layer_route.getSource().clear(),this.layer_drawing.getSource().clear(),document.getElementById("resultList").innerHTML="",this.position={latitude:void 0,longitude:void 0,latitudeEnd:void 0,longitudeEnd:void 0}}}]),t}();e.default=y},13016:function(t,e,i){i.r(e);var n=i(15671),o=i(43144),r=i(60136),s=i(29388),a=i(72791),l=i(61091),c=i(93118),d=i(65651),u=i(97985),p=i(13704),h=i(50228),g=i(16582),v=i(28854),b=i(30148),y=i(48235),m=i(35465),w=i(88945),f=i(57670),S=i(63939),k=i(12017),Z=i(98246),M=i(80184),x=function(t){(0,r.Z)(i,t);var e=(0,s.Z)(i);function i(t){var o;return(0,n.Z)(this,i),(o=e.call(this)).state={activeStep:0,startMode:void 0,endSelectionInProgress:!1,travelMode:void 0},o.selectStartSnackbar=void 0,o.selectEndSnackbar=void 0,o.handleTravelModeChange=function(t,e){o.setState({travelMode:e}),o.props.model.setTravelMode(e)},o.handleClickOnStartMode=function(t,e){switch(o.setState({startMode:void 0}),e){case"gps":o.props.model.getLocation();break;case"manual":o.selectStartSnackbar=o.props.enqueueSnackbar("Klicka i kartan f\xf6r att v\xe4lja startpunkt.",{variant:"info",persist:!0}),o.props.model.activateStartMode()}},o.handleClickOnEndSelection=function(){!0!==o.state.endSelectionInProgress&&o.setState({endSelectionInProgress:!0},(function(t){o.selectEndSnackbar=o.props.enqueueSnackbar("Klicka i kartan f\xf6r att v\xe4lja din destination.",{variant:"info",persist:!0}),o.props.model.activateEndMode()}))},t.localObserver.subscribe("doneWithStep",(function(e){switch(e){case 1:o.selectStartSnackbar&&t.closeSnackbar(o.selectStartSnackbar),o.handleClickOnEndSelection();break;case 2:o.selectEndSnackbar&&t.closeSnackbar(o.selectEndSnackbar),o.setState({endSelectionInProgress:!1});break;case 3:t.model.activateRoutingMode()}o.setState({activeStep:e})})),t.localObserver.subscribe("startModeSelected",(function(t){o.setState({startMode:t})})),t.localObserver.subscribe("startStopPointsMissing",(function(){o.props.enqueueSnackbar("V\xe4lj start- och stoppunkt f\xf6r att kunna navigera.",{variant:"error"})})),t.localObserver.subscribe("requestDenied",(function(){o.props.enqueueSnackbar("Kunde inte navigera. Kontakta systemadministrat\xf6r och p\xe5tala att giltig licens f\xf6r Google Maps API saknas.",{variant:"error"})})),t.localObserver.subscribe("zeroResults",(function(){o.props.enqueueSnackbar("Kunde inte hitta v\xe4gbeskrivning mellan valda punkter och f\xf6r det valda transportslaget. Prova att byta f\xe4rds\xe4tt och s\xf6k igen.",{variant:"warning"})})),t.localObserver.subscribe("otherError",(function(t){console.error(t),o.props.enqueueSnackbar("Ett fel har intr\xe4ffat. V\xe4nligen f\xf6rs\xf6k igen.",{variant:"warning"})})),o}return(0,o.Z)(i,[{key:"render",value:function(){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(c.Z,{activeStep:this.state.activeStep,orientation:"vertical",sx:{padding:2},children:[(0,M.jsxs)(d.Z,{children:[(0,M.jsx)(u.Z,{children:"V\xe4lj startpunkt"}),(0,M.jsx)(p.Z,{children:(0,M.jsxs)(b.Z,{value:this.state.startMode,exclusive:!0,onChange:this.handleClickOnStartMode,size:"small",children:[(0,M.jsx)(v.Z,{value:"gps",children:"Min position"},1),(0,M.jsx)(v.Z,{value:"manual",children:"V\xe4lj i kartan"},2)]})})]},"pickStart"),(0,M.jsxs)(d.Z,{children:[(0,M.jsx)(u.Z,{children:"V\xe4lj destination"}),(0,M.jsx)(p.Z,{children:(0,M.jsx)(l.Z,{variant:"contained",onClick:this.handleClickOnEndSelection,disabled:!0===this.state.endSelectionInProgress,children:"V\xe4lj i kartan"})})]},"pickEnd"),(0,M.jsxs)(d.Z,{children:[(0,M.jsx)(u.Z,{children:"V\xe4lj f\xe4rds\xe4tt"}),(0,M.jsx)(p.Z,{children:(0,M.jsxs)(b.Z,{value:this.state.travelMode,exclusive:!0,onChange:this.handleTravelModeChange,children:[(0,M.jsx)(v.Z,{value:"WALKING",children:(0,M.jsx)(y.Z,{})},1),(0,M.jsx)(v.Z,{value:"DRIVING",children:(0,M.jsx)(m.Z,{})},2),(0,M.jsx)(v.Z,{value:"TRANSIT",children:(0,M.jsx)(f.Z,{})},3),(0,M.jsx)(v.Z,{value:"BICYCLING",children:(0,M.jsx)(w.Z,{})},4)]})})]},"pickTravelMode")]}),this.renderStepperButtons(),(0,M.jsx)(h.Z,{id:"resultList",sx:{padding:2}})]})}},{key:"renderStepperButtons",value:function(){var t=this;return(0,M.jsxs)(g.Z,{fullWidth:!0,sx:{padding:2},children:[(0,M.jsx)(l.Z,{sx:{marginRight:1},variant:"contained",disabled:0===this.state.activeStep,startIcon:(0,M.jsx)(k.Z,{}),onClick:function(){t.setState({activeStep:t.state.activeStep-1})},children:"F\xf6reg\xe5ende"}),(0,M.jsx)(l.Z,{variant:"contained",startIcon:(0,M.jsx)(S.Z,{}),onClick:function(){t.setState({activeStep:0,startMode:void 0,travelMode:void 0}),t.props.model.clearMap()},children:"Nollst\xe4ll"})]})}}]),i}(a.PureComponent);e.default=(0,Z.RM)(x)}}]);
//# sourceMappingURL=6669.25aa6be5.chunk.js.map