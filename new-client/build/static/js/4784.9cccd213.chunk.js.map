{"version":3,"file":"static/js/4784.9cccd213.chunk.js","mappings":"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","sources":["plugins/DocumentHandler/documentWindow/Contents.js","plugins/DocumentHandler/documentWindow/ImagePopupModal.js","plugins/DocumentHandler/utils/helpers.js"],"sourcesContent":["import React from \"react\";\nimport Typography from \"@mui/material/Typography\";\nimport ImagePopupModal from \"./ImagePopupModal\";\nimport { flattenChaptersTree } from \"../utils/helpers\";\nimport { Box } from \"@mui/material\";\n\nclass Contents extends React.PureComponent {\n  state = {\n    popupImage: null,\n    activeContent: null,\n  };\n\n  constructor(props) {\n    super(props);\n    this.internalIds = [];\n  }\n\n  /* TODO...\n   * This should be refactored in some other way.\n   * right now we are \"creating\" components for printing here\n   * because we need to use the render in this component\n   */\n  bindPrintSpecificHandlers = () => {\n    const { localObserver, model } = this.props;\n    localObserver.unsubscribe(\"append-chapter-components\");\n\n    localObserver.subscribe(\"append-document-components\", (documents) => {\n      let chapters = [];\n      let headerChapter = [];\n\n      documents.forEach((document) => {\n        /*\n         * add an H1 tag for menu parents when printing.\n         * chapters if a group of documents has a parent document, the header of the parent\n         * is printed if any of the children are printed.\n         */\n        if (document.isGroupHeader) {\n          headerChapter.push(\n            this.createGroupHeadingTag(document.title, document.id)\n          );\n          chapters.push(headerChapter);\n          headerChapter = [];\n        } else {\n          document.chapters.forEach((chapter) => {\n            model.appendComponentsToChapter(chapter);\n          });\n\n          let renderedChapters = [];\n          let flatChaptersTree = flattenChaptersTree(document.chapters);\n          flatChaptersTree = flatChaptersTree.map((item) => {\n            if (item.mustReplace) {\n              let newItem = {};\n              item = newItem;\n            }\n            return item;\n          });\n\n          renderedChapters.push(this.renderChapters(flatChaptersTree, true));\n          chapters.push(renderedChapters);\n        }\n      });\n\n      localObserver.publish(\"chapter-components-appended\", chapters);\n    });\n  };\n\n  componentDidMount = () => {\n    const { localObserver } = this.props;\n    this.bindPrintSpecificHandlers();\n    localObserver.subscribe(\"image-popup\", this.showPopupModal);\n  };\n\n  componentWillUnmount = () => {\n    const { localObserver } = this.props;\n    localObserver.unsubscribe(\"chapter-components-appended\");\n  };\n\n  closePopupModal = () => {\n    this.setState({ popupImage: null });\n  };\n\n  showPopupModal = (image) => {\n    this.setState({ popupImage: image });\n  };\n\n  renderImageInModal = () => {\n    const { popupImage } = this.state;\n\n    return (\n      <ImagePopupModal\n        open={popupImage == null ? false : true}\n        close={this.closePopupModal}\n        image={popupImage}\n      ></ImagePopupModal>\n    );\n  };\n\n  createGroupHeadingTag = (title, id) => {\n    return (\n      <Typography key={id} data-type=\"chapter-header\" variant=\"h1\">\n        {title}\n      </Typography>\n    );\n  };\n\n  /**\n   * Renders the document with all it's chapters and sub chapters.\n   * @param {object} document The document that will be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapters = (chapters, isPrintMode) => {\n    return Array.isArray(chapters)\n      ? chapters.map((chapter) => this.renderChapter(chapter, isPrintMode))\n      : null;\n  };\n\n  /**\n   * Renders a chapter with a headline an a content.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderChapter = (chapter, isPrintMode) => {\n    return (\n      <React.Fragment key={chapter.id}>\n        {this.renderHeadline(chapter, isPrintMode)}\n        {chapter.components}\n        {Array.isArray(chapter.chapters)\n          ? chapter.chapters.map((subChapter) => this.renderChapter(subChapter))\n          : null}\n      </React.Fragment>\n    );\n  };\n\n  getHeaderVariant = (chapter, isPrintMode) => {\n    let headerSize = 2; //Chapters start with h2\n\n    //If we are printing, we have a flattened chapters tree, so use the chapter.level property to set the heading\n    //instead of cycling through the parent chapter objects.\n    if (isPrintMode) {\n      headerSize += chapter.level;\n      return `h${headerSize}`;\n    }\n    while (chapter.parent) {\n      headerSize++;\n      chapter = chapter.parent;\n    }\n    return `h${headerSize}`;\n  };\n\n  /**\n   * Render the headline of a chapter.\n   * @param {object} chapter The chapter to be rendered.\n   *\n   * @memberof Contents\n   */\n  renderHeadline = (chapter, isPrintMode) => {\n    return (\n      <>\n        <Typography\n          ref={chapter.scrollRef}\n          sx={{ overflowWrap: \"break-word\" }}\n          data-type=\"chapter-header\"\n          variant={this.getHeaderVariant(chapter, isPrintMode)}\n        >\n          {chapter.header}\n        </Typography>\n      </>\n    );\n  };\n\n  render = () => {\n    if (this.props.activeDocument) {\n      return (\n        <Box style={{ display: \"block\", maxWidth: \"100%\" }}>\n          {this.renderImageInModal()}\n          {this.renderChapters(this.props.activeDocument.chapters)}\n        </Box>\n      );\n    } else {\n      return null;\n    }\n  };\n}\n\nexport default Contents;\n","import React from \"react\";\nimport { styled } from \"@mui/material/styles\";\nimport IconButton from \"@mui/material/IconButton\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport Dialog from \"@mui/material/Dialog\";\nimport Paper from \"@mui/material/Paper\";\n\nconst mapDiv = document.getElementById(\"map\");\nconst blurCss = \"filter : blur(7px)\";\n\nconst CloseButton = styled(IconButton)(({ theme }) => ({\n  position: \"absolute\",\n  backgroundColor: theme.palette.grey[50],\n\n  \"&:hover\": {\n    backgroundColor: theme.palette.grey[400],\n  },\n\n  zIndex: 100,\n  right: theme.spacing(2),\n  top: theme.spacing(2),\n}));\n\nconst StyledPaper = styled(Paper)(() => ({\n  maxHeight: \"80%\",\n  maxWidth: \"90%\",\n  overflow: \"auto\",\n  backgroundColor: \"transparent\",\n  boxShadow: \"none\",\n  objectFit: \"contain\",\n}));\n\nfunction PaperComponent(props) {\n  const { component, onClose, src, altValue } = props;\n  return (\n    <>\n      <CloseButton size=\"small\" onClick={onClose}>\n        <CloseIcon />\n      </CloseButton>\n      <StyledPaper alt={altValue} component={component} src={src} />\n    </>\n  );\n}\n\nclass ImagePopupModal extends React.PureComponent {\n  removeMapBlur = () => {\n    mapDiv.removeAttribute(\"style\", blurCss);\n  };\n\n  addMapBlur = () => {\n    mapDiv.setAttribute(\"style\", blurCss);\n  };\n\n  componentWillUnmount = () => {\n    this.removeMapBlur();\n  };\n\n  componentDidMount = () => {};\n\n  render() {\n    const { open, close, image } = this.props;\n    open ? this.addMapBlur() : this.removeMapBlur();\n\n    return (\n      <Dialog\n        maxWidth=\"lg\"\n        onBackdropClick={close}\n        PaperComponent={PaperComponent}\n        PaperProps={{\n          component: \"img\",\n          onClose: close,\n          src: image?.url,\n          altValue: image?.altValue,\n        }}\n        open={open}\n      />\n    );\n  }\n}\n\nexport default ImagePopupModal;\n","export const splitAndTrimOnCommas = (searchString) => {\n  return searchString.split(\",\").map((string) => {\n    return string.trim();\n  });\n};\n\nexport const getStringArray = (searchString) => {\n  let tempStringArray = splitAndTrimOnCommas(searchString);\n  return tempStringArray.join(\" \").split(\" \");\n};\n\nexport const hasSubMenu = (item) => {\n  return item.menu && item.menu.length > 0;\n};\n\nexport const flattenChaptersTree = (chapters) => {\n  return chapters.reduce((acc, chapter) => {\n    if (chapter.header) {\n      let chapterStrippedFromSubChapters = { ...chapter };\n      chapterStrippedFromSubChapters.chapters = [];\n      acc = [...acc, chapterStrippedFromSubChapters];\n    }\n    if (chapter.chapters && chapter.chapters.length > 0) {\n      return [...acc, ...flattenChaptersTree(chapter.chapters)];\n    }\n    return acc;\n  }, []);\n};\n"],"names":["Contents","props","state","popupImage","activeContent","bindPrintSpecificHandlers","localObserver","model","unsubscribe","subscribe","documents","chapters","headerChapter","forEach","document","isGroupHeader","push","createGroupHeadingTag","title","id","chapter","appendComponentsToChapter","renderedChapters","flatChaptersTree","flattenChaptersTree","map","item","mustReplace","renderChapters","publish","componentDidMount","showPopupModal","componentWillUnmount","closePopupModal","setState","image","renderImageInModal","open","close","variant","isPrintMode","Array","isArray","renderChapter","renderHeadline","components","subChapter","getHeaderVariant","headerSize","level","parent","ref","scrollRef","sx","overflowWrap","header","render","activeDocument","style","display","maxWidth","internalIds","React","mapDiv","getElementById","blurCss","CloseButton","styled","IconButton","theme","position","backgroundColor","palette","grey","zIndex","right","spacing","top","StyledPaper","Paper","maxHeight","overflow","boxShadow","objectFit","PaperComponent","component","onClose","src","altValue","size","onClick","alt","ImagePopupModal","removeMapBlur","removeAttribute","addMapBlur","setAttribute","this","onBackdropClick","PaperProps","url","splitAndTrimOnCommas","searchString","split","string","trim","getStringArray","join","hasSubMenu","menu","length","reduce","acc","chapterStrippedFromSubChapters"],"sourceRoot":""}