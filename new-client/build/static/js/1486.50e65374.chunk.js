"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[1486],{11486:function(e,t,a){a.r(t);var i=a(1413),r=a(15671),s=a(43144),o=a(10736),n="bookmarks_v".concat("1.0"),k=function(){function e(t){(0,r.Z)(this,e),this.map=t.map,this.app=t.app,this.bookmarks=[],this.readFromStorage()}return(0,s.Z)(e,[{key:"getVisibleLayers",value:function(){return this.map.getLayers().getArray().filter((function(e){return e.getVisible()&&e.getProperties().name&&(0,o.isValidLayerId)(e.getProperties().name)})).map((function(e){return e.getProperties().name})).join(",")}},{key:"setVisibleLayers",value:function(e){var t=e.split(",");this.map.getLayers().getArray().filter((function(e){return e.getProperties().name&&(0,o.isValidLayerId)(e.getProperties().name)})).forEach((function(e){e.setVisible(t.indexOf(e.getProperties().name)>-1)}))}},{key:"getMapState",value:function(){var e=this.map.getView(),t=e.getCenter(),a={x:t[0],y:t[1],z:e.getZoom()};return(0,i.Z)({m:this.app.config.activeMap,l:this.getVisibleLayers()},a)}},{key:"setMapStateFromBookmarkIndex",value:function(e){var t=this.bookmarks[e];t&&this.setMapState(t)}},{key:"setMapState",value:function(e){if(e){var t=this.getDecodedBookmark(e);this.setVisibleLayers(t.settings.l);var a=this.map.getView();a.setCenter([t.settings.x,t.settings.y]),a.setZoom(t.settings.z),t=null}}},{key:"readFromStorage",value:function(){var e=localStorage.getItem(n);if(!e){localStorage.setItem(n,"[]"),e="[]"}this.bookmarks=JSON.parse(e)}},{key:"writeToStorage",value:function(){localStorage.setItem(n,JSON.stringify(this.bookmarks))}},{key:"getDecodedBookmark",value:function(e){var t=null;return e&&((t=(0,i.Z)({},e)).settings=JSON.parse(atob(e.settings))),t}},{key:"bookmarkWithNameExists",value:function(e){return this.bookmarks.find((function(t){return t.name===e}))}},{key:"replaceBookmark",value:function(e){e&&(e.settings=btoa(JSON.stringify(this.getMapState())),this.writeToStorage())}},{key:"addBookmark",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.bookmarkWithNameExists(e);if(a)return!0===t&&this.replaceBookmark(a),!1;var i=this.getMapState();return this.bookmarks.push({name:e,settings:btoa(JSON.stringify(i)),sortOrder:0,favorite:!1}),this.writeToStorage(),!0}},{key:"removeBookmark",value:function(e){var t=this.bookmarks.indexOf(e);t>-1&&(this.bookmarks.splice(t,1),this.writeToStorage())}}]),e}();t.default=k}}]);
//# sourceMappingURL=1486.50e65374.chunk.js.map