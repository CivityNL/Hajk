"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[8690],{79717:function(e,t,i){var r=i(97326),n=i(11752),a=i(61120),s=i(43144),o=i(15671),u=i(60136),l=i(29388),h=i(68789),d=i(96289),g=i(25326),c=i(5947),_=i(62652),f=i(66549),v=i(29409),y=i(55736),m=i(9369),p=i(23581),x=i(34951),C=i(5426),F=i(2177),S=i(37130),E=i(32024),Z=i(64665),k=i(37678),P=i(56957),b=i(42708),M=i(66006),w=[0,0,0,0],T=[],L="modifystart",A="modifyend",B=function(e){(0,u.Z)(i,e);var t=(0,l.Z)(i);function i(e,r,n){var a;return(0,o.Z)(this,i),(a=t.call(this,e)).features=r,a.mapBrowserEvent=n,a}return(0,s.Z)(i)}(g.ZP),G=function(e){(0,u.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n,a;if((0,o.Z)(this,i),(n=t.call(this,e)).on,n.once,n.un,n.boundHandleFeatureChange_=n.handleFeatureChange_.bind((0,r.Z)(n)),n.condition_=e.condition?e.condition:F.Xp,n.defaultDeleteCondition_=function(e){return(0,F.Ko)(e)&&(0,F.Kf)(e)},n.deleteCondition_=e.deleteCondition?e.deleteCondition:n.defaultDeleteCondition_,n.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:F.Bx,n.vertexFeature_=null,n.vertexSegments_=null,n.lastPixel_=[0,0],n.ignoreNextSingleClick_=!1,n.featuresBeingModified_=null,n.rBush_=new m.Z,n.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,n.snappedToVertex_=!1,n.changingFeature_=!1,n.dragSegments_=[],n.overlay_=new x.Z({source:new C.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:I(),updateWhileAnimating:!0,updateWhileInteracting:!0}),n.SEGMENT_WRITERS_={Point:n.writePointGeometry_.bind((0,r.Z)(n)),LineString:n.writeLineStringGeometry_.bind((0,r.Z)(n)),LinearRing:n.writeLineStringGeometry_.bind((0,r.Z)(n)),Polygon:n.writePolygonGeometry_.bind((0,r.Z)(n)),MultiPoint:n.writeMultiPointGeometry_.bind((0,r.Z)(n)),MultiLineString:n.writeMultiLineStringGeometry_.bind((0,r.Z)(n)),MultiPolygon:n.writeMultiPolygonGeometry_.bind((0,r.Z)(n)),Circle:n.writeCircleGeometry_.bind((0,r.Z)(n)),GeometryCollection:n.writeGeometryCollectionGeometry_.bind((0,r.Z)(n))},n.source_=null,n.hitDetection_=null,e.features?a=e.features:e.source&&(n.source_=e.source,a=new h.Z(n.source_.getFeatures()),n.source_.addEventListener(p.Z.ADDFEATURE,n.handleSourceAdd_.bind((0,r.Z)(n))),n.source_.addEventListener(p.Z.REMOVEFEATURE,n.handleSourceRemove_.bind((0,r.Z)(n)))),!a)throw new Error("The modify interaction requires features, a source or a layer");return e.hitDetection&&(n.hitDetection_=e.hitDetection),n.features_=a,n.features_.forEach(n.addFeature_.bind((0,r.Z)(n))),n.features_.addEventListener(d.Z.ADD,n.handleFeatureAdd_.bind((0,r.Z)(n))),n.features_.addEventListener(d.Z.REMOVE,n.handleFeatureRemove_.bind((0,r.Z)(n))),n.lastPointerEvent_=null,n.delta_=[0,0],n.snapToPointer_=void 0===e.snapToPointer?!n.hitDetection_:e.snapToPointer,n}return(0,s.Z)(i,[{key:"addFeature_",value:function(e){var t=e.getGeometry();if(t){var i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,r),e.addEventListener(c.Z.CHANGE,this.boundHandleFeatureChange_)}},{key:"willModifyFeatures_",value:function(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new h.Z;for(var i=this.featuresBeingModified_.getArray(),r=0,n=t.length;r<n;++r)for(var a=t[r],s=0,o=a.length;s<o;++s){var u=a[s].feature;u&&!i.includes(u)&&this.featuresBeingModified_.push(u)}0===this.featuresBeingModified_.getLength()?this.featuresBeingModified_=null:this.dispatchEvent(new B(L,this.featuresBeingModified_,e))}}},{key:"removeFeature_",value:function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(c.Z.CHANGE,this.boundHandleFeatureChange_)}},{key:"removeFeatureSegmentData_",value:function(e){var t=this.rBush_,i=[];t.forEach((function(t){e===t.feature&&i.push(t)}));for(var r=i.length-1;r>=0;--r){for(var n=i[r],a=this.dragSegments_.length-1;a>=0;--a)this.dragSegments_[a][0]===n&&this.dragSegments_.splice(a,1);t.remove(n)}}},{key:"setActive",value:function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,n.Z)((0,a.Z)(i.prototype),"setActive",this).call(this,e)}},{key:"setMap",value:function(e){this.overlay_.setMap(e),(0,n.Z)((0,a.Z)(i.prototype),"setMap",this).call(this,e)}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleSourceAdd_",value:function(e){e.feature&&this.features_.push(e.feature)}},{key:"handleSourceRemove_",value:function(e){e.feature&&this.features_.remove(e.feature)}},{key:"handleFeatureAdd_",value:function(e){this.addFeature_(e.element)}},{key:"handleFeatureChange_",value:function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}}},{key:"handleFeatureRemove_",value:function(e){this.removeFeature_(e.element)}},{key:"writePointGeometry_",value:function(e,t){var i=t.getCoordinates(),r={feature:e,geometry:t,segment:[i,i]};this.rBush_.insert(t.getExtent(),r)}},{key:"writeMultiPointGeometry_",value:function(e,t){for(var i=t.getCoordinates(),r=0,n=i.length;r<n;++r){var a=i[r],s={feature:e,geometry:t,depth:[r],index:r,segment:[a,a]};this.rBush_.insert(t.getExtent(),s)}}},{key:"writeLineStringGeometry_",value:function(e,t){for(var i=t.getCoordinates(),r=0,n=i.length-1;r<n;++r){var a=i.slice(r,r+2),s={feature:e,geometry:t,index:r,segment:a};this.rBush_.insert((0,S.boundingExtent)(a),s)}}},{key:"writeMultiLineStringGeometry_",value:function(e,t){for(var i=t.getCoordinates(),r=0,n=i.length;r<n;++r)for(var a=i[r],s=0,o=a.length-1;s<o;++s){var u=a.slice(s,s+2),l={feature:e,geometry:t,depth:[r],index:s,segment:u};this.rBush_.insert((0,S.boundingExtent)(u),l)}}},{key:"writePolygonGeometry_",value:function(e,t){for(var i=t.getCoordinates(),r=0,n=i.length;r<n;++r)for(var a=i[r],s=0,o=a.length-1;s<o;++s){var u=a.slice(s,s+2),l={feature:e,geometry:t,depth:[r],index:s,segment:u};this.rBush_.insert((0,S.boundingExtent)(u),l)}}},{key:"writeMultiPolygonGeometry_",value:function(e,t){for(var i=t.getCoordinates(),r=0,n=i.length;r<n;++r)for(var a=i[r],s=0,o=a.length;s<o;++s)for(var u=a[s],l=0,h=u.length-1;l<h;++l){var d=u.slice(l,l+2),g={feature:e,geometry:t,depth:[s,r],index:l,segment:d};this.rBush_.insert((0,S.boundingExtent)(d),g)}}},{key:"writeCircleGeometry_",value:function(e,t){var i=t.getCenter(),r={feature:e,geometry:t,index:0,segment:[i,i]},n={feature:e,geometry:t,index:1,segment:[i,i]},a=[r,n];r.featureSegments=a,n.featureSegments=a,this.rBush_.insert((0,S.createOrUpdateFromCoordinate)(i),r);var s=t,o=(0,b.Cs)();if(o&&this.getMap()){var u=this.getMap().getView().getProjection();s=s.clone().transform(o,u),s=(0,P.Bb)(s).transform(u,o)}this.rBush_.insert(s.getExtent(),n)}},{key:"writeGeometryCollectionGeometry_",value:function(e,t){for(var i=t.getGeometriesArray(),r=0;r<i.length;++r){var n=i[r];(0,this.SEGMENT_WRITERS_[n.getType()])(e,n)}}},{key:"createOrUpdateVertexFeature_",value:function(e,t,i){var r=this.vertexFeature_;r?r.getGeometry().setCoordinates(e):(r=new _.Z(new v.Z(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r));return r.set("features",t),r.set("geometries",i),r}},{key:"handleEvent",value:function(e){return!e.originalEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=f.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(t=!(e.type!=f.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==f.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),(0,n.Z)((0,a.Z)(i.prototype),"handleEvent",this).call(this,e)&&!t);var t}},{key:"handleDragEvent",value:function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_);for(var t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],r=[],n=0,a=this.dragSegments_.length;n<a;++n){var s=this.dragSegments_[n],o=s[0],u=o.feature;i.includes(u)||i.push(u);var l=o.geometry;r.includes(l)||r.push(l);for(var h=o.depth,d=void 0,g=o.segment,c=s[1];t.length<l.getStride();)t.push(g[c][t.length]);switch(l.getType()){case"Point":d=t,g[0]=t,g[1]=t;break;case"MultiPoint":(d=l.getCoordinates())[o.index]=t,g[0]=t,g[1]=t;break;case"LineString":(d=l.getCoordinates())[o.index+c]=t,g[c]=t;break;case"MultiLineString":case"Polygon":(d=l.getCoordinates())[h[0]][o.index+c]=t,g[c]=t;break;case"MultiPolygon":(d=l.getCoordinates())[h[1]][h[0]][o.index+c]=t,g[c]=t;break;case"Circle":if(g[0]=t,g[1]=t,0===o.index)this.changingFeature_=!0,l.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var _=e.map.getView().getProjection(),f=(0,E.TE)((0,b.Vs)(l.getCenter(),_),(0,b.Vs)(t,_)),v=(0,b.Cs)();if(v){var y=l.clone().transform(v,_);y.setRadius(f),f=y.transform(_,v).getRadius()}l.setRadius(f),this.changingFeature_=!1}}d&&this.setGeometryCoordinates_(l,d)}this.createOrUpdateVertexFeature_(t,i,r)}},{key:"handleDownEvent",value:function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.featuresBeingModified_=null;var i=this.vertexFeature_;if(i){var r=e.map.getView().getProjection(),n=[],a=i.getGeometry().getCoordinates(),s=(0,S.boundingExtent)([a]),o=this.rBush_.getInExtent(s),u={};o.sort(V);for(var l=0,h=o.length;l<h;++l){var d=o[l],g=d.segment,c=(0,M.sq)(d.geometry),_=d.depth;if(_&&(c+="-"+_.join("-")),u[c]||(u[c]=new Array(2)),"Circle"!==d.geometry.getType()||1!==d.index)if(!(0,E.fS)(g[0],a)||u[c][0])if(!(0,E.fS)(g[1],a)||u[c][1])(0,M.sq)(g)in this.vertexSegments_&&!u[c][0]&&!u[c][1]&&this.insertVertexCondition_(e)&&n.push(d);else{if(u[c][0]&&0===u[c][0].index){var f=d.geometry.getCoordinates();switch(d.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":f=f[_[1]];case"Polygon":if(d.index!==f[_[0]].length-2)continue}}this.dragSegments_.push([d,1]),u[c][1]=d}else this.dragSegments_.push([d,0]),u[c][0]=d;else{var v=D(t,d,r);(0,E.fS)(v,a)&&!u[c][0]&&(this.dragSegments_.push([d,0]),u[c][0]=d)}}n.length&&this.willModifyFeatures_(e,[n]);for(var y=n.length-1;y>=0;--y)this.insertVertex_(n[y],a)}return!!this.vertexFeature_}},{key:"handleUpEvent",value:function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var i=this.dragSegments_[t][0],r=i.geometry;if("Circle"===r.getType()){var n=r.getCenter(),a=i.featureSegments[0],s=i.featureSegments[1];a.segment[0]=n,a.segment[1]=n,s.segment[0]=n,s.segment[1]=n,this.rBush_.update((0,S.createOrUpdateFromCoordinate)(n),a);var o=r,u=(0,b.Cs)();if(u){var l=e.map.getView().getProjection();o=o.clone().transform(u,l),o=(0,P.Bb)(o).transform(l,u)}this.rBush_.update(o.getExtent(),s)}else this.rBush_.update((0,S.boundingExtent)(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new B(A,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}},{key:"handlePointerMove_",value:function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)}},{key:"handlePointerAtPixel_",value:function(e,t,i){var r,n,a=this,s=i||t.getCoordinateFromPixel(e),o=t.getView().getProjection();if(this.hitDetection_){var u="object"===typeof this.hitDetection_?function(e){return e===a.hitDetection_}:void 0;t.forEachFeatureAtPixel(e,(function(e,t,i){if("Point"===(i=i||e.getGeometry()).getType()&&a.features_.getArray().includes(e)){n=i;var s=i.getFlatCoordinates().slice(0,2);r=[{feature:e,geometry:i,segment:[s,s]}]}return!0}),{layerFilter:u})}if(!r){var l=(0,b.dY)((0,S.createOrUpdateFromCoordinate)(s,w),o),h=t.getView().getResolution()*this.pixelTolerance_,d=(0,b.Fj)((0,S.buffer)(l,h,w),o);r=this.rBush_.getInExtent(d)}if(r&&r.length>0){var g=r.sort((function(e,t){return R(s,e,o)-R(s,t,o)}))[0],c=g.segment,_=D(s,g,o),f=t.getPixelFromCoordinate(_),v=(0,E.TE)(e,f);if(n||v<=this.pixelTolerance_){var y={};if(y[(0,M.sq)(c)]=!0,this.snapToPointer_||(this.delta_[0]=_[0]-s[0],this.delta_[1]=_[1]-s[1]),"Circle"===g.geometry.getType()&&1===g.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(_,[g.feature],[g.geometry]);else{var m=t.getPixelFromCoordinate(c[0]),p=t.getPixelFromCoordinate(c[1]),x=(0,E.bI)(f,m),C=(0,E.bI)(f,p);v=Math.sqrt(Math.min(x,C)),this.snappedToVertex_=v<=this.pixelTolerance_,this.snappedToVertex_&&(_=x>C?c[1]:c[0]),this.createOrUpdateVertexFeature_(_,[g.feature],[g.geometry]);var F={};F[(0,M.sq)(g.geometry)]=!0;for(var Z=1,k=r.length;Z<k;++Z){var P=r[Z].segment;if(!((0,E.fS)(c[0],P[0])&&(0,E.fS)(c[1],P[1])||(0,E.fS)(c[0],P[1])&&(0,E.fS)(c[1],P[0])))break;var T=(0,M.sq)(r[Z].geometry);T in F||(F[T]=!0,y[(0,M.sq)(P)]=!0)}}return void(this.vertexSegments_=y)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}},{key:"insertVertex_",value:function(e,t){for(var i,r=e.segment,n=e.feature,a=e.geometry,s=e.depth,o=e.index;t.length<a.getStride();)t.push(0);switch(a.getType()){case"MultiLineString":case"Polygon":(i=a.getCoordinates())[s[0]].splice(o+1,0,t);break;case"MultiPolygon":(i=a.getCoordinates())[s[1]][s[0]].splice(o+1,0,t);break;case"LineString":(i=a.getCoordinates()).splice(o+1,0,t);break;default:return}this.setGeometryCoordinates_(a,i);var u=this.rBush_;u.remove(e),this.updateSegmentIndices_(a,o,s,1);var l={segment:[r[0],t],feature:n,geometry:a,depth:s,index:o};u.insert((0,S.boundingExtent)(l.segment),l),this.dragSegments_.push([l,1]);var h={segment:[t,r[1]],feature:n,geometry:a,depth:s,index:o+1};u.insert((0,S.boundingExtent)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0}},{key:"removePoint",value:function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=f.Z.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e,this.dragSegments_);var t=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new B(A,this.featuresBeingModified_,e)),this.featuresBeingModified_=null,t}return!1}},{key:"removeVertex_",value:function(){var e,t,i,r,n,a,s,o,u,l,h,d=this.dragSegments_,g={},c=!1;for(n=d.length-1;n>=0;--n)l=(i=d[n])[0],h=(0,M.sq)(l.feature),l.depth&&(h+="-"+l.depth.join("-")),h in g||(g[h]={}),0===i[1]?(g[h].right=l,g[h].index=l.index):1==i[1]&&(g[h].left=l,g[h].index=l.index+1);for(h in g){switch(u=g[h].right,s=g[h].left,(o=(a=g[h].index)-1)<0&&(o=0),e=t=(r=(l=void 0!==s?s:u).geometry).getCoordinates(),c=!1,r.getType()){case"MultiLineString":t[l.depth[0]].length>2&&(t[l.depth[0]].splice(a,1),c=!0);break;case"LineString":t.length>2&&(t.splice(a,1),c=!0);break;case"MultiPolygon":e=e[l.depth[1]];case"Polygon":(e=e[l.depth[0]]).length>4&&(a==e.length-1&&(a=0),e.splice(a,1),c=!0,0===a&&(e.pop(),e.push(e[0]),o=e.length-1))}if(c){this.setGeometryCoordinates_(r,t);var _=[];if(void 0!==s&&(this.rBush_.remove(s),_.push(s.segment[0])),void 0!==u&&(this.rBush_.remove(u),_.push(u.segment[1])),void 0!==s&&void 0!==u){var f={depth:l.depth,feature:l.feature,geometry:l.geometry,index:o,segment:_};this.rBush_.insert((0,S.boundingExtent)(f.segment),f)}this.updateSegmentIndices_(r,a,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),d.length=0}}return c}},{key:"setGeometryCoordinates_",value:function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}},{key:"updateSegmentIndices_",value:function(e,t,i,r){this.rBush_.forEachInExtent(e.getExtent(),(function(n){n.geometry===e&&(void 0===i||void 0===n.depth||(0,k.fS)(n.depth,i))&&n.index>t&&(n.index+=r)}))}}]),i}(y.Z);function V(e,t){return e.index-t.index}function R(e,t,i){var r=t.geometry;if("Circle"===r.getType()){var n=r;if(1===t.index){var a=(0,b.Cs)();a&&(n=n.clone().transform(a,i));var s=(0,E.bI)(n.getCenter(),(0,b.Vs)(e,i)),o=Math.sqrt(s)-n.getRadius();return o*o}}var u=(0,b.Vs)(e,i);return T[0]=(0,b.Vs)(t.segment[0],i),T[1]=(0,b.Vs)(t.segment[1],i),(0,E.Bs)(u,T)}function D(e,t,i){var r=t.geometry;if("Circle"===r.getType()&&1===t.index){var n=r,a=(0,b.Cs)();return a&&(n=n.clone().transform(a,i)),(0,b.lO)(n.getClosestPoint((0,b.Vs)(e,i)),i)}var s=(0,b.Vs)(e,i);return T[0]=(0,b.Vs)(t.segment[0],i),T[1]=(0,b.Vs)(t.segment[1],i),(0,b.lO)((0,E.oL)(s,T),i)}function I(){var e=(0,Z.Ly)();return function(t,i){return e.Point}}t.Z=G},489:function(e,t,i){var r=i(97326),n=i(11752),a=i(61120),s=i(43144),o=i(15671),u=i(60136),l=i(29388),h=i(68789),d=i(96289),g=i(25326),c=i(62652),_=i(68417),f=i(34951),v=i(96661),y=i(66841),m=i(64665),p=i(37678),x=i(66006),C=i(2177),F="select",S=function(e){(0,u.Z)(i,e);var t=(0,l.Z)(i);function i(e,r,n,a){var s;return(0,o.Z)(this,i),(s=t.call(this,e)).selected=r,s.deselected=n,s.mapBrowserEvent=a,s}return(0,s.Z)(i)}(g.ZP),E={},Z=function(e){(0,u.Z)(i,e);var t=(0,l.Z)(i);function i(e){var n,a;if((0,o.Z)(this,i),(n=t.call(this)).on,n.once,n.un,e=e||{},n.boundAddFeature_=n.addFeature_.bind((0,r.Z)(n)),n.boundRemoveFeature_=n.removeFeature_.bind((0,r.Z)(n)),n.condition_=e.condition?e.condition:C.Kf,n.addCondition_=e.addCondition?e.addCondition:C.Fi,n.removeCondition_=e.removeCondition?e.removeCondition:C.Fi,n.toggleCondition_=e.toggleCondition?e.toggleCondition:C.vY,n.multi_=!!e.multi&&e.multi,n.filter_=e.filter?e.filter:v.uX,n.hitTolerance_=e.hitTolerance?e.hitTolerance:0,n.style_=void 0!==e.style?e.style:function(){var e=(0,m.Ly)();return(0,p.l7)(e.Polygon,e.LineString),(0,p.l7)(e.GeometryCollection,e.LineString),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}(),n.features_=e.features||new h.Z,e.layers)if("function"===typeof e.layers)a=e.layers;else{var s=e.layers;a=function(e){return s.includes(e)}}else a=v.uX;return n.layerFilter_=a,n.featureLayerAssociation_={},n}return(0,s.Z)(i,[{key:"addFeatureLayerAssociation_",value:function(e,t){this.featureLayerAssociation_[(0,x.sq)(e)]=t}},{key:"getFeatures",value:function(){return this.features_}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"getLayer",value:function(e){return this.featureLayerAssociation_[(0,x.sq)(e)]}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),(0,n.Z)((0,a.Z)(i.prototype),"setMap",this).call(this,e),e?(this.features_.addEventListener(d.Z.ADD,this.boundAddFeature_),this.features_.addEventListener(d.Z.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(d.Z.ADD,this.boundAddFeature_),this.features_.removeEventListener(d.Z.REMOVE,this.boundRemoveFeature_))}},{key:"addFeature_",value:function(e){var t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){var i=this.getMap().getAllLayers().find((function(e){if(e instanceof f.Z&&e.getSource()&&e.getSource().hasFeature(t))return e}));i&&this.addFeatureLayerAssociation_(t,i)}}},{key:"removeFeature_",value:function(e){this.style_&&this.restorePreviousStyle_(e.element)}},{key:"getStyle",value:function(){return this.style_}},{key:"applySelectedStyle_",value:function(e){var t=(0,x.sq)(e);t in E||(E[t]=e.getStyle()),e.setStyle(this.style_)}},{key:"restorePreviousStyle_",value:function(e){for(var t=this.getMap().getInteractions().getArray(),r=t.length-1;r>=0;--r){var n=t[r];if(n!==this&&n instanceof i&&n.getStyle()&&-1!==n.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(n.getStyle())}var a=(0,x.sq)(e);e.setStyle(E[a]),delete E[a]}},{key:"removeFeatureLayerAssociation_",value:function(e){delete this.featureLayerAssociation_[(0,x.sq)(e)]}},{key:"handleEvent",value:function(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),i=this.removeCondition_(e),r=this.toggleCondition_(e),n=!t&&!i&&!r,a=e.map,s=this.getFeatures(),o=[],u=[];if(n){(0,y.Z)(this.featureLayerAssociation_),a.forEachFeatureAtPixel(e.pixel,function(e,t){if(e instanceof c.Z&&this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),u.push(e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=s.getLength()-1;l>=0;--l){var h=s.item(l),d=u.indexOf(h);d>-1?u.splice(d,1):(s.remove(h),o.push(h))}0!==u.length&&s.extend(u)}else{a.forEachFeatureAtPixel(e.pixel,function(e,n){if(e instanceof c.Z&&this.filter_(e,n))return!t&&!r||s.getArray().includes(e)?(i||r)&&s.getArray().includes(e)&&(o.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,n),u.push(e)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var g=o.length-1;g>=0;--g)s.remove(o[g]);s.extend(u)}return(u.length>0||o.length>0)&&this.dispatchEvent(new S(F,u,o,e)),!0}}]),i}(_.ZP);t.Z=Z},24673:function(e,t,i){var r=i(11752),n=i(61120),a=i(43144),s=i(15671),o=i(60136),u=i(29388),l=i(68789),h=i(25326),d=i(53803),g=i(55736),c=i(96661),_=i(2177),f="translatestart",v="translating",y="translateend",m=function(e){(0,o.Z)(i,e);var t=(0,u.Z)(i);function i(e,r,n,a,o){var u;return(0,s.Z)(this,i),(u=t.call(this,e)).features=r,u.coordinate=n,u.startCoordinate=a,u.mapBrowserEvent=o,u}return(0,a.Z)(i)}(h.ZP),p=function(e){(0,o.Z)(i,e);var t=(0,u.Z)(i);function i(e){var r,n;if((0,s.Z)(this,i),e=e||{},(r=t.call(this,e)).on,r.once,r.un,r.lastCoordinate_=null,r.startCoordinate_=null,r.features_=void 0!==e.features?e.features:null,e.layers&&!r.features_)if("function"===typeof e.layers)n=e.layers;else{var a=e.layers;n=function(e){return a.includes(e)}}else n=c.uX;return r.layerFilter_=n,r.filter_=e.filter&&!r.features_?e.filter:c.uX,r.hitTolerance_=e.hitTolerance?e.hitTolerance:0,r.condition_=e.condition?e.condition:_.Bx,r.lastFeature_=null,r.addChangeListener(d.Z.ACTIVE,r.handleActiveChanged_),r}return(0,a.Z)(i,[{key:"handleDownEvent",value:function(e){if(!e.originalEvent||!this.condition_(e))return!1;if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=e.coordinate,this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);var t=this.features_||new l.Z([this.lastFeature_]);return this.dispatchEvent(new m(f,t,e.coordinate,this.startCoordinate_,e)),!0}return!1}},{key:"handleUpEvent",value:function(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);var t=this.features_||new l.Z([this.lastFeature_]);return this.dispatchEvent(new m(y,t,e.coordinate,this.startCoordinate_,e)),this.startCoordinate_=null,!0}return!1}},{key:"handleDragEvent",value:function(e){if(this.lastCoordinate_){var t=e.coordinate,i=t[0]-this.lastCoordinate_[0],r=t[1]-this.lastCoordinate_[1],n=this.features_||new l.Z([this.lastFeature_]);n.forEach((function(e){var t=e.getGeometry();t.translate(i,r),e.setGeometry(t)})),this.lastCoordinate_=t,this.dispatchEvent(new m(v,n,t,this.startCoordinate_,e))}}},{key:"handleMoveEvent",value:function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")}},{key:"featuresAtPixel_",value:function(e,t){return t.forEachFeatureAtPixel(e,function(e,t){if(this.filter_(e,t)&&(!this.features_||this.features_.getArray().includes(e)))return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"setHitTolerance",value:function(e){this.hitTolerance_=e}},{key:"setMap",value:function(e){var t=this.getMap();(0,r.Z)((0,n.Z)(i.prototype),"setMap",this).call(this,e),this.updateState_(t)}},{key:"handleActiveChanged_",value:function(){this.updateState_(null)}},{key:"updateState_",value:function(e){var t=this.getMap(),i=this.getActive();t&&i||(t=t||e)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")}}]),i}(g.Z);t.Z=p}}]);
//# sourceMappingURL=8690.e13f8c57.chunk.js.map