"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[8702],{38702:function(e,t,r){r.r(t);var n=r(37762),i=r(15861),a=r(15671),c=r(43144),o=r(66274),u=r(99359),l=r(64687),f=r.n(l),s=r(64665),h=r(90927),g=r(66233),d=r(5400),p=r(5426),w=r(34951),y=r(60313),b=r(78550),Z=r(25806),k=(0,u.Z)("HT"),m=function(){function e(t){var r=this;(0,a.Z)(this,e),Object.defineProperty(this,k,{writable:!0,value:void 0}),this.activateSelecting=function(e){!0===e?(r.map.on("click",r.handleClick),r.map.clickLock.add("buffer")):(r.map.un("click",r.handleClick),r.map.clickLock.delete("buffer"))},this.handleClick=function(e){r.map.getFeaturesAtPixel(e.pixel,{layerFilter:function(e){var t=e.get("name");return"pluginBuffer"!==t&&"pluginBufferSelection"!==t}}).forEach((function(e){var t=e.clone();t.setStyle(),r.highlightSource.addFeature(t)})),r.map.getLayers().getArray().filter((function(e){return e.getVisible()})).filter((function(e){return e.layersInfo})).map(function(){var t=(0,i.Z)(f().mark((function t(n){var i,a,c,o,u,l,s;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=Object.values(n.layersInfo),a=i.filter((function(e){return!0===e.queryable})).map((function(e){return e.id})),void 0===e.coordinate){t.next=14;break}return c=r.map.getView(),o=n.getSource().getFeatureInfoUrl(e.coordinate,c.getResolution(),c.getProjection().getCode(),{INFO_FORMAT:"application/json",QUERY_LAYERS:a.join(",")}),t.next=8,(0,Z.hfetch)(o);case 8:return u=t.sent,t.next=11,u.json();case 11:l=t.sent,s=(new y.Z).readFeatures(l),r.highlightSource.addFeatures(s);case 14:t.next=18;break;case 16:t.prev=16,t.t0=t.catch(0);case 18:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}())},this.bufferFeatures=function(e){var t,i=[],a=(0,n.Z)(r.highlightSource.getFeatures());try{for(a.s();!(t=a.n()).done;){var c=t.value,u=(0,o.Z)(r,k)[k].getBuffered(c,e);i.push(u)}}catch(l){a.e(l)}finally{a.f()}r.bufferSource.addFeatures(i)},this.clear=function(){r.highlightSource.clear(),r.bufferSource.clear()},this.map=t.map,(0,o.Z)(this,k)[k]=new b.default({projection:t.map.getView().getProjection().getCode()}),this.highlightSource=new p.Z,this.highlightLayer=new w.Z({source:this.highlightSource,layerType:"system",zIndex:5e3,name:"pluginBufferSelection",caption:"Buffer selection layer",style:new s.ZP({fill:new h.Z({color:"rgba(255, 168, 231, 0.47)"}),stroke:new g.Z({color:"rgba(255, 168, 231, 1)",width:4}),image:new d.Z({radius:6,fill:new h.Z({color:"rgba(255, 168, 231, 0.47)"}),stroke:new g.Z({color:"rgba(255, 168, 231, 1)",width:1})})})}),this.bufferSource=new p.Z,this.bufferLayer=new w.Z({source:this.bufferSource,layerType:"system",zIndex:5e3,name:"pluginBuffer",caption:"Buffer layer",style:new s.ZP({fill:new h.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new g.Z({color:"rgba(75, 100, 115, 1.5)",width:4}),image:new d.Z({radius:6,fill:new h.Z({color:"rgba(255, 255, 255, 0.5)"}),stroke:new g.Z({color:"rgba(75, 100, 115, 1.5)",width:2})})})}),this.map.addLayer(this.highlightLayer),this.map.addLayer(this.bufferLayer)}return(0,c.Z)(e,[{key:"setActive",value:function(e){!1===e&&this.activateSelecting(!1)}}]),e}();t.default=m}}]);
//# sourceMappingURL=8702.81249f1c.chunk.js.map