"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[9565,2670],{69565:function(e,t,n){n.r(t);var i=n(15671),a=n(43144),o=n(64665),r=n(90927),s=n(66233),l=n(5400),u=n(69236),h=n(5426),d=n(34951),c=n(35844),g=n(56957),m=n(56134),p=n(42670),f=function(){function e(t){var n=this;(0,i.Z)(this,e),this.createStyle=function(e,t){var i="rgba(255, 255, 255, 0.3)",a="rgba(0, 0, 0, 0.5)";return[new o.ZP({fill:new r.Z({color:i}),stroke:new s.Z({color:a,width:3}),image:new l.Z({radius:5,stroke:new s.Z({color:a}),fill:new r.Z({color:i})}),text:new u.Z({textAlign:"center",textBaseline:"middle",font:"12pt sans-serif",fill:new r.Z({color:"#FFF"}),text:n.getLabelText(e),overflow:!0,stroke:new s.Z({color:a,width:3}),offsetX:0,offsetY:-10,rotation:0,scale:1})})]},this.clear=function(){n.source.clear(),n.measureTooltip.setPosition(void 0)},this.handleDrawStart=function(e){e.feature.getGeometry().on("change",(function(e){var t,i="",a=void 0;n.active&&(n.pointerPosition&&(t=n.pointerPosition.coordinate),e.target instanceof c.Z&&(i=n.formatLabel("length",e.target.getLength()),a=e.target.getLastCoordinate()),e.target instanceof g.ZP&&(i=n.formatLabel("area",e.target.getArea()),a=t||e.target.getFirstCoordinate()),n.measureTooltipElement.innerHTML=i,n.measureTooltip.setPosition(a))}))},this.handleDrawEnd=function(e){n.setFeaturePropertiesFromGeometry(e.feature),n.measureTooltip.setPosition(void 0)},this.eventHandler=function(e){"Escape"===e.key&&n.draw.finishDrawing()},this.map=t.map,this.app=t.app,this.localObserver=t.localObserver,this.source=new h.Z,this.vector=new d.Z({layerType:"system",zIndex:5e3,name:"pluginMeasure",caption:"Measure layer",source:this.source,style:this.createStyle}),this.map.addLayer(this.vector),this.type="LineString",this.createMeasureTooltip()}return(0,a.Z)(e,[{key:"setType",value:function(e){this.type=e,this.removeInteraction(),this.addInteraction()}},{key:"getType",value:function(){return this.type}},{key:"setFeaturePropertiesFromGeometry",value:function(e){if(e){var t,n,i=0,a=0,o=0,r={n:0,e:0};switch(n=(t=e.getGeometry()).getType()){case"Point":r={n:Math.round(t.getCoordinates()[1]),e:Math.round(t.getCoordinates()[0])};break;case"LineString":i=t.getLength()<1e3?Math.round(10*t.getLength())/10:Math.round(t.getLength());break;case"Polygon":o=Math.round(t.getArea());break;case"Circle":a=Math.round(t.getRadius())}e.setProperties({type:n,length:i,area:o,radius:a,position:r})}}},{key:"formatLabel",value:function(e,t){var n;if("point"===e&&(n="Nord: "+t.n+" \xd6st: "+t.e),"number"===typeof t&&(t="length"===e&&t<1e3?Math.round(10*t)/10:Math.round(t)),"circle"===e){var i=" m";t>=1e3&&(i=" km",t/=1e3),n="R = "+Number(t).toLocaleString()+i+" \nA = "+(Math.round(t*t*Math.PI*1e3)/1e3).toLocaleString()+" m\xb2"}if("area"===e&&(n=t>1e5?Number(Math.round(t/1e6*100)/100).toLocaleString()+" km\xb2":Number(Math.round(100*t)/100).toLocaleString()+" m\xb2"),"length"===e){var a=" m";t>=1e3&&(a=" km",t/=1e3),n=Number(t).toLocaleString()+a}return n}},{key:"createMeasureTooltip",value:function(){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="tooltip-draw tooltip-measure",this.measureTooltip=new p.Z({element:this.measureTooltipElement,offset:[0,-15],positioning:"bottom-center"}),this.map.addOverlay(this.measureTooltip)}},{key:"getLabelText",value:function(e){var t=e.getProperties();switch(e.getProperties().type){case"Point":return this.formatLabel("point",t.position);case"LineString":return this.formatLabel("length",t.length);case"Circle":return this.formatLabel("circle",t.radius);case"Polygon":return this.formatLabel("area",t.area);default:return""}}},{key:"addInteraction",value:function(){this.draw=new m.ZP({source:this.source,type:this.type,style:new o.ZP({fill:new r.Z({color:"rgba(255, 255, 255, 0.2)"}),stroke:new s.Z({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new l.Z({radius:5,stroke:new s.Z({color:"rgba(0, 0, 0, 0.7)"}),fill:new r.Z({color:"rgba(255, 255, 255, 0.2)"})})})}),this.draw.on("drawstart",this.handleDrawStart),this.draw.on("drawend",this.handleDrawEnd),this.map.addInteraction(this.draw),this.map.snapHelper.add("measure")}},{key:"removeInteraction",value:function(){this.measureTooltip.setPosition(void 0),this.map.snapHelper.delete("measure"),this.map.removeInteraction(this.draw)}},{key:"setActive",value:function(e){e&&!this.active&&(document.addEventListener("keydown",this.eventHandler),this.addInteraction(),this.map.clickLock.add("measure")),!1===e&&(document.removeEventListener("keydown",this.eventHandler),this.removeInteraction(),this.map.clickLock.delete("measure")),this.active=e}},{key:"getMap",value:function(){return this.map}}]),e}();t.default=f},42670:function(e,t,n){var i=n(15671),a=n(43144),o=n(60136),r=n(29388),s=n(45957),l=n(5989),u=n(99148),h=n(37130),d=n(30923),c=n(1408),g="element",m="map",p="offset",f="position",v="positioning",y=function(e){(0,o.Z)(n,e);var t=(0,r.Z)(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this)).on,a.once,a.un,a.options=e,a.id=e.id,a.insertFirst=void 0===e.insertFirst||e.insertFirst,a.stopEvent=void 0===e.stopEvent||e.stopEvent,a.element=document.createElement("div"),a.element.className=void 0!==e.className?e.className:"ol-overlay-container "+u.$A,a.element.style.position="absolute",a.element.style.pointerEvents="auto",a.autoPan=!0===e.autoPan?{}:e.autoPan||void 0,a.rendered={transform_:"",visible:!0},a.mapPostrenderListenerKey=null,a.addChangeListener(g,a.handleElementChanged),a.addChangeListener(m,a.handleMapChanged),a.addChangeListener(p,a.handleOffsetChanged),a.addChangeListener(f,a.handlePositionChanged),a.addChangeListener(v,a.handlePositioningChanged),void 0!==e.element&&a.setElement(e.element),a.setOffset(void 0!==e.offset?e.offset:[0,0]),a.setPositioning(e.positioning||"top-left"),void 0!==e.position&&a.setPosition(e.position),a}return(0,a.Z)(n,[{key:"getElement",value:function(){return this.get(g)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(m)||null}},{key:"getOffset",value:function(){return this.get(p)}},{key:"getPosition",value:function(){return this.get(f)}},{key:"getPositioning",value:function(){return this.get(v)}},{key:"handleElementChanged",value:function(){(0,c.ep)(this.element);var e=this.getElement();e&&this.element.appendChild(e)}},{key:"handleMapChanged",value:function(){this.mapPostrenderListenerKey&&((0,c.ZF)(this.element),(0,d.bN)(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var e=this.getMap();if(e){this.mapPostrenderListenerKey=(0,d.oL)(e,l.Z.POSTRENDER,this.render,this),this.updatePixelPosition();var t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(e){this.set(g,e)}},{key:"setMap",value:function(e){this.set(m,e)}},{key:"setOffset",value:function(e){this.set(p,e)}},{key:"setPosition",value:function(e){this.set(f,e)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(e){var t=this.getMap();if(t&&t.getTargetElement()&&this.get(f)){var n=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),a=this.getRect(i,[(0,c.iO)(i),(0,c.Pb)(i)]),o=void 0===(e=e||{}).margin?20:e.margin;if(!(0,h.containsExtent)(n,a)){var r=a[0]-n[0],s=n[2]-a[2],l=a[1]-n[1],u=n[3]-a[3],d=[0,0];if(r<0?d[0]=r-o:s<0&&(d[0]=Math.abs(s)+o),l<0?d[1]=l-o:u<0&&(d[1]=Math.abs(u)+o),0!==d[0]||0!==d[1]){var g=t.getView().getCenterInternal(),m=t.getPixelFromCoordinateInternal(g);if(!m)return;var p=[m[0]+d[0],m[1]+d[1]],v=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(p),duration:v.duration,easing:v.easing})}}}}},{key:"getRect",value:function(e,t){var n=e.getBoundingClientRect(),i=n.left+window.pageXOffset,a=n.top+window.pageYOffset;return[i,a,i+t[0],a+t[1]]}},{key:"setPositioning",value:function(e){this.set(v,e)}},{key:"setVisible",value:function(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}},{key:"updatePixelPosition",value:function(){var e=this.getMap(),t=this.getPosition();if(e&&e.isRendered()&&t){var n=e.getPixelFromCoordinate(t),i=e.getSize();this.updateRenderedPosition(n,i)}else this.setVisible(!1)}},{key:"updateRenderedPosition",value:function(e,t){var n=this.element.style,i=this.getOffset(),a=this.getPositioning();this.setVisible(!0);var o=Math.round(e[0]+i[0])+"px",r=Math.round(e[1]+i[1])+"px",s="0%",l="0%";"bottom-right"==a||"center-right"==a||"top-right"==a?s="-100%":"bottom-center"!=a&&"center-center"!=a&&"top-center"!=a||(s="-50%"),"bottom-left"==a||"bottom-center"==a||"bottom-right"==a?l="-100%":"center-left"!=a&&"center-center"!=a&&"center-right"!=a||(l="-50%");var u="translate(".concat(s,", ").concat(l,") translate(").concat(o,", ").concat(r,")");this.rendered.transform_!=u&&(this.rendered.transform_=u,n.transform=u)}},{key:"getOptions",value:function(){return this.options}}]),n}(s.Z);t.Z=y}}]);
//# sourceMappingURL=9565.02bb058b.chunk.js.map