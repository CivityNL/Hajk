"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[9495,541,7749],{79495:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(15861),a=n(1413),c=n(93433),o=n(15671),i=n(43144),u=n(64687),s=n.n(u),l=n(72791),h=n(57749),f=n(94777),p=n(95392),d=n(25806),m=n(80184),g=function(){function e(t){var n=this;(0,o.Z)(this,e),this.internalId=0,this.init=function(){return n.getAllDocumentsContainedInMenu().then((function(e){n.allDocuments=e,n.documentSearchmodel=new p.default({allDocuments:e,globalSearchModel:n.app.searchModel,app:n.app,localObserver:n.localObserver}),n.settings.resolveSearchInterface(n.documentSearchmodel.implementSearchInterface())})).then((function(){return n}))},this.warnNoCustomThemeUrl=function(){console.warn("Could not find valid url for custom theme in documenthandler, check customThemeUrl")},this.fetchCustomThemeJson=function(){return n.options.customThemeUrl?(0,d.hfetch)(n.options.customThemeUrl).then((function(e){return e.json()})).catch((function(){return n.warnNoCustomThemeUrl(),null})):(n.warnNoCustomThemeUrl(),Promise.resolve(""))},this.flattenMenu=function(e){return e.reduce((function(e,t){return t.menu&&t.menu.length>0&&(e=[].concat((0,c.Z)(e),(0,c.Z)(n.flattenMenu(t.menu)))),[].concat((0,c.Z)(e),[t])}),[])},this.findChapters=function(e,t){return e.reduce((function(e,r){return r.chapters&&r.chapters.length>0&&(e=[].concat((0,c.Z)(e),(0,c.Z)(n.findChapters(r.chapters,t)))),r.headerIdentifier===t?[].concat((0,c.Z)(e),[r]):e}),[])},this.getHeaderRef=function(e,t){var r=n.findChapters(e.chapters,t);if(r.length>1)throw new Error("Two chapters with same header identifier found");return r[0]},this.setScrollReferences=function(e){e.scrollRef=l.createRef(),e.chapters.length>0&&e.chapters.forEach((function(e){n.setScrollReferences(e)}))},this.getCustomLink=function(e){return(0,m.jsx)(f.CustomLink,{aTag:e,localObserver:n.localObserver,bottomMargin:!0})},this.getTagSpecificCallbacks=function(){var e=[];return e.push({tagType:"br",callback:function(){return(0,m.jsx)(f.LineBreak,{})}}),e.push({tagType:"ul",callback:function(e){return(0,m.jsx)(f.ULComponent,{ulComponent:e})}}),e.push({tagType:"ol",callback:function(e){return(0,m.jsx)(f.OLComponent,{olComponent:e})}}),e.push({tagType:"li",callback:function(){}}),e.push({tagType:"blockquote",callback:function(e){return(0,m.jsx)(f.BlockQuote,{blockQuoteTag:e,defaultColors:n.options.defaultDocumentColorSettings})}}),e.push({tagType:"h1",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"h2",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"h3",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"h4",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"h5",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"h6",callback:function(e){return(0,m.jsx)(f.Heading,{headingTag:e})}}),e.push({tagType:"a",callback:function(e){return n.getCustomLink.bind(n),n.getCustomLink(e)}}),e.push({tagType:"img",callback:function(e){var t=e.dataset.type||"image";return"image"===t?(0,m.jsx)(f.Img,{componentId:e.componentId,imgTag:e,localObserver:n.localObserver,baseUrl:n.mapServiceUrl}):"video"===t?(0,m.jsx)(f.Video,{imgTag:e,componentId:e.componentId,baseUrl:n.mapServiceUrl}):"audio"===t?(0,m.jsx)(f.Audio,{imgTag:e,componentId:e.componentId,baseUrl:n.mapServiceUrl}):void 0}}),e.push({tagType:"source",callback:function(e){return(0,m.jsx)(f.Source,{sourceTag:e})}}),e.push({tagType:"p",callback:function(e){return(0,m.jsx)(f.Paragraph,{pTag:e})}}),e.push({tagType:"figure",callback:function(e){return(0,m.jsx)(f.Figure,{figureTag:e})}}),e.push({tagType:"strong",callback:function(e){return(0,m.jsx)(f.Strong,{strongTag:e})}}),e.push({tagType:"u",callback:function(e){return(0,m.jsx)(f.Underline,{uTag:e})}}),e.push({tagType:"em",callback:function(e){return(0,m.jsx)(f.Italic,{emTag:e})}}),e},this.getMaterialUIComponentsForChapter=function(e){return(0,h.default)(e.html,n.getTagSpecificCallbacks()).map((function(e,t){return(0,m.jsx)(l.Fragment,{children:e},t)}))},this.hasSubChapters=function(e){return e.chapters&&e.chapters.length>0},this.appendComponentsToChapter=function(e){n.hasSubChapters(e)&&e.chapters.forEach((function(e){e.components=n.getMaterialUIComponentsForChapter(e),n.hasSubChapters(e)&&n.appendComponentsToChapter(e)}));var t=n.getMaterialUIComponentsForChapter(e);e.components=t},this.appendParsedComponentsToDocument=function(){var e=n.props.activeDocument,t=(0,a.Z)({},e);t.chapters.forEach((function(e,t){n.appendComponentsToChapter(e)})),n.setState({activeContent:t})},this.mapServiceUrl=t.app.config.appConfig.proxy+t.app.config.appConfig.mapserviceBase,this.settings=t,this.app=t.app,this.allDocuments=[],this.chaptersMatchSearch=[],this.chapterInfo=[],this.chapterNumber=0,this.localObserver=t.localObserver,this.options=t.options}return(0,i.Z)(e,[{key:"getAllDocumentsContainedInMenu",value:function(){var e=this;return new Promise((function(t,n){e.allDocuments.length>0&&t(e.allDocuments);var r=e.flattenMenu(e.settings.menu).filter((function(e){return e.document}));Promise.all(r.map((function(t){return e.fetchJsonDocument(t.document).then((function(e){return e.title||console.warn("The document ".concat(t.document," is missing a title")),(0,a.Z)((0,a.Z)({},e),{},{documentColor:t.color,documentFileName:t.document,documentTitle:e.title,menuItemId:t.id})}))}))).then((function(e){t(e)})).catch((function(e){n(e)}))}))}},{key:"getDocuments",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.allDocuments.find((function(t){return t.documentFileName===e}));n=[].concat((0,c.Z)(n),[r])})),n}},{key:"getAllChapterInfo",value:function(){var e=this;return 0===this.chapterInfo.length&&(this.allDocuments.forEach((function(t,n){t.chapters.forEach((function(n){e.setChapterInfo(n,0,t.documentColor,t.documentFileName)}))})),this.mergeChapterInfo()),this.chapterInfo}},{key:"getParentIdentifier",value:function(e){if(e.parent)return e.parent.headerIdentifier?e.parent.headerIdentifier:this.getParentIdentifier(e.parent)}},{key:"setChapterInfo",value:function(e,t,n,r){var a=this,o=this.getParentIdentifier(e),i={};i.documentFileName=r,i.id=++this.chapterNumber,i.level=t,i.html=e.html,i.parent=e.parent,i.color=n,i.header=e.header,i.headerIdentifier=e.headerIdentifier,i.chosenForPrint=!1,i.parent=o,e.chapters&&e.chapters.length>0?(i.hasSubChapters=!0,this.chapterInfo=[].concat((0,c.Z)(this.chapterInfo),[i]),t+=1,e.chapters.forEach((function(e){e=a.setChapterInfo(e,t,n,r)}))):(i.hasSubChapters=!1,this.chapterInfo=[].concat((0,c.Z)(this.chapterInfo),[i]))}},{key:"mergeChapterInfo",value:function(){var e=this;this.chapterInfo.forEach((function(t){t.hasSubChapters&&t.headerIdentifier&&(t.chapters=e.chapterInfo.filter((function(e){return e.parent===t.headerIdentifier})),e.chapterInfo=e.chapterInfo.filter((function(e){return e.parent!==t.headerIdentifier})))}))}},{key:"getChapterById",value:function(e,t){for(var n=0;n<e.length;n++){if(e[n].id===t)return e[n];if(e[n].chapters&&e[n].chapters.length>0){var r=this.getChapterById(e[n].chapters,t);if(r)return r}}}},{key:"fetchJsonDocument",value:function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,a,c=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,d.hfetch)("".concat(this.mapServiceUrl,"/informative/load/").concat(t));case 3:return n=e.sent,e.next=6,n.text();case 6:if("File not found"!==(r=e.sent)){e.next=9;break}throw new Error("Could not find document with title ".concat(t," in folder with documents"));case 9:return e.next=11,JSON.parse(r);case 11:return a=e.sent,this.internalId=0,a.chapters.forEach((function(e){c.setParentChapter(e,void 0),c.setInternalId(e),c.setScrollReferences(e),c.appendComponentsToChapter(e),c.internalId=c.internalId+1})),e.abrupt("return",a);case 17:throw e.prev=17,e.t0=e.catch(0),console.warn("Kunde inte parsa JSON-dokumentet ".concat(document,", kontrollera s\xe5 att filen finns och \xe4r en .json-fil ")),new Error(e.t0);case 21:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setInternalId",value:function(e){var t=this;e.id=this.internalId,e.chapters.length>0&&e.chapters.forEach((function(e){t.internalId=t.internalId+1,t.setInternalId(e)}))}},{key:"setParentChapter",value:function(e,t){var n=this;e.parent=t,e.chapters.length>0&&e.chapters.forEach((function(t){n.setParentChapter(t,e)}))}}]),e}()},95392:function(e,t,n){n.r(t),n.d(t,{default:function(){return l}});var r=n(93433),a=n(43144),c=n(15671),o=n(30541),i=n(92810),u=n(21960),s=n(35077),l=(0,a.Z)((function e(t){var n=this;(0,c.Z)(this,e),this.bindListenForSearchResultClick=function(){n.app.globalObserver.subscribe("search.featureClicked.documentHandlerSearchResultClicked",(function(e){n.localObserver.publish("document-link-clicked",{documentName:e.properties.documentFileName,headerIdentifier:e.properties.headerIdentifier})}))},this.createDocumentCollectionsToSearch=function(e){return e.reduce((function(e,t){return[].concat((0,r.Z)(e),[{documentFileName:t.documentFileName,documentTitle:t.documentTitle,features:[].concat((0,r.Z)(n.getFeatures(t.chapters,t)),[n.getSpecialTitleFeature(t)])}])}),[])},this.getFeatures=function(e,t){return e.reduce((function(e,a){return a.chapters&&(e=[].concat((0,r.Z)(e),(0,r.Z)(n.getFeatures(a.chapters,t)))),e=[].concat((0,r.Z)(e),[n.createFeatureFromChapter(a,t)])}),[])},this.getSpecialTitleFeature=function(e){var t={header:e.documentTitle,geoids:[],headerIdentifier:e.documentTitle,documentTitle:e.documentTitle,documentFileName:e.documentFileName},n="".concat(e.documentTitle).concat(Math.floor(1e3*Math.random()));return{type:"Feature",isTitleFeature:!0,geometry:null,searchValues:[e.title],id:n,onClickName:"documentHandlerSearchResultClicked",properties:t,get:function(e){return t[e]},getGeometry:function(){return null},getId:function(){return n},setStyle:function(){return null}}},this.createFeatureFromChapter=function(e,t){var n=[];e.header&&n.push(e.header),e.keywords&&e.keywords.length>0&&(n=[].concat((0,r.Z)(n),(0,r.Z)(e.keywords)));var a={header:e.header,geoids:e.geoids,headerIdentifier:e.headerIdentifier,documentTitle:t.documentTitle,documentFileName:t.documentFileName},c="".concat(e.headerIdentifier).concat(Math.floor(1e3*Math.random()));return{type:"Feature",geometry:null,isTitleFeature:!1,searchValues:n,id:c,onClickName:"documentHandlerSearchResultClicked",properties:a,get:function(e){return a[e]},getGeometry:function(){return null},getId:function(){return c},setStyle:function(){return null}}},this.implementSearchInterface=function(){return{getResults:n.getResults,getFunctionality:n.getFunctionality}},this.getFunctionality=function(){return null},this.getResults=function(e,t){return n.matchSearch=new o.default(t),n.searchOptions=t,n.getDocumentHandlerResults(e)},this.getDocumentHandlerResults=function(e){return new Promise((function(t,r){""===e&&t({featureCollections:[],errors:[]});var a=n.searchOptions.getPossibleCombinations?n.globalSearchModel.getPossibleSearchCombinations(e):[(0,u.splitAndTrimOnCommas)(e)];a=n.decodePotentialSpecialCharsFromFeatureProps(a),t({featureCollections:n.getFeatureCollectionsForMatchingDocuments(a),errors:[]})}))},this.decodePotentialSpecialCharsFromFeatureProps=function(e){return e.map((function(e){return e.map((function(e){return(0,s.decodeCommas)(e)}))}))},this.getSearchFields=function(e){return e.reduce((function(e,t){return t.matchedSearchValues.length>0&&(e=[].concat((0,r.Z)(e),(0,r.Z)(n.getMockedSearchFieldForChapter(t)))),e}),[])},this.getMatchedFeatures=function(e,t){var a=n.searchOptions.initiator;return e.features.reduce((function(c,o){if("search"===a){if(o.isTitleFeature)return c;o.searchValues.push(e.documentTitle)}return"autocomplete"!==a||o.isTitleFeature||(o.searchValues=o.searchValues.filter((function(t){return t!==e.documentTitle}))),o.matchedSearchValues=n.getMatchedSearchValues(t,o.searchValues),o.matchedSearchValues.length>0?[].concat((0,r.Z)(c),[o]):c}),[])},this.createFeatureCollection=function(e,t,n){return{value:{status:"fulfilled",type:"FeatureCollection",crs:{type:null,properties:{name:null}},features:e,numberMatched:e.length,numberReturned:e.length,timeStamp:(new Date).toISOString(),totalFeatures:e.length},source:{id:n.documentTitle||n.documentFileName,caption:n.documentTitle||n.documentFileName,displayFields:["header"],searchFields:(0,r.Z)(t)},origin:"DOCUMENT"}},this.getFeatureCollectionsForMatchingDocuments=function(e){return n.documentCollections.reduce((function(t,a){var c=n.getMatchedFeatures(a,e),o=n.getSearchFields(c),i=n.createFeatureCollection(c,o,a);return i?[].concat((0,r.Z)(t),[i]):t}),[])},this.getMockedSearchFieldForChapter=function(e){return e.matchedSearchValues.reduce((function(t,n){var a=(0,i.Z)();return e.properties[a]=n,[].concat((0,r.Z)(t),[a])}),[])},this.getAllMatchedSearchValues=function(e,t){var r=new Set;return n.getMatched(e,t).forEach((function(e){r.add(e)})),r},this.getMatchedSearchValues=function(e,t){var a=new Set;return e.some((function(e){return e.every((function(e){var c=n.getAllMatchedSearchValues(e,t);return a=new Set([].concat((0,r.Z)(a),(0,r.Z)(c))),c.size>0}))}))?Array.from(a):[]},this.getMatched=function(e,t){return t.reduce((function(t,a){return n.matchSearch.compare(e,a)?[].concat((0,r.Z)(t),[a]):t}),[])},this.globalSearchModel=t.globalSearchModel,this.documentCollections=this.createDocumentCollectionsToSearch(t.allDocuments),this.localObserver=t.localObserver,this.app=t.app,this.bindListenForSearchResultClick()}))},30541:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var r=n(43144),a=n(15671),c=(0,r.Z)((function e(t){var n=this;(0,a.Z)(this,e),this.getMatchRegexp=function(e){var t=n.searchOptions,r=t.wildcardAtEnd,a=t.wildcardAtStart,c=t.matchCase?"g":"gi";return a&&!r?new RegExp(".*".concat(e,"$"),c):!a&&r?new RegExp("^".concat(e,".*"),c):a&&r?new RegExp("".concat(e),c):new RegExp("^".concat(e,"$"),c)},this.escapeSpecialChars=function(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")},this.compare=function(e,t){var r=n.escapeSpecialChars(e);return n.getMatchRegexp(r).test(t)},this.searchOptions=t}))},57749:function(e,t,n){n.r(t);var r=n(93433),a=n(37762),c=n(92810),o=function e(t,n){var r=n.find((function(e){return e.tagType.toLowerCase()===t.tagName.toLowerCase()}));if(t.callback=null===r||void 0===r?void 0:r.callback,t.componentId=(0,c.Z)(),t.children.length>0){var o,i=(0,a.Z)(t.children);try{for(i.s();!(o=i.n()).done;){e(o.value,n)}}catch(u){i.e(u)}finally{i.f()}}};t.default=function(e,t){var n,c=(new DOMParser).parseFromString(e,"text/html"),i=(0,a.Z)(c.body.children);try{for(i.s();!(n=i.n()).done;){var u=n.value;o(u,t)}}catch(s){i.e(s)}finally{i.f()}return(0,r.Z)(c.body.children).map((function(e){return e.callback?e.callback(e):null}))}},92810:function(e,t,n){var r;n.d(t,{Z:function(){return h}});var a=new Uint8Array(16);function c(){if(!r&&!(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(a)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var i=function(e){return"string"===typeof e&&o.test(e)},u=[],s=0;s<256;++s)u.push((s+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!i(n))throw TypeError("Stringified UUID is invalid");return n};var h=function(e,t,n){var r=(e=e||{}).random||(e.rng||c)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return l(r)}}}]);
//# sourceMappingURL=9495.d342f17f.chunk.js.map