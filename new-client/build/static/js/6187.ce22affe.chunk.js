"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[6187],{46187:function(e,t,r){r.r(t);var o=r(93433),n=r(29439),i=r(37762),a=r(4942),l=r(1413),s=r(43144),u=r(15671),c=r(66274),d=r(99359),S=r(91762),g=r(42468),f=r(5400),h=r(66233),Z=r(90927),y=r(64665),v=r(60313),T=r(88490),E=r(29409),k=r(62652),m=(0,d.Z)("geoJSONParser"),p=(0,d.Z)("storageKey"),F=(0,d.Z)("dateTimeOptions"),w=(0,d.Z)("drawModel"),C=(0,d.Z)("showHelperSnacks"),D=(0,d.Z)("getDefaultShowHelperSnacks"),b=(0,d.Z)("setSketchKeyInStorage"),R=(0,d.Z)("setStoredRemovedFeatures"),A=(0,d.Z)("setStoredSketches"),O=(0,d.Z)("createSketchObject"),_=(0,d.Z)("prepareFeatureForStorage"),I=(0,d.Z)("getStrokeType"),P=(0,d.Z)("extractStyleSettings"),j=(0,d.Z)("createImageStyle"),L=(0,d.Z)("createHighlightStyle"),H=(0,d.Z)("createFriendlyCircleGeom"),x=(0,d.Z)("getSketchOkForLS"),N=(0,s.Z)((function e(t){var r=this;(0,u.Z)(this,e),Object.defineProperty(this,m,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:function(){var e;return null===(e=g.default.get((0,c.Z)(r,p)[p]).showHelperSnacks)||void 0===e||e}}),Object.defineProperty(this,b,{writable:!0,value:function(e,t){g.default.set((0,c.Z)(r,p)[p],(0,l.Z)((0,l.Z)({},g.default.get((0,c.Z)(r,p)[p])),{},(0,a.Z)({},e,t)))}}),Object.defineProperty(this,R,{writable:!0,value:function(e){(0,c.Z)(r,b)[b]("removedFeatures",e)}}),Object.defineProperty(this,A,{writable:!0,value:function(e){(0,c.Z)(r,b)[b]("sketches",e)}}),this.setStoredDrawStyleSettings=function(e){(0,c.Z)(r,b)[b]("drawStyleSettings",e)},this.setStoredTextStyleSettings=function(e){(0,c.Z)(r,b)[b]("textStyleSettings",e)},Object.defineProperty(this,O,{writable:!0,value:function(e){return(0,l.Z)((0,l.Z)({},e),{},{id:r.generateRandomString(),date:r.getDateTimeString(),features:(0,c.Z)(r,w)[w].getAllDrawnFeatures().filter((function(e){return!0!==e.get("HIDDEN")})).map((function(e){return(0,c.Z)(r,_)[_](e)}))})}}),Object.defineProperty(this,_,{writable:!0,value:function(e){return e.set("EXTRACTED_STYLE",(0,c.Z)(r,w)[w].extractFeatureStyleInfo(e)),e.getGeometry()instanceof T.Z&&(0,c.Z)(r,H)[H](e),(0,c.Z)(r,m)[m].writeFeature(e)}}),this.getHelperSnackText=function(e,t){return(0,c.Z)(r,C)[C]?"ADD"===e?S.PROMPT_TEXTS["".concat(t,"Help")]:S.PROMPT_TEXTS["".concat(e,"Help")]:null},this.getDrawStyleSettings=function(){return g.default.get((0,c.Z)(r,p)[p]).drawStyleSettings||S.DEFAULT_DRAW_STYLE_SETTINGS},this.getTextStyleSettings=function(){return g.default.get((0,c.Z)(r,p)[p]).textStyleSettings||S.DEFAULT_TEXT_STYLE_SETTINGS},this.getActivityFromId=function(e){return S.ACTIVITIES.find((function(t){return t.id===e}))},this.getDateTimeString=function(e){return(new Date).toLocaleString("default",e||(0,c.Z)(r,F)[F])},this.generateRandomString=function(){return Math.random().toString(36).slice(2,9)},Object.defineProperty(this,I,{writable:!0,value:function(e){var t,r=(0,i.Z)(S.STROKE_DASHES.entries());try{for(r.s();!(t=r.n()).done;){var o=(0,n.Z)(t.value,2),a=o[0],l=o[1];if(l===e)return a;if(Array.isArray(l)&&Array.isArray(e)&&l.every((function(t){return e.includes(t)})))return a}}catch(s){r.e(s)}finally{r.f()}return console.error("Could not find corresponding stroke-type from supplied line-dash. The supplied line-dash was: ".concat(e)),null}}),Object.defineProperty(this,P,{writable:!0,value:function(e){var t=e.strokeColor,o=e.fillColor,n=e.strokeWidth,i=e.lineDash;return{strokeColor:(0,c.Z)(r,w)[w].getRGBAString(t),fillColor:(0,c.Z)(r,w)[w].getRGBAString(o),strokeWidth:n,lineDash:i}}}),Object.defineProperty(this,j,{writable:!0,value:function(e){return new f.Z({radius:6,stroke:new h.Z({color:e.strokeColor,width:e.strokeWidth,lineDash:e.lineDash}),fill:new Z.Z({color:e.fillColor})})}}),Object.defineProperty(this,L,{writable:!0,value:function(){return new y.ZP({stroke:new h.Z({color:"rgba(255, 0, 0, 1)",width:3}),fill:new Z.Z({color:"rgba(255, 0, 0, 0.1)"})})}}),Object.defineProperty(this,H,{writable:!0,value:function(e){try{var t=e.getGeometry(),r=t.getCenter(),o=t.getRadius();e.set("CIRCLE_RADIUS",o),e.set("CIRCLE_CENTER",JSON.stringify(r)),e.setGeometry(new E.Z(r))}catch(n){console.error("Could not create a geoJSON-friendly circle-geometry. Error: ".concat(n))}}}),Object.defineProperty(this,x,{writable:!0,value:function(e){try{return JSON.stringify(e).length<S.MAX_LS_CHARS}catch(t){return console.error("Failed to parse supplied sketch. Error: ".concat(t)),!1}}}),this.getFeatureStyle=function(e){try{var t=(0,c.Z)(r,w)[w].extractFeatureStyleInfo(e),o=e.get("TEXT_SETTINGS");return{strokeColor:(0,c.Z)(r,w)[w].parseColorString(null===t||void 0===t?void 0:t.strokeStyle.color),lineDash:null===t||void 0===t?void 0:t.strokeStyle.dash,strokeWidth:null===t||void 0===t?void 0:t.strokeStyle.width,strokeType:(0,c.Z)(r,I)[I](null===t||void 0===t?void 0:t.strokeStyle.dash),fillColor:(0,c.Z)(r,w)[w].parseColorString(null===t||void 0===t?void 0:t.fillStyle.color),textForegroundColor:null===o||void 0===o?void 0:o.foregroundColor,textBackgroundColor:null===o||void 0===o?void 0:o.backgroundColor,textSize:null===o||void 0===o?void 0:o.size}}catch(n){return console.error("Failed to get feature-style: Error: ".concat(n)),null}},this.setFeatureStyle=function(e,t){try{var o=Array.isArray(e.getStyle())?e.getStyle()[0]:e.getStyle(),n=o.getFill(),i=o.getStroke(),a=o.getImage(),l=(0,c.Z)(r,P)[P](t),s=l.fillColor,u=l.strokeColor,d=l.strokeWidth,S=l.lineDash;n.setColor(s),i.setColor(u),i.setWidth(d),i.setLineDash(S),a&&o.setImage((0,c.Z)(r,j)[j]({fillColor:s,strokeColor:u,strokeWidth:d,lineDash:S})),"Text"===e.get("DRAW_METHOD")&&e.set("TEXT_SETTINGS",{size:t.textSize,foregroundColor:t.textForegroundColor,backgroundColor:t.textBackgroundColor})}catch(g){console.error("Failed to apply the supplied style. Error: ".concat(g))}},this.featureShouldBeAddedToStorage=function(e){return!("Text"===e.get("DRAW_METHOD")&&!e.get("USER_TEXT"))||!0===e.get("HIDDEN")},this.decorateFeature=function(e){e.set("EXTRACTED_STYLE",(0,c.Z)(r,w)[w].extractFeatureStyleInfo(e)),e.set("HANDLED_AT",r.getDateTimeString()),e.set("HANDLED_ID",r.generateRandomString()),e.getGeometry()instanceof T.Z&&(0,c.Z)(r,H)[H](e)},this.getRemovedFeaturesFromStorage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FEATURES",t=g.default.get((0,c.Z)(r,p)[p]),o=t.removedFeatures||[];return"FEATURES"===e?o.map((function(e){return(0,c.Z)(r,m)[m].readFeature(e)})):o},this.getSketchesFromStorage=function(){return g.default.get((0,c.Z)(r,p)[p]).sketches||[]},this.addFeatureToStorage=function(e){var t=r.getRemovedFeaturesFromStorage("STRINGS"),n=(0,c.Z)(r,m)[m].writeFeature(e);(0,c.Z)(r,R)[R]([n].concat((0,o.Z)(t.slice(0,S.MAX_REMOVED_FEATURES-1))))},this.addCurrentSketchToStorage=function(e){var t=(0,c.Z)(r,O)[O](e),n=t.features;if(!n||0===n.length)return{status:"FAILED",message:S.PROMPT_TEXTS.saveNoFeatures};if(!(0,c.Z)(r,x)[x](t))return{status:"FAILED",message:S.PROMPT_TEXTS.saveOverflow};r.removeSketchFromStorage(e);var i=r.getSketchesFromStorage();return(0,c.Z)(r,A)[A]([t].concat((0,o.Z)(i))),(0,c.Z)(r,w)[w].removeDrawnFeatures(),r.addSketchToMap(t),{status:"SUCCESS",message:S.PROMPT_TEXTS.saveSuccess}},this.addSketchToMap=function(e){e.features.forEach((function(e){(0,c.Z)(r,w)[w].addFeature((0,c.Z)(r,m)[m].readFeature(e))}))},this.removeFeatureFromStorage=function(e){var t=r.getRemovedFeaturesFromStorage("STRINGS");(0,c.Z)(r,R)[R](t.filter((function(t){return!t.includes(e)})))},this.removeSketchFromStorage=function(e){var t=r.getSketchesFromStorage();(0,c.Z)(r,A)[A](t.filter((function(t){return!r.equalsIgnoringCase(t.title,e.title)})))},this.equalsIgnoringCase=function(e,t){return"string"===typeof e&&"string"===typeof t&&e.toLowerCase()===t.toLowerCase()},this.createHighlightFeature=function(e){if(e&&e.getGeometry()){var t=new k.Z({geometry:e.getGeometry().clone()});return t.setId(r.generateRandomString()),t.setStyle((0,c.Z)(r,L)[L]()),t}},this.getShowHelperSnacks=function(){return(0,c.Z)(r,C)[C]},this.setShowHelperSnacks=function(e){(0,c.Z)(r,C)[C]=e},this.getFeatureTitle=function(e){var t;return e instanceof k.Z&&null!==(t=e.get("FEATURE_TITLE"))&&void 0!==t?t:""},(0,c.Z)(this,m)[m]=new v.Z,(0,c.Z)(this,p)[p]=t.storageKey||"sketch",(0,c.Z)(this,F)[F]={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},(0,c.Z)(this,w)[w]=t.drawModel,(0,c.Z)(this,C)[C]=(0,c.Z)(this,D)[D]()}));t.default=N}}]);
//# sourceMappingURL=6187.ce22affe.chunk.js.map