"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[5500],{5500:function(e,t,a){a.r(t);var n=a(15671),r=a(43144),i=a(60136),u=a(29388),l=a(72791),o=a(76863),s=a(45953),d=a(43595),c=a(59911),m=a(45473),h=a(63818),f=a(50120),F=a(81898),p=a(54871),v=a(72900),g=a(37924),x=a(61091),y=a(65209),b=a(80184),j=(0,o.ZP)(s.ZP)((function(e){return{textAlign:"center",padding:e.theme.spacing(1)}})),k=function(e){(0,i.Z)(a,e);var t=(0,u.Z)(a);function a(e){var r,i,u,l,o;return(0,n.Z)(this,a),(o=t.call(this,e)).initFormValues=function(e){var t=o.props.editSource;if(e&&t){var a=e.getProperties(),n={};return t.editableFields.forEach((function(e){null!==a[e.name]&&("flerval"===e.textType&&""!==a[e.name]?n[e.name]=e.values.map((function(t){return{name:t,checked:"string"===typeof a[e.name]&&void 0!==a[e.name].split(";").find((function(e){return e===t}))}})):"boolean"===e.textType?"boolean"===e.dataType?n[e.name]=a[e.name]||"ja"===e.defaultValue||!1:n[e.name]=a[e.name]||1===e.defaultValue||0:n[e.name]=a[e.name]||e.defaultValue||"")})),n}},o.state={formValues:void 0,feature:void 0},o.formErrors={},e.observer.subscribe("feature-to-update-view",(function(e){o.setState({formValues:o.initFormValues(e),feature:e})})),null===(r=e.editSource)||void 0===r||null===(i=r.editableFields)||void 0===i||i.forEach((function(e,t){e.initialRender=!0})),null===(u=e.editSource)||void 0===u||null===(l=u.nonEditableFields)||void 0===l||l.forEach((function(e,t){e.initialRender=!0})),o}return(0,r.Z)(a,[{key:"componentWillUnmount",value:function(){this.props.observer.unsubscribe("feature-to-update-view")}},{key:"updateFeature",value:function(){var e,t,a=this,n=this.props.model.editFeature.getProperties();Object.keys(this.state.formValues).forEach((function(e){var t=a.state.formValues[e];""===t&&(t=null),Array.isArray(t)&&(t=t.filter((function(e){return e.checked})).map((function(e){return e.name})).join(";")),n[e]=t})),null===(e=this.props.editSource)||void 0===e||null===(t=e.nonEditableFields)||void 0===t||t.forEach((function(e){var t=e.defaultValue;""===t&&(t=null),Array.isArray(t)&&(t=t.filter((function(e){return e.checked})).map((function(e){return e.name})).join(";"));var r=a.props.model.editFeature.getGeometryName();r||(r="geom"),e.name!==r&&(n[e.name]=t)})),this.props.model.editFeature.setProperties(n)}},{key:"checkInteger",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);/^\d+$/.test(t)||""===t?n[e]=t:this.state.formValues[e]||(n[e]=""),this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"checkBoolean",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);"ja"===t?t=!0:"nej"===t&&(t=!1),n[e]=t,this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"checkNumber",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);/^\d+([.,](\d+)?)?$/.test(t)||""===t?(t=t.replace(",","."),n[e]=t):this.state.formValues[e]||(n[e]=""),this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"checkUrl",value:function(e,t){var a=this,n=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!$&'()*+,;=]|:|@)|\/|\?)*)?$/i.test(t),r=Object.assign({},this.state.formValues);n||""===t?(r[e]=t,delete this.formErrors[e]):(r[e]="",this.formErrors[e]="Ange en giltig url. t.ex. https://www.example.com"),this.setState({formValues:r},(function(){a.updateFeature()}))}},{key:"checkText",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);n[e]=t,this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"checkSelect",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);n[e]=t,this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"checkMultiple",value:function(e,t,a,n){var r=this,i=Object.assign({},this.state.formValues);i[e][n].checked=t,this.setState({formValues:i},(function(){r.updateFeature()}))}},{key:"checkDate",value:function(e,t){var a=this,n=Object.assign({},this.state.formValues);n[e]=t,this.updateFeature(),this.setState({formValues:n},(function(){a.updateFeature()}))}},{key:"setChanged",value:function(){"added"!==this.props.model.editFeature.modification&&"removed"!==this.props.model.editFeature.modification&&(this.props.model.editFeature.modification="updated")}},{key:"getValueMarkup",value:function(e,t){var a,n,r,i,u,l,o=this;"undefined"!==typeof e.alias&&""!==e.alias||(e.alias=e.name),e.textType&&""!==e.textType||("int"!==e.dataType&&"integer"!==e.dataType||(e.textType="heltal"),"number"!==e.dataType&&"decimal"!==e.dataType||(e.textType="nummer"),"date"===e.dataType&&(e.textType="datum"),"date-time"!==e.dataType&&"dateTime"!==e.dataType||(e.textType="date-time"),"boolean"===e.dataType&&(e.textType="boolean"));var s=this.state.formValues[e.name];switch(void 0!==s&&null!==s||(s=""),""===s&&e.initialRender&&null!==e.defaultValue&&(s=e.defaultValue),e.textType){case"heltal":return(0,b.jsx)(c.Z,{id:e.id,label:e.alias,fullWidth:!0,margin:"normal",variant:"outlined",disabled:!t,value:s,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(a=this.formErrors[e.name])||void 0===a?void 0:a.length)>=0?this.formErrors[e.name]:e.description,onChange:function(t){o.setChanged(),o.checkInteger(e.name,t.target.value),e.initialRender=!1}});case"nummer":return(0,b.jsx)(c.Z,{id:e.id,label:e.alias,fullWidth:!0,margin:"normal",variant:"outlined",disabled:!t,value:s,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(n=this.formErrors[e.name])||void 0===n?void 0:n.length)>=0?this.formErrors[e.name]:e.description,onChange:function(t){o.setChanged(),o.checkNumber(e.name,t.target.value),e.initialRender=!1}});case"datum":return(0,b.jsx)(c.Z,{id:e.id,label:e.alias,fullWidth:!0,margin:"normal",type:"date",variant:"outlined",disabled:!t,value:s,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(r=this.formErrors[e.name])||void 0===r?void 0:r.length)>=0?this.formErrors[e.name]:e.description,onChange:function(t){o.setChanged(),o.checkDate(e.name,t.target.value),e.initialRender=!1},InputLabelProps:{shrink:!0}});case"date-time":return(0,b.jsx)(c.Z,{id:e.id,label:e.name,fullWidth:!0,margin:"normal",type:"datetime-local",variant:"outlined",disabled:!t,value:s,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(i=this.formErrors[e.name])||void 0===i?void 0:i.length)>=0?this.formErrors[e.name]:e.description,onChange:function(t){o.setChanged(),o.checkDate(e.name,t.target.value),e.initialRender=!1},InputLabelProps:{shrink:!0}});case"url":return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(c.Z,{id:e.id,label:e.alias,size:"small",fullWidth:!0,margin:"normal",variant:"outlined",disabled:!t,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(u=this.formErrors[e.name])||void 0===u?void 0:u.length)>=0?this.formErrors[e.name]:e.description,value:s,onChange:function(t){o.setChanged(),o.checkText(e.name,t.target.value),e.initialRender=!1},onBlur:function(t){o.setChanged(),"url"===e.textType&&o.checkUrl(e.name,t.target.value),e.initialRender=!1}})});case"fritext":return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(c.Z,{id:e.id,label:e.alias,size:"small",fullWidth:!0,margin:"normal",variant:"outlined",disabled:!t,multiline:!0,error:this.formErrors.hasOwnProperty(e.name),helperText:(null===(l=this.formErrors[e.name])||void 0===l?void 0:l.length)>=0?this.formErrors[e.name]:e.description,value:s,onChange:function(t){o.setChanged(),o.checkText(e.name,t.target.value),e.initialRender=!1},onBlur:function(t){o.setChanged(),"url"===e.textType&&o.checkUrl(e.name,t.target.value),e.initialRender=!1}})});case"flerval":var x=[];"string"===typeof e.defaultValue&&(x=e.defaultValue.split(",")),e.initialRender&&x.forEach((function(e){s.forEach((function(t){e===t.name&&(t.checked=!0)}))}));var y=e.values.map((function(a,n){var r=e.name+n,i=s.find((function(e){return e.name===a}))||{checked:!1};return(0,b.jsx)(v.Z,{control:(0,b.jsx)(m.Z,{checked:i.checked,disabled:!t,color:"primary",onChange:function(t){o.setChanged(),o.checkMultiple(e.name,t.target.checked,a,n),e.initialRender=!1}}),label:a},r)}));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(F.Z,{fullWidth:!0,margin:"normal",component:"fieldset",children:[(0,b.jsx)(f.Z,{component:"legend",children:e.alias}),(0,b.jsx)(p.Z,{children:y}),(0,b.jsx)(g.Z,{style:{marginTop:"0px",marginBottom:"10px"}})]}),(0,b.jsx)("br",{})]});case"lista":var j=null;return Array.isArray(e.values)&&(j=e.values.map((function(e,t){return(0,b.jsx)("option",{value:e,children:e},t)}))),(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(F.Z,{fullWidth:!0,component:"fieldset",children:[(0,b.jsx)(f.Z,{component:"legend",children:e.alias}),(0,b.jsxs)(h.Z,{value:s,variant:"outlined",disabled:!t,input:(0,b.jsx)(d.Z,{name:e.name,id:e.name}),onChange:function(t){o.setChanged(),o.checkSelect(e.name,t.target.value),e.initialRender=!1},children:[(0,b.jsx)("option",{value:"",children:"-V\xe4lj v\xe4rde-"}),j]}),(0,b.jsx)(g.Z,{children:e.description})]})});case"boolean":return(0,b.jsx)(v.Z,{control:(0,b.jsx)(m.Z,{checked:"boolean"===e.dataType&&"ja"===e.value||"int"===e.dataType&&1===e.value,color:"primary",disabled:!t,onChange:function(t){o.setChanged(),t.target.checked?"boolean"===e.dataType?e.value="ja":e.value=1:"boolean"===e.dataType?e.value="nej":e.value=0,e.initialRender=!1,o.checkBoolean(e.name,e.value),o.forceUpdate()}}),label:e.name});default:return(0,b.jsx)("span",{children:s})}}},{key:"render",value:function(){var e,t,a,n,r=this,i=this.state.formValues,u=this.props.model;if(!i||void 0===this.props.editSource)return null;var l=null===(e=this.props.editSource)||void 0===e||null===(t=e.editableFields)||void 0===t?void 0:t.map((function(e,t){var a=r.getValueMarkup(e,!0);return(0,b.jsx)(s.ZP,{item:!0,xs:12,ref:e.name,children:a},t)})),o=null===(a=this.props.editSource)||void 0===a||null===(n=a.nonEditableFields)||void 0===n?void 0:n.filter((function(e){return!1===e.hidden})).map((function(e,t){var a=r.getValueMarkup(e,!1);return(0,b.jsx)(s.ZP,{item:!0,xs:12,ref:e.name,children:a},t)}));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{item:!0,xs:12,children:(0,b.jsx)(y.Z,{variant:"outlined",color:"primary",label:"Ange objektets attribut:"})}),(0,b.jsxs)(j,{item:!0,xs:12,children:[(0,b.jsx)("p",{children:"Editerbara f\xe4lt:"}),l,(null===o||void 0===o?void 0:o.length)>2?"Icke-editerbara f\xe4lt:":"",o]}),(0,b.jsx)(j,{item:!0,xs:12,children:(0,b.jsx)(x.Z,{color:"primary",sx:{width:"100px"},variant:"contained",onClick:u.resetEditFeature,children:"OK"})})]})}}]),a}(l.Component);t.default=k},63818:function(e,t,a){var n=a(87462),r=a(63366),i=a(72791),u=a(28182),l=a(94419),o=a(94045),s=a(50040),d=a(90529),c=a(99305),m=a(43595),h=a(67254),f=a(5294),F=a(80184),p=["className","children","classes","IconComponent","input","inputProps","variant"],v=["root"],g=(0,F.jsx)(m.Z,{}),x=i.forwardRef((function(e,t){var a=(0,h.Z)({name:"MuiNativeSelect",props:e}),m=a.className,x=a.children,y=a.classes,b=void 0===y?{}:y,j=a.IconComponent,k=void 0===j?c.Z:j,E=a.input,C=void 0===E?g:E,D=a.inputProps,Z=(0,r.Z)(a,p),V=(0,d.Z)(),T=(0,s.Z)({props:a,muiFormControl:V,states:["variant"]}),A=function(e){var t=e.classes;return(0,l.Z)({root:["root"]},f.f,t)}((0,n.Z)({},a,{classes:b})),P=(0,r.Z)(b,v);return(0,F.jsx)(i.Fragment,{children:i.cloneElement(C,(0,n.Z)({inputComponent:o.ZP,inputProps:(0,n.Z)({children:x,classes:P,IconComponent:k,variant:T.variant,type:void 0},D,C?C.props.inputProps:{}),ref:t},Z,{className:(0,u.default)(A.root,C.props.className,m)}))})}));x.muiName="Select",t.Z=x}}]);
//# sourceMappingURL=5500.b1017a44.chunk.js.map