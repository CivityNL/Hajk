"use strict";(self.webpackChunkhajk_client=self.webpackChunkhajk_client||[]).push([[9008,9044],{49008:function(e,t,n){n.r(t);var r=n(15671),a=n(43144),i=n(60136),s=n(29388),o=n(72791),p=n(54164),l=n(76863),c=n(22892),u=n(49067),d=n(90166),h=n(15080),f=n(57816),y=n(29044),v=n(92171),m=n(80184),b=(0,l.ZP)("div")((function(){return{margin:-10}})),g=(0,l.ZP)(c.Z)((function(){return{top:-10}})),Z=(0,l.ZP)("div")((function(){return{padding:10}})),x=function(e){(0,i.Z)(n,e);var t=(0,s.Z)(n);function n(e){var a;return(0,r.Z)(this,n),(a=t.call(this,e)).handleChangeTabs=function(e,t){a.setState({activeTab:t})},a.handleTabsMounted=function(e){setTimeout((function(){null!==e&&e.updateIndicator()}),1)},a.renderLayerGroups=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return(0,m.jsx)("div",{style:{display:!0===e?"block":"none"},children:a.options.groups.map((function(e,t){return(0,m.jsx)(f.default,{group:e,model:a.props.model,chapters:a.state.chapters,app:a.props.app,options:a.props.options},t)}))})},a.renderBreadCrumbs=function(){return a.options.showBreadcrumbs&&(0,p.createPortal)((0,m.jsx)("div",{onMouseDown:function(e){return e.stopPropagation()},children:(0,m.jsx)(y.default,{map:a.props.map,model:a.props.model,app:a.props.app})}),document.getElementById("breadcrumbs-container"))},a.options=e.options,a.state={chapters:[],baseLayers:e.model.getBaseLayers(),activeTab:0},e.app.globalObserver.subscribe("informativeLoaded",(function(e){Array.isArray(e)&&a.setState({chapters:e})})),a}return(0,a.Z)(n,[{key:"render",value:function(){var e=this.props.windowVisible;return(0,m.jsxs)(b,{sx:{display:e?"block":"none"},children:[(0,m.jsx)(g,{position:"sticky",color:"default",children:(0,m.jsxs)(u.Z,{action:this.handleTabsMounted,onChange:this.handleChangeTabs,value:!!e&&this.state.activeTab,variant:"fullWidth",textColor:"inherit",children:[(0,m.jsx)(d.Z,{label:"Kartlager"}),(0,m.jsx)(d.Z,{label:"Bakgrund"}),!0===this.options.showActiveLayersView&&(0,m.jsx)(d.Z,{label:"Aktiva lager"})]})}),(0,m.jsxs)(Z,{children:[this.renderLayerGroups(0===this.state.activeTab),(0,m.jsx)(h.default,{display:1===this.state.activeTab,layers:this.state.baseLayers,layerMap:this.props.model.layerMap,backgroundSwitcherBlack:this.options.backgroundSwitcherBlack,backgroundSwitcherWhite:this.options.backgroundSwitcherWhite,enableOSM:this.options.enableOSM,map:this.props.map,app:this.props.app}),!0===this.options.showActiveLayersView&&2===this.state.activeTab&&(0,m.jsx)(v.default,{map:this.props.map,app:this.props.app})]}),this.renderBreadCrumbs()]})}}]),n}(o.PureComponent);t.default=x},15080:function(e,t,n){n.r(t);var r,a=n(93433),i=n(15671),s=n(43144),o=n(60136),p=n(29388),l=n(4942),c=n(72791),u=n(10736),d=n(36192),h=n(57707),f=n(74390),y=n(85194),v=n.n(y),m=n(50228),b=n(80184),g="-1",Z="-2",x="-3",k=(r={},(0,l.Z)(r,g,"#fff"),(0,l.Z)(r,Z,"#000"),r),L=function(e){(0,o.Z)(n,e);var t=(0,p.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).state={selectedLayerId:null},r.isSpecialBackgroundLayer=function(e){return[g,Z,x].includes(e)},r.setSpecialBackground=function(e){document.getElementById("map").style.backgroundColor=k[e]},r.onChange=function(e){var t=e.target.value,n=r.state.selectedLayerId,a=r.props.layerMap;r.isSpecialBackgroundLayer(t)?r.setSpecialBackground(t):a[t].setVisible(!0),!r.isSpecialBackgroundLayer(n)&&a[n].setVisible(!1),r.osmLayer&&r.osmLayer.setVisible(t===x),r.setState({selectedLayerId:t})},r.localObserver=v()(),e.enableOSM&&(r.osmSource=new d.Z({reprojectionErrorThreshold:5}),r.osmLayer=new h.Z({visible:!1,source:r.osmSource,zIndex:-1,layerType:"base",name:"osm-layer",caption:"OpenStreetMap",layerInfo:{caption:"OpenStreetMap",layerType:"base"}})),r}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.layers.find((function(e){return e.visible}));t&&this.setState({selectedLayerId:t.name}),this.props.enableOSM&&this.props.map.addLayer(this.osmLayer),this.props.app.globalObserver.subscribe("core.layerVisibilityChanged",(function(t){var n=t.target,r=n.get("name");-1!==e.props.layers.findIndex((function(e){return r===e.name}))&&!1!==n.get("visible")&&e.setState({selectedLayerId:n.get("name")})}))}},{key:"renderRadioButton",value:function(e,t){var n=this.state.selectedLayerId===e.name,r=this.props.layerMap[e.name];return e.name===x&&(r=this.osmLayer).set("foo","bar"),r||(r={isFakeMapLayer:!0,properties:{name:e.name,visible:n,layerInfo:{caption:e.caption,name:e.name,layerType:"base"},opacity:1},get:function(e){return this.properties[e]},set:function(e,t){this.properties[e]=t},getProperties:function(){return Object.keys(this.properties)}}),r.localObserver=this.localObserver,(0,b.jsx)(f.default,{layer:r,model:this.props.model,options:this.props.options,app:this.props.app},t)}},{key:"renderBaseLayerComponents",value:function(){var e=this,t=this.props,n=t.backgroundSwitcherWhite,r=t.backgroundSwitcherBlack,i=t.enableOSM,s=[];return n&&s.push(this.renderRadioButton({name:g,caption:"Vit"},Number(g))),r&&s.push(this.renderRadioButton({name:Z,caption:"Svart"},Number(Z))),i&&s.push(this.renderRadioButton({name:x,caption:"OpenStreetMap"},Number(x))),[].concat(s,(0,a.Z)(this.props.layers.filter((function(e){var t=(0,u.isValidLayerId)(e.name);return t||console.warn("Backgroundlayer with id ".concat(e.name," has a non-valid id")),t})).map((function(t,n){return e.renderRadioButton(t,n)}))))}},{key:"render",value:function(){return(0,b.jsx)(m.Z,{sx:{display:this.props.display?"block":"none"},children:this.renderBaseLayerComponents()})}}]),n}(c.PureComponent);t.default=L},3190:function(e,t,n){n.r(t);var r=n(93433),a=n(15671),i=n(43144),s=n(60136),o=n(29388),p=n(72791),l=n(29823),c=n(3746),u=n(20165),d=n(5536),h=n(56650),f=n(45953),y=n(61091),v=n(13811),m=n(4565),b=n(42618),g=n(76863),Z=n(4407),x=n(80184),k=(0,g.ZP)(h.Z)((function(e){var t=e.theme;return{marginRight:t.spacing(.5),border:"".concat(t.spacing(.1)," solid ").concat(t.palette.divider)}})),L=(0,g.ZP)(f.ZP)((function(e){return{padding:e.theme.spacing(1)}})),j=(0,g.ZP)(f.ZP)((function(e){return{paddingLeft:e.theme.spacing(.5)}})),C=(0,g.ZP)("div")((function(e){return{padding:e.theme.spacing(.5)}})),S=function(e){(0,s.Z)(n,e);var t=(0,o.Z)(n);function n(e){var r;return(0,a.Z)(this,n),(r=t.call(this,e)).setHidden=function(e){var t=e.target.getOpacity();r.setState({hidden:0===t})},r.setLayerOpacity=function(e){return function(t){r.setState({hidden:!r.state.hidden},(function(){e.setOpacity(r.state.hidden?0:1)}))}},r.setLayerVisibility=function(e){return function(t){e.get("visible")&&(e.setOpacity(1),r.props.app.globalObserver.publish("layerswitcher.hideLayer",e)),e.set("visible",!e.get("visible"))}},r.openInformative=function(e){r.props.app.windows.find((function(e){return"informative"===e.type})).props.custom.open(e)},r.handleClose=function(){r.setState({anchorEl:null,popoverOpen:!1})},r.state={hidden:0===e.layer.getOpacity(),anchorEl:null,popoverOpen:!1},r.chapters=r.findChapters(r.props.layer.get("name"),r.props.chapters),r}return(0,i.Z)(n,[{key:"componentDidMount",value:function(){this.props.layer.on("change:opacity",this.setHidden)}},{key:"componentWillUnmount",value:function(){this.props.layer.un("change:opacity",this.setHidden)}},{key:"isOverflow",value:function(e){if(!e)return!1;var t=e.scrollLeft++;return e.scrollLeft-- >t}},{key:"findChapters",value:function(e,t){var n=this;return t?t.reduce((function(t,a){return Array.isArray(a.layers)&&(a.layers.some((function(t){return t===e}))&&(t=[].concat((0,r.Z)(t),[a])),a.chapters.length>0&&(t=[].concat((0,r.Z)(t),(0,r.Z)(n.findChapters(e,a.chapters))))),t}),[]):[]}},{key:"renderChapterLinks",value:function(){var e=this;return this.chapters&&this.chapters.length>0&&this.chapters.length>0?(0,x.jsx)(C,{children:this.chapters.map((function(t,n){return(0,x.jsx)("div",{children:(0,x.jsxs)(y.Z,{size:"small",onClick:function(){e.setState({popoverOpen:!1}),e.openInformative(t)},children:[t.header,(0,x.jsx)(b.Z,{})]})},n)}))}):null}},{key:"renderChaptersPopover",value:function(e){this.setState({anchorEl:e,popoverOpen:!0})}},{key:"renderInformativeIcon",value:function(){var e=this;return this.props.chapters&&this.chapters&&this.chapters.length>0?(0,x.jsx)(v.Z,{size:"small",onClick:function(t){1===e.chapters.length?e.openInformative(e.chapters[0]):e.renderChaptersPopover(t.target)},children:(0,x.jsx)(d.Z,{})}):null}},{key:"render",value:function(){var e=this.props,t=e.layer,n=e.title,r=e.type,a=this.state.hidden;return(0,x.jsxs)(k,{square:"flat"===r,elevation:0,children:[(0,x.jsxs)(L,{container:!0,"data-type":"bread-crumb",justifyContent:"space-between",alignItems:"center",children:[(0,x.jsx)(f.ZP,{item:!0,children:(0,x.jsx)(v.Z,{size:"small",onClick:this.setLayerOpacity(t),"aria-label":"Visa/d\xf6lj lagret tillf\xe4lligt",children:a?(0,x.jsx)(u.Z,{}):(0,x.jsx)(c.Z,{})})}),this.renderInformativeIcon(),(0,x.jsx)(j,{item:!0,children:(0,x.jsx)(m.Z,{variant:"body2",noWrap:!0,children:n})}),(0,x.jsx)(f.ZP,{item:!0,children:(0,x.jsx)(v.Z,{size:"small",onClick:this.setLayerVisibility(t),"aria-label":"Ta bort lagret fr\xe5n kartan",children:(0,x.jsx)(l.Z,{})})})]}),(0,x.jsx)(Z.ZP,{id:"simple-popper",open:this.state.popoverOpen,anchorEl:this.state.anchorEl,onClose:this.handleClose,anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:this.renderChapterLinks()})]})}}]),n}(p.Component);t.default=S},29044:function(e,t,n){n.r(t);var r,a=n(93433),i=n(15671),s=n(43144),o=n(60136),p=n(29388),l=n(4942),c=n(1413),u=n(72791),d=n(3190),h=n(76863),f=n(74142),y=n(52797),v=n(45953),m=n(81872),b=n(4565),g=n(61091),Z=n(13811),x=n(68439),k=n(19924),L=n(20165),j=n(67728),C=n.n(j),S=n(80184),B=(0,h.ZP)("div")((function(e){var t=e.theme;return{background:t.palette.background.paper,boxShadow:t.shadows[24],left:0,bottom:0,right:0,width:"auto",zIndex:2}})),w=(0,h.ZP)("div")((function(e){var t=e.theme;return{padding:"6px ".concat(t.spacing(2)),display:"flex",alignItems:"center",justifyContent:"space-between"}})),O=(0,h.ZP)("div")((function(e){var t=e.theme;return(0,l.Z)({maxHeight:"300px",overflow:"auto"},t.breakpoints.down("sm"),{maxHeight:"110px"})})),I=(0,h.ZP)("div")((function(){return{position:"absolute",left:0,right:0,bottom:0,zIndex:2}})),P=(0,h.ZP)("div")((function(e){var t=e.theme;return{width:"100%",paddingLeft:t.spacing(.5),paddingBottom:t.spacing(.5)}})),M=function(e){(0,o.Z)(n,e);var t=(0,p.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).bindLayerEvents=function(e){return function(t){t.get("visible")&&e.push(t),r.setState({visibleLayers:e}),r.addedLayerBuffer=[],r.removedLayerBuffer=[],t.on("change:visible",(function(e){var t=e.target;setTimeout((function(){var e=[].concat((0,a.Z)(r.state.visibleLayers),(0,a.Z)(r.addedLayerBuffer));e=e.filter((function(e){return!r.removedLayerBuffer.some((function(t){return e===t}))})),r.setState({visibleLayers:e}),r.addedLayerBuffer=[],r.removedLayerBuffer=[]}),0),r.props.model.clearing?r.setState({visibleLayers:[]}):t.get("visible")?r.addedLayerBuffer.push(t):r.removedLayerBuffer.push(t)}))}},r.clear=function(){r.props.app.clear()},r.getBreadCrumbCompatibleLayers=function(){return r.state.visibleLayers.filter((function(e){return["layer","group"].includes(e.get("layerType"))}))},r.toggle=function(){r.setState({open:!r.state.open})},r.state={chapters:null,visibleLayers:[],open:!1},e.app.globalObserver.subscribe("informativeLoaded",(function(e){r.setState({chapters:e})})),r}return(0,s.Z)(n,[{key:"getVisibleLayers",value:function(){return this.props.map.getLayers().getArray().filter((function(e){return e.getVisible()}))}},{key:"componentDidMount",value:function(){this.props.map&&this.props.map.getLayers().getArray().forEach(this.bindLayerEvents([]))}},{key:"renderMobile",value:function(e){var t=this,n=this.state.open;return(0,S.jsxs)(B,{children:[(0,S.jsxs)(w,{children:[(0,S.jsx)(b.Z,{children:"Inneh\xe5ll i kartan"}),(0,S.jsx)(Z.Z,{onClick:this.toggle,size:"small",children:n?(0,S.jsx)(k.Z,{}):(0,S.jsx)(x.Z,{})})]}),n&&(0,S.jsx)(m.Z,{}),n?(0,S.jsxs)(O,{children:[e.length>0?(0,S.jsx)(v.ZP,{container:!0,item:!0,xs:12,justifyContent:"center",sx:{marginTop:1,marginBottom:1},children:(0,S.jsxs)(g.Z,{variant:"contained",onClick:this.clear,children:["Ta bort allt inneh\xe5ll",(0,S.jsx)(L.Z,{sx:{marginLeft:2}})]})}):(0,S.jsx)(b.Z,{children:"Anv\xe4nd s\xf6kfunktionen eller inneh\xe5llsmenyn f\xf6r att visa information i kartan."}),e.map((function(e,n){return(0,S.jsx)(P,{children:(0,S.jsx)(d.default,{title:e.get("caption"),layer:e,chapters:t.state.chapters,app:t.props.app})},"".concat(e.get("caption"),"-").concat(n))}))]}):null]})}},{key:"renderDesktop",value:function(e){var t=this,n=e.map((function(e,n){return(0,S.jsx)(d.default,{title:e.get("caption"),layer:e,chapters:t.state.chapters,app:t.props.app},"".concat(e.get("caption"),"-").concat(n))}));return(0,S.jsx)(I,{children:(0,S.jsx)(C(),{ref:"scrollMenu",data:n,alignCenter:!1})})}},{key:"render",value:function(){var e=this.getBreadCrumbCompatibleLayers();return this.props.isMobile?e.length>0?this.renderMobile(e):null:this.renderDesktop(e)}}]),n}(u.Component);t.default=(r=M,function(e){var t=(0,f.Z)(),n=(0,y.Z)(t.breakpoints.down("sm"));return(0,S.jsx)(r,(0,c.Z)((0,c.Z)({},e),{},{isMobile:n}))})}}]);
//# sourceMappingURL=9008.36d69e8d.chunk.js.map